(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PKeychain = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PKeychain=(()=>{var hc=Object.create;var dn=Object.defineProperty;var lc=Object.getOwnPropertyDescriptor;var pc=Object.getOwnPropertyNames;var dc=Object.getPrototypeOf,yc=Object.prototype.hasOwnProperty;var K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),St=(t,e)=>{for(var r in e)dn(t,r,{get:e[r],enumerable:!0})},Ja=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pc(e))!yc.call(t,i)&&i!==r&&dn(t,i,{get:()=>e[i],enumerable:!(n=lc(e,i))||n.enumerable});return t};var tt=(t,e,r)=>(r=t!=null?hc(dc(t)):{},Ja(e||!t||!t.__esModule?dn(r,"default",{value:t,enumerable:!0}):r,t)),gc=t=>Ja(dn({},"__esModule",{value:!0}),t);var J=K((Jd,ja)=>{ja.exports={options:{usePureJavaScript:!1}}});var rs=K((jd,es)=>{var yi={};es.exports=yi;var ts={};yi.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=xc(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};yi.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=ts[e];if(!r){r=ts[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function xc(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var pt=K((ty,ss)=>{var ns=J(),is=rs(),y=ss.exports=ns.util=ns.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ur(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=gi;function gi(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof gi||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=gi;var mc=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>mc&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){Ur(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){Ur(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function vc(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=vc;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){Ur(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return Ur(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){Ur(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",we=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],as="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=be.charAt(i>>2),r+=be.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=be.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":be.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=we[t.charCodeAt(s++)-43],n=we[t.charCodeAt(s++)-43],i=we[t.charCodeAt(s++)-43],a=we[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:is.encode,decode:is.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=be.charAt(i>>2),r+=be.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=be.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":be.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,c=r;f<t.length;)i=we[t.charCodeAt(f++)-43],a=we[t.charCodeAt(f++)-43],s=we[t.charCodeAt(f++)-43],o=we[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,as,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,as,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var xi=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},mi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},bc=function(t,e,r,n){var i=mi(t,e);i===null&&(i={}),i[r]=n,xi(t,e,i)},wc=function(t,e,r){var n=mi(t,e);return n!==null&&(n=r in n?n[r]:null),n},Ec=function(t,e,r){var n=mi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),xi(t,e,n)}},Sc=function(t,e){xi(t,e,null)},yn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};y.setItem=function(t,e,r,n,i){yn(bc,arguments,i)};y.getItem=function(t,e,r,n){return yn(wc,arguments,n)};y.removeItem=function(t,e,r,n){yn(Ec,arguments,n)};y.clearItems=function(t,e,r){yn(Sc,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(u,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var d=0;d<s;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function a(s,o){for(var f=[],c=0;c<s;++c)for(var u=o[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var bi=K((ey,os)=>{var mt=J();pt();os.exports=mt.cipher=mt.cipher||{};mt.cipher.algorithms=mt.cipher.algorithms||{};mt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new mt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};mt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new mt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};mt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),mt.cipher.algorithms[t]=e};mt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in mt.cipher.algorithms?mt.cipher.algorithms[t]:null};var vi=mt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};vi.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=mt.util.createBuffer(),this.output=t.output||mt.util.createBuffer(),this.mode.start(e)};vi.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};vi.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ei=K((ry,fs)=>{var vt=J();pt();vt.cipher=vt.cipher||{};var O=fs.exports=vt.cipher.modes=vt.cipher.modes||{};O.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(t){};O.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=gn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=vt.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=gn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=vt.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=gn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=vt.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=gn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}xn(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=vt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=vt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=vt.util.createBuffer(t.additionalData):r=vt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=vt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(wi(n*8)))}this._inBlock=this._j0.slice(0),xn(this._inBlock),this._partialBytes=0,r=vt.util.createBuffer(r),this._aDataLength=wi(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),xn(this._inBlock)};O.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),xn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=vt.util.createBuffer();var n=this._aDataLength.concat(wi(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};O.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};O.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};O.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;o[f]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};O.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function gn(t,e){if(typeof t=="string"&&(t=vt.util.createBuffer(t)),vt.util.isArray(t)&&t.length>4){var r=t;t=vt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!vt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function xn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function wi(t){return[t/4294967296|0,t&4294967295]}});var vn=K((ny,ls)=>{var et=J();bi();Ei();pt();ls.exports=et.aes=et.aes||{};et.aes.startEncrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};et.aes.createEncryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!1,mode:e})};et.aes.startDecrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};et.aes.createDecryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!0,mode:e})};et.aes.Algorithm=function(t,e){Ai||us();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Bi(r._w,n,i,!1)},decrypt:function(n,i){return Bi(r._w,n,i,!0)}}}),r._init=!1};et.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=et.util.createBuffer(e);else if(et.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=et.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!et.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!et.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=hs(e,t.decrypt&&!s),this._init=!0}};et.aes._expandKey=function(t,e){return Ai||us(),hs(t,e)};et.aes._updateBlock=Bi;ar("AES-ECB",et.cipher.modes.ecb);ar("AES-CBC",et.cipher.modes.cbc);ar("AES-CFB",et.cipher.modes.cfb);ar("AES-OFB",et.cipher.modes.ofb);ar("AES-CTR",et.cipher.modes.ctr);ar("AES-GCM",et.cipher.modes.gcm);function ar(t,e){var r=function(){return new et.aes.Algorithm(t,e)};et.cipher.registerAlgorithm(t,r)}var Ai=!1,ir=4,_t,Si,cs,Fe,Gt;function us(){Ai=!0,cs=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;_t=new Array(256),Si=new Array(256),Fe=new Array(4),Gt=new Array(4);for(var e=0;e<4;++e)Fe[e]=new Array(256),Gt[e]=new Array(256);for(var r=0,n=0,i,a,s,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,_t[r]=o,Si[o]=r,f=t[o],i=t[r],a=t[i],s=t[a],c=f<<24^o<<16^o<<8^(o^f),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Fe[h][r]=c,Gt[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function hs(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=ir*s,f=a;f<o;++f)n=r[f-1],f%a===0?(n=_t[n>>>16&255]<<24^_t[n>>>8&255]<<16^_t[n&255]<<8^_t[n>>>24]^cs[i]<<24,i++):a>6&&f%a===4&&(n=_t[n>>>24]<<24^_t[n>>>16&255]<<16^_t[n>>>8&255]<<8^_t[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Gt[0],h=Gt[1],l=Gt[2],d=Gt[3],p=r.slice(0);o=r.length;for(var f=0,g=o-ir;f<o;f+=ir,g-=ir)if(f===0||f===o-ir)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var m=0;m<ir;++m)c=r[g+m],p[f+(3&-m)]=u[_t[c>>>24]]^h[_t[c>>>16&255]]^l[_t[c>>>8&255]]^d[_t[c&255]];r=p}return r}function Bi(t,e,r,n){var i=t.length/4-1,a,s,o,f,c;n?(a=Gt[0],s=Gt[1],o=Gt[2],f=Gt[3],c=Si):(a=Fe[0],s=Fe[1],o=Fe[2],f=Fe[3],c=_t);var u,h,l,d,p,g,m;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,S=1;S<i;++S)p=a[u>>>24]^s[h>>>16&255]^o[l>>>8&255]^f[d&255]^t[++v],g=a[h>>>24]^s[l>>>16&255]^o[d>>>8&255]^f[u&255]^t[++v],m=a[l>>>24]^s[d>>>16&255]^o[u>>>8&255]^f[h&255]^t[++v],d=a[d>>>24]^s[u>>>16&255]^o[h>>>8&255]^f[l&255]^t[++v],u=p,h=g,l=m;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++v],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^t[++v],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++v],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++v]}function mn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=et.cipher.createDecipher(r,t.key):n=et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof et.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Sn=K((f1,Ls)=>{var qr=J();qr.pki=qr.pki||{};var Wi=Ls.exports=qr.pki.oids=qr.oids=qr.oids||{};function B(t,e){Wi[t]=e,Wi[e]=t}function X(t,e){Wi[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("2.16.840.1.101.3.4.2.4","sha224");B("2.16.840.1.101.3.4.2.5","sha512-224");B("2.16.840.1.101.3.4.2.6","sha512-256");B("1.2.840.113549.2.2","md2");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");X("2.5.29.1","authorityKeyIdentifier");X("2.5.29.2","keyAttributes");X("2.5.29.3","certificatePolicies");X("2.5.29.4","keyUsageRestriction");X("2.5.29.5","policyMapping");X("2.5.29.6","subtreesConstraint");X("2.5.29.7","subjectAltName");X("2.5.29.8","issuerAltName");X("2.5.29.9","subjectDirectoryAttributes");X("2.5.29.10","basicConstraints");X("2.5.29.11","nameConstraints");X("2.5.29.12","policyConstraints");X("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");X("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");X("2.5.29.20","cRLNumber");X("2.5.29.21","cRLReason");X("2.5.29.22","expirationDate");X("2.5.29.23","instructionCode");X("2.5.29.24","invalidityDate");X("2.5.29.25","cRLDistributionPoints");X("2.5.29.26","issuingDistributionPoint");X("2.5.29.27","deltaCRLIndicator");X("2.5.29.28","issuingDistributionPoint");X("2.5.29.29","certificateIssuer");X("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");X("2.5.29.33","policyMappings");X("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");X("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");X("2.5.29.46","freshestCRL");X("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Hr=K((c1,Ks)=>{var nt=J();pt();Sn();var I=Ks.exports=nt.asn1=nt.asn1||{};I.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};I.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};I.create=function(t,e,r,n,i){if(nt.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||nt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=I.copy(o)),o};I.copy=function(t,e){var r;if(nt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(I.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:I.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};I.equals=function(t,e,r){if(nt.util.isArray(t)){if(!nt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!I.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&I.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};I.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function zr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Nu=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;zr(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};I.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=nt.util.createBuffer(t));var r=t.length(),n=Bn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Bn(t,e,r,n){var i;zr(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var f=Nu(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(a&32)===32;if(l)if(u=[],f===void 0)for(;;){if(zr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(Bn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(Bn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===I.Class.UNIVERSAL&&o===I.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===I.Class.UNIVERSAL&&o===I.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(o===I.Type.BITSTRING&&(zr(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var m={strict:!0,decodeBitStrings:!0},v=Bn(t,e,r+1,m),S=i-t.length();e-=S,o==I.Type.BITSTRING&&S++;var A=v.tagClass;S===f&&(A===I.Class.UNIVERSAL||A===I.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===I.Type.BMPSTRING)for(u="";f>0;f-=2)zr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var N=h===void 0?null:{bitStringContents:h};return I.create(s,o,l,u,N)}I.toDer=function(t){var e=nt.util.createBuffer(),r=t.tagClass|t.type,n=nt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=I.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(I.toDer(t.value[a]))}else if(t.type===I.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===I.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};I.oidToDer=function(t){var e=t.split("."),r=nt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};I.derToOid=function(t){var e;typeof t=="string"&&(t=nt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};I.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};I.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,f)),e};I.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};I.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};I.integerToDer=function(t){var e=nt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};I.derToInteger=function(t){typeof t=="string"&&(t=nt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};I.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&nt.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=I.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Ps=/[^\\u0000-\\u00ff]/;I.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case I.Class.UNIVERSAL:n+="Universal:";break;case I.Class.APPLICATION:n+="Application:";break;case I.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case I.Class.PRIVATE:n+="Private:";break}if(t.tagClass===I.Class.UNIVERSAL)switch(n+=t.type,t.type){case I.Type.NONE:n+=" (None)";break;case I.Type.BOOLEAN:n+=" (Boolean)";break;case I.Type.INTEGER:n+=" (Integer)";break;case I.Type.BITSTRING:n+=" (Bit string)";break;case I.Type.OCTETSTRING:n+=" (Octet string)";break;case I.Type.NULL:n+=" (Null)";break;case I.Type.OID:n+=" (Object Identifier)";break;case I.Type.ODESC:n+=" (Object Descriptor)";break;case I.Type.EXTERNAL:n+=" (External or Instance of)";break;case I.Type.REAL:n+=" (Real)";break;case I.Type.ENUMERATED:n+=" (Enumerated)";break;case I.Type.EMBEDDED:n+=" (Embedded PDV)";break;case I.Type.UTF8:n+=" (UTF8)";break;case I.Type.ROID:n+=" (Relative Object Identifier)";break;case I.Type.SEQUENCE:n+=" (Sequence)";break;case I.Type.SET:n+=" (Set)";break;case I.Type.PRINTABLESTRING:n+=" (Printable String)";break;case I.Type.IA5String:n+=" (IA5String (ASCII))";break;case I.Type.UTCTIME:n+=" (UTC time)";break;case I.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case I.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=I.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===I.Type.OID){var f=I.derToOid(t.value);n+=f,nt.pki&&nt.pki.oids&&f in nt.pki.oids&&(n+=" ("+nt.pki.oids[f]+") ")}if(t.type===I.Type.INTEGER)try{n+=I.derToInteger(t.value)}catch{n+="0x"+nt.util.bytesToHex(t.value)}else if(t.type===I.Type.BITSTRING){if(t.value.length>1?n+="0x"+nt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===I.Type.OCTETSTRING)Ps.test(t.value)||(n+="("+t.value+") "),n+="0x"+nt.util.bytesToHex(t.value);else if(t.type===I.Type.UTF8)try{n+=nt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+nt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===I.Type.PRINTABLESTRING||t.type===I.Type.IA5String?n+=t.value:Ps.test(t.value)?n+="0x"+nt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Os=K((u1,Fs)=>{var ft=J();bi();Ei();pt();Fs.exports=ft.des=ft.des||{};ft.des.startEncrypting=function(t,e,r,n){var i=An({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ft.des.createEncryptionCipher=function(t,e){return An({key:t,output:null,decrypt:!1,mode:e})};ft.des.startDecrypting=function(t,e,r,n){var i=An({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ft.des.createDecryptionCipher=function(t,e){return An({key:t,output:null,decrypt:!0,mode:e})};ft.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Us(r._keys,n,i,!1)},decrypt:function(n,i){return Us(r._keys,n,i,!0)}}}),r._init=!1};ft.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ft.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Vu(e),this._init=!0}};jt("DES-ECB",ft.cipher.modes.ecb);jt("DES-CBC",ft.cipher.modes.cbc);jt("DES-CFB",ft.cipher.modes.cfb);jt("DES-OFB",ft.cipher.modes.ofb);jt("DES-CTR",ft.cipher.modes.ctr);jt("3DES-ECB",ft.cipher.modes.ecb);jt("3DES-CBC",ft.cipher.modes.cbc);jt("3DES-CFB",ft.cipher.modes.cfb);jt("3DES-OFB",ft.cipher.modes.ofb);jt("3DES-CTR",ft.cipher.modes.ctr);function jt(t,e){var r=function(){return new ft.des.Algorithm(t,e)};ft.cipher.registerAlgorithm(t,r)}var Du=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Lu=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Pu=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Ku=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Uu=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Fu=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Ou=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Mu=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Vu(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S=0,A,N=0;N<g;N++){var C=t.getInt32(),_=t.getInt32();A=(C>>>4^_)&252645135,_^=A,C^=A<<4,A=(_>>>-16^C)&65535,C^=A,_^=A<<-16,A=(C>>>2^_)&858993459,_^=A,C^=A<<2,A=(_>>>-16^C)&65535,C^=A,_^=A<<-16,A=(C>>>1^_)&1431655765,_^=A,C^=A<<1,A=(_>>>8^C)&16711935,C^=A,_^=A<<8,A=(C>>>1^_)&1431655765,_^=A,C^=A<<1,A=C<<8|_>>>20&240,C=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var M=0;M<v.length;++M){v[M]?(C=C<<2|C>>>26,_=_<<2|_>>>26):(C=C<<1|C>>>27,_=_<<1|_>>>27),C&=-15,_&=-15;var q=e[C>>>28]|r[C>>>24&15]|n[C>>>20&15]|i[C>>>16&15]|a[C>>>12&15]|s[C>>>8&15]|o[C>>>4&15],xt=f[_>>>28]|c[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(xt>>>16^q)&65535,m[S++]=q^A,m[S++]=xt^A<<16}}return m}function Us(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],f=e[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],l=a[c];l!=u;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];s=o,o=f,f=s^(Lu[d>>>24&63]|Ku[d>>>16&63]|Fu[d>>>8&63]|Mu[d&63]|Du[p>>>24&63]|Pu[p>>>16&63]|Uu[p>>>8&63]|Ou[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function An(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ft.cipher.createDecipher(r,t.key):n=ft.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof ft.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Me=K((h1,Ms)=>{var Cn=J();Ms.exports=Cn.md=Cn.md||{};Cn.md.algorithms=Cn.md.algorithms||{}});var qs=K((l1,Vs)=>{var le=J();Me();pt();var qu=Vs.exports=le.hmac=le.hmac||{};qu.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in le.md.algorithms)e=le.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=le.util.createBuffer(s);else if(le.util.isArray(s)){var o=s;s=le.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=le.util.createBuffer(),n=le.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var pr=K(()=>{});var $i=K((y1,zs)=>{var Tt=J();qs();Me();pt();var zu=Tt.pkcs5=Tt.pkcs5||{},pe;Tt.util.isNodejs&&!Tt.options.usePureJavaScript&&(pe=pr());zs.exports=Tt.pbkdf2=zu.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Tt.util.isNodejs&&!Tt.options.usePureJavaScript&&pe.pbkdf2&&(i===null||typeof i!="object")&&(pe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?pe.pbkdf2Sync.length===4?pe.pbkdf2(t,e,r,n,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):pe.pbkdf2(t,e,r,n,i,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):pe.pbkdf2Sync.length===4?pe.pbkdf2Sync(t,e,r,n).toString("binary"):pe.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Tt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Tt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Tt.hmac.create();u.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=f;++g){u.start(null,null),u.update(e),u.update(Tt.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var m=2;m<=r;++m)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Tt.util.xorBytes(l,d,s),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,m;function v(){if(g>f)return a(null,h);u.start(null,null),u.update(e),u.update(Tt.util.int32ToBytes(g)),l=p=u.digest().getBytes(),m=2,S()}function S(){if(m<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Tt.util.xorBytes(l,d,s),p=d,++m,Tt.util.setImmediate(S);h+=g<f?l:l.substr(0,c),++g,v()}v()}});var Ys=K((g1,Gs)=>{var _n=J();pt();var Hs=Gs.exports=_n.pem=_n.pem||{};Hs.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=In(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=In(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=In(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=In(t.headers[i]);return t.procType&&(r+=`\r
`),r+=_n.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Hs.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:_n.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(a=u.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(Hu(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function In(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Hu(t){return t.replace(/^\s+/,"")}});var Js=K((x1,Xs)=>{var te=J();Me();pt();var $s=Xs.exports=te.sha256=te.sha256||{};te.md.sha256=te.md.algorithms.sha256=$s;$s.create=function(){Zs||Gu();var t=null,e=te.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=te.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=te.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Ws(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=te.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Zi.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ws(h,r,i);var l=te.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Zi=null,Zs=!1,Qs=null;function Gu(){Zi=String.fromCharCode(128),Zi+=te.util.fillString(String.fromCharCode(0),64),Qs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Zs=!0}function Ws(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,m,v,S=r.length();S>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,m=t.h6,v=t.h7,c=0;c<64;++c)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=m^p&(g^m),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=v+s+o+Qs[c]+e[c],i=a+f,v=m,m=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+m|0,t.h7=t.h7+v|0,S-=64}}});var to=K((m1,js)=>{var ee=J();pt();var Tn=null;ee.util.isNodejs&&!ee.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Tn=pr());var Yu=js.exports=ee.prng=ee.prng||{};Yu.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=ee.util.createBuffer();e.key=null,m();function m(v){if(v)return u(v);if(g.length()>=c)return u(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return ee.util.nextTick(function(){a(m)});var S=h(e.key,e.seed);e.generated+=S.length,g.putBytes(S),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),ee.util.setImmediate(m)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=ee.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=ee.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(C){return l.getRandomValues(C)});var d=ee.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var m=0;m<g.length;++m)d.putInt32(g[m])}catch(C){if(!(typeof QuotaExceededError<"u"&&C instanceof QuotaExceededError))throw C}}if(d.length()<c)for(var v,S,A,N=Math.floor(Math.random()*65536);d.length()<c;){S=16807*(N&65535),v=16807*(N>>16),S+=(v&32767)<<16,S+=v>>15,S=(S&2147483647)+(S>>31),N=S&4294967295;for(var m=0;m<3;++m)A=N>>>(m<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return Tn?(e.seedFile=function(c,u){Tn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return Tn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},e}});var Gr=K((v1,Qi)=>{var bt=J();vn();Js();to();pt();(function(){if(bt.random&&bt.random.getBytes){Qi.exports=bt.random;return}(function(t){var e={},r=new Array(4),n=bt.util.createBuffer();e.formatKey=function(h){var l=bt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),bt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=bt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return bt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=bt.md.sha256;function i(){var h=bt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=bt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),bt.options.usePureJavaScript||!bt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!bt.random)bt.random=a;else for(var u in a)bt.random[u]=a[u];bt.random.createInstance=i,Qi.exports=bt.random})(typeof jQuery<"u"?jQuery:null)})()});var io=K((b1,no)=>{var Nt=J();pt();var Xi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],eo=[1,2,3,5],Wu=function(t,e){return t<<e&65535|(t&65535)>>16-e},$u=function(t,e){return(t&65535)>>e|t<<16-e&65535};no.exports=Nt.rc2=Nt.rc2||{};Nt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Nt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Xi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Xi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Xi[r.at(o+1)^r.at(o+a)]);return r};var ro=function(t,e,r){var n=!1,i=null,a=null,s=null,o,f,c,u,h=[];for(t=Nt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Wu(p[c],eo[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=$u(p[c],eo[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var m=i.getInt16Le();s!==null&&(r?m^=s.getInt16Le():s.putInt16Le(m)),g.push(m&65535)}u=r?0:63;for(var v=0;v<p.length;v++)for(var S=0;S<p[v][0];S++)p[v][1](g);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(g[c]):g[c]^=s.getInt16Le()),a.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Nt.util.createBuffer(p)),n=!1,i=Nt.util.createBuffer(),a=g||new Nt.util.createBuffer,s=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var m=i.length()===8?8:8-i.length();i.fillWithByte(m,m)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var v=a.length(),S=a.at(v-1);S>v?g=!1:a.truncate(S)}return g}},d};Nt.rc2.startEncrypting=function(t,e,r){var n=Nt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Nt.rc2.createEncryptionCipher=function(t,e){return ro(t,e,!0)};Nt.rc2.startDecrypting=function(t,e,r){var n=Nt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Nt.rc2.createDecryptionCipher=function(t,e){return ro(t,e,!1)}});var Nn=K((w1,lo)=>{var Ji=J();lo.exports=Ji.jsbn=Ji.jsbn||{};var de,Zu=0xdeadbeefcafe,ao=(Zu&16777215)==15715070;function w(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Ji.jsbn.BigInteger=w;function W(){return new w(null)}function Qu(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Xu(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function so(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(w.prototype.am=so,de=28):ao&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=Xu,de=30):ao&&navigator.appName!="Netscape"?(w.prototype.am=Qu,de=26):(w.prototype.am=so,de=28);w.prototype.DB=de;w.prototype.DM=(1<<de)-1;w.prototype.DV=1<<de;var ji=52;w.prototype.FV=Math.pow(2,ji);w.prototype.F1=ji-de;w.prototype.F2=2*de-ji;var Ju="0123456789abcdefghijklmnopqrstuvwxyz",Rn=new Array,dr,Mt;dr="0".charCodeAt(0);for(Mt=0;Mt<=9;++Mt)Rn[dr++]=Mt;dr="a".charCodeAt(0);for(Mt=10;Mt<36;++Mt)Rn[dr++]=Mt;dr="A".charCodeAt(0);for(Mt=10;Mt<36;++Mt)Rn[dr++]=Mt;function oo(t){return Ju.charAt(t)}function fo(t,e){var r=Rn[t.charCodeAt(e)];return r??-1}function ju(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function th(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ae(t){var e=W();return e.fromInt(t),e}function eh(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:fo(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&w.ZERO.subTo(this,this)}function rh(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function nh(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=oo(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=oo(n));return i?a:"0"}function ih(){var t=W();return w.ZERO.subTo(this,t),t}function ah(){return this.s<0?this.negate():this}function sh(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function kn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function oh(){return this.t<=0?0:this.DB*(this.t-1)+kn(this.data[this.t-1]^this.s&this.DM)}function fh(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function ch(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function uh(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function hh(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function lh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function ph(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)}function dh(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function yh(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=W());var a=W(),s=this.s,o=t.s,f=this.DB-kn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,m=g-c,v=e??W();for(a.dlShiftTo(m,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),w.ONE.dlShiftTo(c,v),v.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--m>=0;){var S=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,S,r,m,0,c))<S)for(a.dlShiftTo(m,v),r.subTo(v,r);r.data[g]<--S;)r.subTo(v,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&w.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&w.ZERO.subTo(r,r)}}}function gh(t){var e=W();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(w.ZERO)>0&&t.subTo(e,e),e}function Ve(t){this.m=t}function xh(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function mh(t){return t}function vh(t){t.divRemTo(this.m,null,t)}function bh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function wh(t,e){t.squareTo(e),this.reduce(e)}Ve.prototype.convert=xh;Ve.prototype.revert=mh;Ve.prototype.reduce=vh;Ve.prototype.mulTo=bh;Ve.prototype.sqrTo=wh;function Eh(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Sh(t){var e=W();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(w.ZERO)>0&&this.m.subTo(e,e),e}function Bh(t){var e=W();return t.copyTo(e),this.reduce(e),e}function Ah(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Ch(t,e){t.squareTo(e),this.reduce(e)}function Ih(t,e,r){t.multiplyTo(e,r),this.reduce(r)}qe.prototype.convert=Sh;qe.prototype.revert=Bh;qe.prototype.reduce=Ah;qe.prototype.mulTo=Ih;qe.prototype.sqrTo=Ch;function _h(){return(this.t>0?this.data[0]&1:this.s)==0}function Th(t,e){if(t>4294967295||t<1)return w.ONE;var r=W(),n=W(),i=e.convert(this),a=kn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Rh(t,e){var r;return t<256||e.isEven()?r=new Ve(e):r=new qe(e),this.exp(t,r)}w.prototype.copyTo=ju;w.prototype.fromInt=th;w.prototype.fromString=eh;w.prototype.clamp=rh;w.prototype.dlShiftTo=fh;w.prototype.drShiftTo=ch;w.prototype.lShiftTo=uh;w.prototype.rShiftTo=hh;w.prototype.subTo=lh;w.prototype.multiplyTo=ph;w.prototype.squareTo=dh;w.prototype.divRemTo=yh;w.prototype.invDigit=Eh;w.prototype.isEven=_h;w.prototype.exp=Th;w.prototype.toString=nh;w.prototype.negate=ih;w.prototype.abs=ah;w.prototype.compareTo=sh;w.prototype.bitLength=oh;w.prototype.mod=gh;w.prototype.modPowInt=Rh;w.ZERO=Ae(0);w.ONE=Ae(1);function kh(){var t=W();return this.copyTo(t),t}function Nh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Dh(){return this.t==0?this.s:this.data[0]<<24>>24}function Lh(){return this.t==0?this.s:this.data[0]<<16>>16}function Ph(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Kh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Uh(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ae(r),i=W(),a=W(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function Fh(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var f=fo(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&w.ZERO.subTo(this,this)}function Oh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(w.ONE.shiftLeft(t-1),ta,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(w.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Mh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Vh(t){return this.compareTo(t)==0}function qh(t){return this.compareTo(t)<0?this:t}function zh(t){return this.compareTo(t)>0?this:t}function Hh(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Gh(t,e){return t&e}function Yh(t){var e=W();return this.bitwiseTo(t,Gh,e),e}function ta(t,e){return t|e}function Wh(t){var e=W();return this.bitwiseTo(t,ta,e),e}function co(t,e){return t^e}function $h(t){var e=W();return this.bitwiseTo(t,co,e),e}function uo(t,e){return t&~e}function Zh(t){var e=W();return this.bitwiseTo(t,uo,e),e}function Qh(){for(var t=W(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Xh(t){var e=W();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Jh(t){var e=W();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function jh(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function tl(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+jh(this.data[t]);return this.s<0?this.t*this.DB:-1}function el(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function rl(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=el(this.data[r]^e);return t}function nl(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function il(t,e){var r=w.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function al(t){return this.changeBit(t,ta)}function sl(t){return this.changeBit(t,uo)}function ol(t){return this.changeBit(t,co)}function fl(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function cl(t){var e=W();return this.addTo(t,e),e}function ul(t){var e=W();return this.subTo(t,e),e}function hl(t){var e=W();return this.multiplyTo(t,e),e}function ll(t){var e=W();return this.divRemTo(t,e,null),e}function pl(t){var e=W();return this.divRemTo(t,null,e),e}function dl(t){var e=W(),r=W();return this.divRemTo(t,e,r),new Array(e,r)}function yl(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function gl(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Yr(){}function ho(t){return t}function xl(t,e,r){t.multiplyTo(e,r)}function ml(t,e){t.squareTo(e)}Yr.prototype.convert=ho;Yr.prototype.revert=ho;Yr.prototype.mulTo=xl;Yr.prototype.sqrTo=ml;function vl(t){return this.exp(t,new Yr)}function bl(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function wl(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function yr(t){this.r2=W(),this.q3=W(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function El(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=W();return t.copyTo(e),this.reduce(e),e}function Sl(t){return t}function Bl(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Al(t,e){t.squareTo(e),this.reduce(e)}function Cl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}yr.prototype.convert=El;yr.prototype.revert=Sl;yr.prototype.reduce=Bl;yr.prototype.mulTo=Cl;yr.prototype.sqrTo=Al;function Il(t,e){var r=t.bitLength(),n,i=Ae(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Ve(e):e.isEven()?a=new yr(e):a=new qe(e);var s=new Array,o=3,f=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=W();for(a.sqrTo(s[1],u);o<=c;)s[o]=W(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,l,d=!0,p=W(),g;for(r=kn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function _l(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Tl(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Rl(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return w.ZERO;for(var r=t.clone(),n=this.clone(),i=Ae(1),a=Ae(0),s=Ae(0),o=Ae(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Yt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],kl=(1<<26)/Yt[Yt.length-1];function Nl(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Yt[Yt.length-1]){for(e=0;e<Yt.length;++e)if(r.data[0]==Yt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Yt.length;){for(var n=Yt[e],i=e+1;i<Yt.length&&n<kl;)n*=Yt[i++];for(n=r.modInt(n);e<i;)if(n%Yt[e++]==0)return!1}return r.millerRabin(t)}function Dl(t){var e=this.subtract(w.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Ll(),a,s=0;s<t;++s){do a=new w(this.bitLength(),i);while(a.compareTo(w.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Ll(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=Ph;w.prototype.toRadix=Uh;w.prototype.fromRadix=Fh;w.prototype.fromNumber=Oh;w.prototype.bitwiseTo=Hh;w.prototype.changeBit=il;w.prototype.addTo=fl;w.prototype.dMultiply=yl;w.prototype.dAddOffset=gl;w.prototype.multiplyLowerTo=bl;w.prototype.multiplyUpperTo=wl;w.prototype.modInt=Tl;w.prototype.millerRabin=Dl;w.prototype.clone=kh;w.prototype.intValue=Nh;w.prototype.byteValue=Dh;w.prototype.shortValue=Lh;w.prototype.signum=Kh;w.prototype.toByteArray=Mh;w.prototype.equals=Vh;w.prototype.min=qh;w.prototype.max=zh;w.prototype.and=Yh;w.prototype.or=Wh;w.prototype.xor=$h;w.prototype.andNot=Zh;w.prototype.not=Qh;w.prototype.shiftLeft=Xh;w.prototype.shiftRight=Jh;w.prototype.getLowestSetBit=tl;w.prototype.bitCount=rl;w.prototype.testBit=nl;w.prototype.setBit=al;w.prototype.clearBit=sl;w.prototype.flipBit=ol;w.prototype.add=cl;w.prototype.subtract=ul;w.prototype.multiply=hl;w.prototype.divide=ll;w.prototype.remainder=pl;w.prototype.divideAndRemainder=dl;w.prototype.modPow=Il;w.prototype.modInverse=Rl;w.prototype.pow=vl;w.prototype.gcd=_l;w.prototype.isProbablePrime=Nl});var mo=K((E1,xo)=>{var re=J();Me();pt();var yo=xo.exports=re.sha1=re.sha1||{};re.md.sha1=re.md.algorithms.sha1=yo;yo.create=function(){go||Pl();var t=null,e=re.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=re.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=re.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),po(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=re.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(ea.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};po(h,r,i);var l=re.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ea=null,go=!1;function Pl(){ea=String.fromCharCode(128),ea+=re.util.fillString(String.fromCharCode(0),64),go=!0}function po(t,e,r){for(var n,i,a,s,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var wo=K((S1,bo)=>{var ne=J();pt();Gr();mo();var vo=bo.exports=ne.pkcs1=ne.pkcs1||{};vo.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=ne.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),f=o-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=ne.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var g=Dn(i,o-a.digestLength-1,s),m=ne.util.xorBytes(p,g,p.length),v=Dn(m,a.digestLength,s),S=ne.util.xorBytes(i,v,i.length);return"\0"+S+m};vo.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var m=new Error("RSAES-OAEP encoded message length is invalid.");throw m.length=e.length,m.expectedLength=s,m}if(i===void 0?i=ne.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Dn(u,i.digestLength,a),l=ne.util.xorBytes(c,h,c.length),d=Dn(l,s-i.digestLength-1,a),p=ne.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),m=f!=="\0",v=0;v<i.digestLength;++v)m|=o.charAt(v)!==g.charAt(v);for(var S=1,A=i.digestLength,N=i.digestLength;N<p.length;N++){var C=p.charCodeAt(N),_=C&1^1,M=S?65534:0;m|=C&M,S=S&_,A+=S}if(m||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Dn(t,e,r){r||(r=ne.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var Eo=K((B1,ra)=>{var Ce=J();pt();Nn();Gr();(function(){if(Ce.prime){ra.exports=Ce.prime;return}var t=ra.exports=Ce.prime=Ce.prime||{},e=Ce.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Ce.random,m={nextBytes:function(v){for(var S=g.getBytesSync(v.length),A=0;A<v.length;++A)v[A]=S.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,m,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?f(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var g=c(h,l),m=0,v=u(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var S=10;"maxBlockTime"in d&&(S=d.maxBlockTime),o(g,h,l,m,v,S,p)}function o(h,l,d,p,g,m,v){var S=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(m<0||+new Date-S<m);Ce.util.setImmediate(function(){o(h,l,d,p,g,m,v)})}function f(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var g=c(h,l),m=d.workers,v=d.workLoad||100,S=v*30/8,A=d.workerScript||"forge/prime.worker.js";if(m===-1)return Ce.util.estimateCores(function(C,_){C&&(_=2),m=_-1,N()});N();function N(){m=Math.max(1,m);for(var C=[],_=0;_<m;++_)C[_]=new Worker(A);for(var M=m,_=0;_<m;++_)C[_].addEventListener("message",xt);var q=!1;function xt(Ht){if(!q){--M;var Lt=Ht.data;if(Lt.found){for(var It=0;It<C.length;++It)C[It].terminate();return q=!0,p(null,new e(Lt.prime,16))}g.bitLength()>h&&(g=c(h,l));var nr=g.toString(16);Ht.target.postMessage({hex:nr,workLoad:v}),g.dAddOffset(S,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Pn=K((A1,To)=>{var L=J();Hr();Nn();Sn();wo();Eo();Gr();pt();typeof z>"u"&&(z=L.jsbn.BigInteger);var z,na=L.util.isNodejs?pr():null,x=L.asn1,Vt=L.util;L.pki=L.pki||{};To.exports=L.pki.rsa=L.rsa=L.rsa||{};var U=L.pki,Kl=[6,4,2,4,2,4,6,2],Ul={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Fl={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ol={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Ml=L.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Vl={name:"DigestInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},ql=function(t){var e;if(t.algorithm in U.oids)e=U.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},Io=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(z.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(z.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new z(L.util.bytesToHex(L.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(z.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};U.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=_o(t,e,r)):(i=L.util.createBuffer(),i.putBytes(t));for(var s=new z(i.toHex(),16),o=Io(s,e,n),f=o.toString(16),c=L.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(L.util.hexToBytes(f)),c.getBytes()};U.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new z(L.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Io(s,e,r),f=o.toString(16),c=L.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(L.util.hexToBytes(f)),n!==!1?Ln(c.getBytes(),e,r):c.getBytes()};U.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||L.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new z(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};U.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new z(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new z(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(z.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Hl(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Kl[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(z.ONE),t.q1=t.q.subtract(z.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(z.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};U.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!L.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(So("generateKeyPair"))return na.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:U.privateKeyFromPem(c),publicKey:U.publicKeyFromPem(f)})});if(Bo("generateKey")&&Bo("exportKey"))return Vt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Co(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Vt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=U.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(o)));n(null,{privateKey:f,publicKey:U.setRsaPublicKey(f.n,f.e)})}});if(Ao("generateKey")&&Ao("exportKey")){var i=Vt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Co(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Vt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=U.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(h)));n(null,{privateKey:l,publicKey:U.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(So("generateKeyPairSync")){var a=na.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:U.privateKeyFromPem(a.privateKey),publicKey:U.publicKeyFromPem(a.publicKey)}}}var s=U.rsa.createKeyPairGenerationState(t,e,r);if(!n)return U.rsa.stepKeyPairGenerationState(s,0),s.keys;zl(s,r,n)};U.setRsaPublicKey=U.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return _o(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return L.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return U.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=Ln(c,r,!0);var u=x.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!x.validate(u,Vl,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=x.derToOid(h.algorithmIdentifier);if(!(p===L.oids.md2||p===L.oids.md5||p===L.oids.sha1||p===L.oids.sha224||p===L.oids.sha256||p===L.oids.sha384||p===L.oids.sha512||p===L.oids["sha512-224"]||p===L.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===L.oids.md2||p===L.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=Ln(c,r,!0),f===c}});var o=U.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};U.setRsaPrivateKey=U.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=U.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Ln};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return L.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:ql},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return U.rsa.encrypt(l,f,h)},f};U.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(U.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};U.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Ul,e,r)&&(t=x.fromDer(L.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,Fl,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,c,u,h;return i=L.util.createBuffer(e.privateKeyModulus).toHex(),a=L.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=L.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=L.util.createBuffer(e.privateKeyPrime1).toHex(),f=L.util.createBuffer(e.privateKeyPrime2).toHex(),c=L.util.createBuffer(e.privateKeyExponent1).toHex(),u=L.util.createBuffer(e.privateKeyExponent2).toHex(),h=L.util.createBuffer(e.privateKeyCoefficient).toHex(),U.setRsaPrivateKey(new z(i,16),new z(a,16),new z(s,16),new z(o,16),new z(f,16),new z(c,16),new z(u,16),new z(h,16))};U.privateKeyToAsn1=U.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.qInv))])};U.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Ml,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==U.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,Ol,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=L.util.createBuffer(e.publicKeyModulus).toHex(),s=L.util.createBuffer(e.publicKeyExponent).toHex();return U.setRsaPublicKey(new z(a,16),new z(s,16))};U.publicKeyToAsn1=U.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(U.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[U.publicKeyToRSAPublicKey(t)])])};U.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ie(t.e))])};function _o(t,e,r){var n=L.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var c=0,u=L.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function Ln(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=L.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function zl(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,f){L.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)!==0){t.p=null,i();return}if(t.q.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(z.ONE),t.q1=t.q.subtract(z.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(z.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function ie(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=L.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Hl(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function So(t){return L.util.isNodejs&&typeof na[t]=="function"}function Bo(t){return typeof Vt.globalScope<"u"&&typeof Vt.globalScope.crypto=="object"&&typeof Vt.globalScope.crypto.subtle=="object"&&typeof Vt.globalScope.crypto.subtle[t]=="function"}function Ao(t){return typeof Vt.globalScope<"u"&&typeof Vt.globalScope.msCrypto=="object"&&typeof Vt.globalScope.msCrypto.subtle=="object"&&typeof Vt.globalScope.msCrypto.subtle[t]=="function"}function Co(t){for(var e=L.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Po=K((C1,Lo)=>{var T=J();vn();Hr();Os();Me();Sn();$i();Ys();Gr();io();Pn();pt();typeof Ro>"u"&&(Ro=T.jsbn.BigInteger);var Ro,b=T.asn1,F=T.pki=T.pki||{};Lo.exports=F.pbe=T.pbe=T.pbe||{};var ze=F.oids,Gl={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Yl={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Wl={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};F.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=T.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=ze["aes128-CBC"],h=T.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=ze["aes192-CBC"],h=T.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=ze["aes256-CBC"],h=T.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=ze.desCBC,h=T.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Do(d),g=T.pkcs5.pbkdf2(e,n,i,s,p),m=T.random.getBytesSync(c),v=h(g);v.start(m),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes();var S=$l(n,a,s,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze.pkcs5PBKDF2).getBytes()),S]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,m)])])])}else if(r.algorithm==="3des"){s=24;var A=new T.util.ByteBuffer(n),g=F.pbe.generatePkcs12Key(e,A,1,i,s),m=F.pbe.generatePkcs12Key(e,A,2,i,s),v=T.des.createEncryptionCipher(g);v.start(m),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var N=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return N};F.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,Gl,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=b.derToOid(n.encryptionOid),o=F.pbe.getCipher(s,n.encryptionParams,e),f=T.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};F.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return T.pem.encode(r,{maxline:e})};F.encryptedPrivateKeyFromPem=function(t){var e=T.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};F.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=F.wrapRsaPrivateKey(F.privateKeyToAsn1(t));return n=F.encryptPrivateKeyInfo(n,e,r),F.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=T.random.getBytesSync(8),o=T.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=T.random.getBytesSync(8),o=T.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=T.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);u.start(a),u.update(b.toDer(F.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:T.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return T.pem.encode(h)};F.decryptRsaPrivateKey=function(t,e){var r=null,n=T.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=T.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=T.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=T.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=T.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=T.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return T.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return T.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return T.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=T.util.hexToBytes(n.dekInfo.parameters),f=T.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(f);if(c.start(o),c.update(T.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=F.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=F.privateKeyFromAsn1(r)),r};F.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in T.md))throw new Error('"sha1" hash algorithm unavailable.');a=T.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new T.util.ByteBuffer,h=new T.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new T.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),m=new T.util.ByteBuffer;for(o=0;o<g;o++)m.putByte(e.at(o%d));var v=c*Math.ceil(l/c),S=new T.util.ByteBuffer;for(o=0;o<v;o++)S.putByte(h.at(o%l));var A=m;A.putBuffer(S);for(var N=Math.ceil(i/f),C=1;C<=N;C++){var _=new T.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var M=0;M<n;M++)a.start(),a.update(_.getBytes()),_=a.digest();var q=new T.util.ByteBuffer;for(o=0;o<c;o++)q.putByte(_.at(o%f));var xt=Math.ceil(d/c)+Math.ceil(l/c),Ht=new T.util.ByteBuffer;for(s=0;s<xt;s++){var Lt=new T.util.ByteBuffer(A.getBytes(c)),It=511;for(o=q.length()-1;o>=0;o--)It=It>>8,It+=q.at(o)+Lt.at(o),Lt.setAt(o,It&255);Ht.putBuffer(Lt)}A=Ht,u.putBuffer(_)}return u.truncate(u.length()-i),u};F.pbe.getCipher=function(t,e,r){switch(t){case F.oids.pkcs5PBES2:return F.pbe.getCipherForPBES2(t,e,r);case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case F.oids["pbewithSHAAnd40BitRC2-CBC"]:return F.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};F.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,Yl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=b.derToOid(n.kdfOid),t!==F.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=b.derToOid(n.encOid),t!==F.oids["aes128-CBC"]&&t!==F.oids["aes192-CBC"]&&t!==F.oids["aes256-CBC"]&&t!==F.oids["des-EDE3-CBC"]&&t!==F.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=T.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(F.oids[t]){case"aes128-CBC":f=16,c=T.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=T.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=T.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=T.des.createDecryptionCipher;break;case"desCBC":f=8,c=T.des.createDecryptionCipher;break}var u=No(n.prfOid),h=T.pkcs5.pbkdf2(r,s,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};F.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,Wl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=T.util.createBuffer(n.salt),o=T.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=T.des.startDecrypting;break;case F.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,m){var v=T.rc2.createDecryptionCipher(g,40);return v.start(m,null),v};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=No(n.prfOid),l=F.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var d=F.pbe.generatePkcs12Key(r,s,2,o,c,h);return u(l,d)};F.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in T.md))throw new Error('"md5" hash algorithm unavailable.');n=T.md.md5.create()}e===null&&(e="");for(var i=[ko(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(ko(n,i[s-1]+t+e));return i.join("").substr(0,r)};function ko(t,e){return t.start().update(e).digest().getBytes()}function No(t){var e;if(!t)e="hmacWithSHA1";else if(e=F.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Do(e)}function Do(t){var e=T.md;switch(t){case"hmacWithSHA224":e=T.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function $l(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,T.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(F.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var Jo=K((U1,Xo)=>{"use strict";Xo.exports=pp;function pp(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(a)if(a=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,f(c))}})}});var r0=K(e0=>{"use strict";var qn=e0;qn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var mr=new Array(64),t0=new Array(123);for(Wt=0;Wt<64;)t0[mr[Wt]=Wt<26?Wt+65:Wt<52?Wt+71:Wt<62?Wt-4:Wt-59|43]=Wt++;var Wt;qn.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,f;r<n;){var c=e[r++];switch(o){case 0:a[s++]=mr[c>>2],f=(c&3)<<4,o=1;break;case 1:a[s++]=mr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:a[s++]=mr[f|c>>6],a[s++]=mr[c&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=mr[f],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var jo="invalid encoding";qn.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var f=e.charCodeAt(o++);if(f===61&&a>1)break;if((f=t0[f])===void 0)throw Error(jo);switch(a){case 0:s=f,a=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,a=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,a=3;break;case 3:r[n++]=(s&3)<<6|f,a=0;break}}if(a===1)throw Error(jo);return n-i};qn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var i0=K((O1,n0)=>{"use strict";n0.exports=zn;function zn(){this._listeners={}}zn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};zn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};zn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var h0=K((M1,u0)=>{"use strict";u0.exports=a0(a0);function a0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function a(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,a,s)}}t.writeFloatLE=e.bind(null,s0),t.writeFloatBE=e.bind(null,o0);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,f0),t.readFloatBE=r.bind(null,c0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function a(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,o,f+i),n(1/s>0?0:2147483648,o,f+a);else if(isNaN(s))n(0,o,f+i),n(2146959360,o,f+a);else if(s>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+a);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+a)}}}t.writeDoubleLE=e.bind(null,s0,0,4),t.writeDoubleBE=e.bind(null,o0,4,0);function r(n,i,a,s,o){var f=n(s,o+i),c=n(s,o+a),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,f0,0,4),t.readDoubleBE=r.bind(null,c0,4,0)}(),t}function s0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function o0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function f0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function c0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var l0=K((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var d0=K(p0=>{"use strict";var pa=p0;pa.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};pa.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,f;r<n;)f=e[r++],f<128?s[o++]=f:f>191&&f<224?s[o++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(f>>10),s[o++]=56320+(f&1023)):s[o++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};pa.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var g0=K((q1,y0)=>{"use strict";y0.exports=dp;function dp(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(a=t(n),s=0);var c=e.call(a,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var m0=K((z1,x0)=>{"use strict";x0.exports=Et;var Xr=We();function Et(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ye=Et.zero=new Et(0,0);Ye.toNumber=function(){return 0};Ye.zzEncode=Ye.zzDecode=function(){return this};Ye.length=function(){return 1};var yp=Et.zeroHash="\0\0\0\0\0\0\0\0";Et.fromNumber=function(e){if(e===0)return Ye;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Et(n,i)};Et.from=function(e){if(typeof e=="number")return Et.fromNumber(e);if(Xr.isString(e))if(Xr.Long)e=Xr.Long.fromString(e);else return Et.fromNumber(parseInt(e,10));return e.low||e.high?new Et(e.low>>>0,e.high>>>0):Ye};Et.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Et.prototype.toLong=function(e){return Xr.Long?new Xr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ne=String.prototype.charCodeAt;Et.fromHash=function(e){return e===yp?Ye:new Et((Ne.call(e,0)|Ne.call(e,1)<<8|Ne.call(e,2)<<16|Ne.call(e,3)<<24)>>>0,(Ne.call(e,4)|Ne.call(e,5)<<8|Ne.call(e,6)<<16|Ne.call(e,7)<<24)>>>0)};Et.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Et.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Et.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Et.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var We=K(da=>{"use strict";var D=da;D.asPromise=Jo();D.base64=r0();D.EventEmitter=i0();D.float=h0();D.inquire=l0();D.utf8=d0();D.pool=g0();D.LongBits=m0();D.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);D.global=D.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||da;D.emptyArray=Object.freeze?Object.freeze([]):[];D.emptyObject=Object.freeze?Object.freeze({}):{};D.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};D.isString=function(e){return typeof e=="string"||e instanceof String};D.isObject=function(e){return e&&typeof e=="object"};D.isset=D.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};D.Buffer=function(){try{var t=D.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();D._Buffer_from=null;D._Buffer_allocUnsafe=null;D.newBuffer=function(e){return typeof e=="number"?D.Buffer?D._Buffer_allocUnsafe(e):new D.Array(e):D.Buffer?D._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};D.Array=typeof Uint8Array<"u"?Uint8Array:Array;D.Long=D.global.dcodeIO&&D.global.dcodeIO.Long||D.global.Long||D.inquire("long");D.key2Re=/^true|false|0|1$/;D.key32Re=/^-?(?:0|[1-9][0-9]*)$/;D.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;D.longToHash=function(e){return e?D.LongBits.from(e).toHash():D.LongBits.zeroHash};D.longFromHash=function(e,r){var n=D.LongBits.fromHash(e);return D.Long?D.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function v0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}D.merge=v0;D.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function b0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&v0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}D.newError=b0;D.ProtocolError=b0("ProtocolError");D.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};D.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};D.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};D._configure=function(){var t=D.Buffer;if(!t){D._Buffer_from=D._Buffer_allocUnsafe=null;return}D._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},D._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var xa=K((G1,A0)=>{"use strict";A0.exports=dt;var se=We(),ga,S0=se.LongBits,gp=se.utf8;function $t(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function dt(t){this.buf=t,this.pos=0,this.len=t.length}var w0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new dt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new dt(e);throw Error("illegal buffer")},B0=function(){return se.Buffer?function(r){return(dt.create=function(i){return se.Buffer.isBuffer(i)?new ga(i):w0(i)})(r)}:w0};dt.create=B0();dt.prototype._slice=se.Array.prototype.subarray||se.Array.prototype.slice;dt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,$t(this,10);return e}}();dt.prototype.int32=function(){return this.uint32()|0};dt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ya(){var t=new S0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw $t(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw $t(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}dt.prototype.bool=function(){return this.uint32()!==0};function Hn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}dt.prototype.fixed32=function(){if(this.pos+4>this.len)throw $t(this,4);return Hn(this.buf,this.pos+=4)};dt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw $t(this,4);return Hn(this.buf,this.pos+=4)|0};function E0(){if(this.pos+8>this.len)throw $t(this,8);return new S0(Hn(this.buf,this.pos+=4),Hn(this.buf,this.pos+=4))}dt.prototype.float=function(){if(this.pos+4>this.len)throw $t(this,4);var e=se.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};dt.prototype.double=function(){if(this.pos+8>this.len)throw $t(this,4);var e=se.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};dt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw $t(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};dt.prototype.string=function(){var e=this.bytes();return gp.read(e,0,e.length)};dt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw $t(this,e);this.pos+=e}else do if(this.pos>=this.len)throw $t(this);while(this.buf[this.pos++]&128);return this};dt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};dt._configure=function(t){ga=t,dt.create=B0(),ga._configure();var e=se.Long?"toLong":"toNumber";se.merge(dt.prototype,{int64:function(){return ya.call(this)[e](!1)},uint64:function(){return ya.call(this)[e](!0)},sint64:function(){return ya.call(this).zzDecode()[e](!1)},fixed64:function(){return E0.call(this)[e](!0)},sfixed64:function(){return E0.call(this)[e](!1)}})}});var T0=K((Y1,_0)=>{"use strict";_0.exports=$e;var I0=xa();($e.prototype=Object.create(I0.prototype)).constructor=$e;var C0=We();function $e(t){I0.call(this,t)}$e._configure=function(){C0.Buffer&&($e.prototype._slice=C0.Buffer.prototype.slice)};$e.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};$e._configure()});var Ba=K((W1,D0)=>{"use strict";D0.exports=$;var qt=We(),ma,Gn=qt.LongBits,R0=qt.base64,k0=qt.utf8;function Jr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function ba(){}function xp(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function $(){this.len=0,this.head=new Jr(ba,0,0),this.tail=this.head,this.states=null}var N0=function(){return qt.Buffer?function(){return($.create=function(){return new ma})()}:function(){return new $}};$.create=N0();$.alloc=function(e){return new qt.Array(e)};qt.Array!==Array&&($.alloc=qt.pool($.alloc,qt.Array.prototype.subarray));$.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Jr(e,r,n),this.len+=r,this};function wa(t,e,r){e[r]=t&255}function mp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Ea(t,e){this.len=t,this.next=void 0,this.val=e}Ea.prototype=Object.create(Jr.prototype);Ea.prototype.fn=mp;$.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Ea((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};$.prototype.int32=function(e){return e<0?this._push(Sa,10,Gn.fromNumber(e)):this.uint32(e)};$.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Sa(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}$.prototype.uint64=function(e){var r=Gn.from(e);return this._push(Sa,r.length(),r)};$.prototype.int64=$.prototype.uint64;$.prototype.sint64=function(e){var r=Gn.from(e).zzEncode();return this._push(Sa,r.length(),r)};$.prototype.bool=function(e){return this._push(wa,1,e?1:0)};function va(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}$.prototype.fixed32=function(e){return this._push(va,4,e>>>0)};$.prototype.sfixed32=$.prototype.fixed32;$.prototype.fixed64=function(e){var r=Gn.from(e);return this._push(va,4,r.lo)._push(va,4,r.hi)};$.prototype.sfixed64=$.prototype.fixed64;$.prototype.float=function(e){return this._push(qt.float.writeFloatLE,4,e)};$.prototype.double=function(e){return this._push(qt.float.writeDoubleLE,8,e)};var vp=qt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};$.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(wa,1,0);if(qt.isString(e)){var n=$.alloc(r=R0.length(e));R0.decode(e,n,0),e=n}return this.uint32(r)._push(vp,r,e)};$.prototype.string=function(e){var r=k0.length(e);return r?this.uint32(r)._push(k0.write,r,e):this._push(wa,1,0)};$.prototype.fork=function(){return this.states=new xp(this),this.head=this.tail=new Jr(ba,0,0),this.len=0,this};$.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Jr(ba,0,0),this.len=0),this};$.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};$.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};$._configure=function(t){ma=t,$.create=N0(),ma._configure()}});var K0=K(($1,P0)=>{"use strict";P0.exports=oe;var L0=Ba();(oe.prototype=Object.create(L0.prototype)).constructor=oe;var De=We();function oe(){L0.call(this)}oe._configure=function(){oe.alloc=De._Buffer_allocUnsafe,oe.writeBytesBuffer=De.Buffer&&De.Buffer.prototype instanceof Uint8Array&&De.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};oe.prototype.bytes=function(e){De.isString(e)&&(e=De._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(oe.writeBytesBuffer,r,e),this};function bp(t,e,r){t.length<40?De.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}oe.prototype.string=function(e){var r=De.Buffer.byteLength(e);return this.uint32(r),r&&this._push(bp,r,e),this};oe._configure()});var Z0=K((q2,$0)=>{var at=J();Me();pt();var tn=$0.exports=at.sha512=at.sha512||{};at.md.sha512=at.md.algorithms.sha512=tn;var Y0=at.sha384=at.sha512.sha384=at.sha512.sha384||{};Y0.create=function(){return tn.create("SHA-384")};at.md.sha384=at.md.algorithms.sha384=Y0;at.sha512.sha256=at.sha512.sha256||{create:function(){return tn.create("SHA-512/256")}};at.md["sha512/256"]=at.md.algorithms["sha512/256"]=at.sha512.sha256;at.sha512.sha224=at.sha512.sha224||{create:function(){return tn.create("SHA-512/224")}};at.md["sha512/224"]=at.md.algorithms["sha512/224"]=at.sha512.sha224;tn.create=function(t){if(W0||Tp(),typeof t>"u"&&(t="SHA-512"),!(t in Qe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Qe[t],r=null,n=at.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=at.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=at.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),G0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=at.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Na.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);G0(g,i,f);var m=at.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)m.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&m.putInt32(g[p][1]);return m},o};var Na=null,W0=!1,Da=null,Qe=null;function Tp(){Na=String.fromCharCode(128),Na+=at.util.fillString(String.fromCharCode(0),128),Da=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Qe={},Qe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Qe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Qe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Qe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],W0=!0}function G0(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,m,v,S,A,N,C,_,M,q,xt,Ht,Lt,It,nr,pn,gt,Rt,P,hi,li,pi,di,Xa=r.length();Xa>=128;){for(gt=0;gt<16;++gt)e[gt][0]=r.getInt32()>>>0,e[gt][1]=r.getInt32()>>>0;for(;gt<80;++gt)hi=e[gt-2],Rt=hi[0],P=hi[1],n=((Rt>>>19|P<<13)^(P>>>29|Rt<<3)^Rt>>>6)>>>0,i=((Rt<<13|P>>>19)^(P<<3|Rt>>>29)^(Rt<<26|P>>>6))>>>0,pi=e[gt-15],Rt=pi[0],P=pi[1],a=((Rt>>>1|P<<31)^(Rt>>>8|P<<24)^Rt>>>7)>>>0,s=((Rt<<31|P>>>1)^(Rt<<24|P>>>8)^(Rt<<25|P>>>7))>>>0,li=e[gt-7],di=e[gt-16],P=i+li[1]+s+di[1],e[gt][0]=n+li[0]+a+di[0]+(P/4294967296>>>0)>>>0,e[gt][1]=P>>>0;for(g=t[0][0],m=t[0][1],v=t[1][0],S=t[1][1],A=t[2][0],N=t[2][1],C=t[3][0],_=t[3][1],M=t[4][0],q=t[4][1],xt=t[5][0],Ht=t[5][1],Lt=t[6][0],It=t[6][1],nr=t[7][0],pn=t[7][1],gt=0;gt<80;++gt)c=((M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23))>>>0,u=((M<<18|q>>>14)^(M<<14|q>>>18)^(q<<23|M>>>9))>>>0,h=(Lt^M&(xt^Lt))>>>0,l=(It^q&(Ht^It))>>>0,o=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,f=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,d=(g&v|A&(g^v))>>>0,p=(m&S|N&(m^S))>>>0,P=pn+u+l+Da[gt][1]+e[gt][1],n=nr+c+h+Da[gt][0]+e[gt][0]+(P/4294967296>>>0)>>>0,i=P>>>0,P=f+p,a=o+d+(P/4294967296>>>0)>>>0,s=P>>>0,nr=Lt,pn=It,Lt=xt,It=Ht,xt=M,Ht=q,P=_+i,M=C+n+(P/4294967296>>>0)>>>0,q=P>>>0,C=A,_=N,A=v,N=S,v=g,S=m,P=i+s,g=n+a+(P/4294967296>>>0)>>>0,m=P>>>0;P=t[0][1]+m,t[0][0]=t[0][0]+g+(P/4294967296>>>0)>>>0,t[0][1]=P>>>0,P=t[1][1]+S,t[1][0]=t[1][0]+v+(P/4294967296>>>0)>>>0,t[1][1]=P>>>0,P=t[2][1]+N,t[2][0]=t[2][0]+A+(P/4294967296>>>0)>>>0,t[2][1]=P>>>0,P=t[3][1]+_,t[3][0]=t[3][0]+C+(P/4294967296>>>0)>>>0,t[3][1]=P>>>0,P=t[4][1]+q,t[4][0]=t[4][0]+M+(P/4294967296>>>0)>>>0,t[4][1]=P>>>0,P=t[5][1]+Ht,t[5][0]=t[5][0]+xt+(P/4294967296>>>0)>>>0,t[5][1]=P>>>0,P=t[6][1]+It,t[6][0]=t[6][0]+Lt+(P/4294967296>>>0)>>>0,t[6][1]=P>>>0,P=t[7][1]+pn,t[7][0]=t[7][0]+nr+(P/4294967296>>>0)>>>0,t[7][1]=P>>>0,Xa-=128}}});var Df=K((Lg,Nf)=>{var Tr=1e3,Rr=Tr*60,kr=Rr*60,tr=kr*24,od=tr*7,fd=tr*365.25;Nf.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return cd(t);if(r==="number"&&isFinite(t))return e.long?hd(t):ud(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function cd(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*fd;case"weeks":case"week":case"w":return r*od;case"days":case"day":case"d":return r*tr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*kr;case"minutes":case"minute":case"mins":case"min":case"m":return r*Rr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Tr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function ud(t){var e=Math.abs(t);return e>=tr?Math.round(t/tr)+"d":e>=kr?Math.round(t/kr)+"h":e>=Rr?Math.round(t/Rr)+"m":e>=Tr?Math.round(t/Tr)+"s":t+"ms"}function hd(t){var e=Math.abs(t);return e>=tr?ai(t,e,tr,"day"):e>=kr?ai(t,e,kr,"hour"):e>=Rr?ai(t,e,Rr,"minute"):e>=Tr?ai(t,e,Tr,"second"):t+" ms"}function ai(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var Pf=K((Pg,Lf)=>{function ld(t){r.debug=r,r.default=r,r.coerce=f,r.disable=a,r.enable=i,r.enabled=s,r.humanize=Df(),r.destroy=c,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,d,p;function g(...m){if(!g.enabled)return;let v=g,S=Number(new Date),A=S-(h||S);v.diff=A,v.prev=h,v.curr=S,h=S,m[0]=r.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let N=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(_,M)=>{if(_==="%%")return"%";N++;let q=r.formatters[M];if(typeof q=="function"){let xt=m[N];_=q.call(v,xt),m.splice(N,1),N--}return _}),r.formatArgs.call(v,m),(v.log||r.log).apply(v,m)}return g.namespace=u,g.useColors=r.useColors(),g.color=r.selectColor(u),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:m=>{l=m}}),typeof r.init=="function"&&r.init(g),g}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function a(){let u=[...r.names.map(o),...r.skips.map(o).map(h=>"-"+h)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function f(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Lf.exports=ld});var Kf=K((Ft,si)=>{Ft.formatArgs=dd;Ft.save=yd;Ft.load=gd;Ft.useColors=pd;Ft.storage=xd();Ft.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ft.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function pd(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function dd(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+si.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Ft.log=console.debug||console.log||(()=>{});function yd(t){try{t?Ft.storage.setItem("debug",t):Ft.storage.removeItem("debug")}catch{}}function gd(){let t;try{t=Ft.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function xd(){try{return localStorage}catch{}}si.exports=Pf()(Ft);var{formatters:md}=si.exports;md.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Gf=K((ex,Hf)=>{"use strict";Hf.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Xf=K((Zf,Qf)=>{"use strict";var fi=Gf(),{hasOwnProperty:Wf}=Object.prototype,{propertyIsEnumerable:Id}=Object,Pr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),_d=Zf,Yf={concatArrays:!1,ignoreUndefined:!1},ci=t=>{let e=[];for(let r in t)Wf.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)Id.call(t,n)&&e.push(n)}return e};function Kr(t){return Array.isArray(t)?Td(t):fi(t)?Rd(t):t}function Td(t){let e=t.slice(0,0);return ci(t).forEach(r=>{Pr(e,r,Kr(t[r]))}),e}function Rd(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return ci(t).forEach(r=>{Pr(e,r,Kr(t[r]))}),e}var $f=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?Pr(t,i,$a(t[i],e[i],n)):Pr(t,i,Kr(e[i])))}),t),kd=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(a=>{let s=[];for(let o=0;o<a.length;o++)Wf.call(a,o)&&(s.push(String(o)),a===t?Pr(n,i++,a[o]):Pr(n,i++,Kr(a[o])));n=$f(n,a,ci(a).filter(o=>!s.includes(o)),r)}),n};function $a(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?kd(t,e,r):!fi(e)||!fi(t)?Kr(e):$f(t,e,ci(e),r)}Qf.exports=function(...t){let e=$a(Kr(Yf),this!==_d&&this||{},Yf),r={_:{}};for(let n of t)if(n!==void 0){if(!fi(n))throw new TypeError("`"+n+"` is not an Option Object");r=$a(r,{_:n},e)}return r._}});var ec=K((nx,tc)=>{"use strict";function Nd(t){return t>=55296&&t<=56319}function Dd(t){return t>=56320&&t<=57343}tc.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,a=0,s,o,f=0;f<i;f+=1){if(s=r.charCodeAt(f),o=r[f],Nd(s)&&Dd(r.charCodeAt(f+1))&&(f+=1,o+=r[f]),a+=e(o),a===n)return r.slice(0,f+1);if(a>n)return r.slice(0,f-o.length+1)}return r}});var nc=K((ix,rc)=>{"use strict";function Ld(t){return t>=55296&&t<=56319}function Pd(t){return t>=56320&&t<=57343}rc.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,a=null,s=0;s<r;s++)i=e.charCodeAt(s),Pd(i)?a!=null&&Ld(a)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),a=i;return n}});var ac=K((ax,ic)=>{"use strict";var Kd=ec(),Ud=nc();ic.exports=Kd.bind(null,Ud)});var fc=K((sx,oc)=>{"use strict";var Fd=ac(),Od=/[\/\?<>\\:\*\|"]/g,Md=/[\x00-\x1f\x80-\x9f]/g,Vd=/^\.+$/,qd=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,zd=/[\. ]+$/;function sc(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(Od,e).replace(Md,e).replace(Vd,e).replace(qd,e).replace(zd,e);return Fd(r,255)}oc.exports=function(t,e){var r=e&&e.replacement||"",n=sc(t,r);return r===""?n:sc(n,"")}});var Gd={};St(Gd,{DefaultKeyChain:()=>Qa});var k=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Qy=tt(vn(),1),Tu=tt(J(),1);function sr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var Ri={};St(Ri,{identity:()=>Tc});function Bc(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,S=p.length;v!==S&&p[v]===0;)v++,g++;for(var A=(S-v)*u+1>>>0,N=new Uint8Array(A);v!==S;){for(var C=p[v],_=0,M=A-1;(C!==0||_<m)&&M!==-1;M--,_++)C+=256*N[M]>>>0,N[M]=C%o>>>0,C=C/o>>>0;if(C!==0)throw new Error("Non-zero carry");m=_,v++}for(var q=A-m;q!==A&&N[q]===0;)q++;for(var xt=f.repeat(g);q<A;++q)xt+=t.charAt(N[q]);return xt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===f;)m++,g++;for(var S=(p.length-g)*c+1>>>0,A=new Uint8Array(S);p[g];){var N=r[p.charCodeAt(g)];if(N===255)return;for(var C=0,_=S-1;(N!==0||C<v)&&_!==-1;_--,C++)N+=o*A[_]>>>0,A[_]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");v=C,g++}if(p[g]!==" "){for(var M=S-v;M!==S&&A[M]===0;)M++;for(var q=new Uint8Array(m+(S-M)),xt=m;M!==S;)q[xt++]=A[M++];return q}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Ac=Bc,Cc=Ac,ps=Cc;var sy=new Uint8Array(0);var ds=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},he=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var ys=t=>new TextEncoder().encode(t),gs=t=>new TextDecoder().decode(t);var Ci=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ii=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ms(this,e)}},_i=class{constructor(e){this.decoders=e}or(e){return ms(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},ms=(t,e)=>new _i({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ti=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ci(e,r,n),this.decoder=new Ii(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},or=({name:t,prefix:e,encode:r,decode:n})=>new Ti(t,e,r,n),Ee=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ps(r,e);return or({prefix:t,name:e,encode:n,decode:a=>he(i(a))})},Ic=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},_c=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ht=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>or({prefix:e,name:t,encode(i){return _c(i,n,r)},decode(i){return Ic(i,n,r,t)}});var Tc=or({prefix:"\0",name:"identity",encode:t=>gs(t),decode:t=>ys(t)});var ki={};St(ki,{base2:()=>Rc});var Rc=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ni={};St(Ni,{base8:()=>kc});var kc=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Di={};St(Di,{base10:()=>Nc});var Nc=Ee({prefix:"9",name:"base10",alphabet:"0123456789"});var Li={};St(Li,{base16:()=>Dc,base16upper:()=>Lc});var Dc=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Lc=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pi={};St(Pi,{base32:()=>Se,base32hex:()=>Fc,base32hexpad:()=>Mc,base32hexpadupper:()=>Vc,base32hexupper:()=>Oc,base32pad:()=>Kc,base32padupper:()=>Uc,base32upper:()=>Pc,base32z:()=>qc});var Se=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pc=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kc=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Uc=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fc=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oc=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mc=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vc=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qc=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ki={};St(Ki,{base36:()=>zc,base36upper:()=>Hc});var zc=Ee({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hc=Ee({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ui={};St(Ui,{base58btc:()=>Bt,base58flickr:()=>Gc});var Bt=Ee({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gc=Ee({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Fi={};St(Fi,{base64:()=>Oe,base64pad:()=>Yc,base64url:()=>Wc,base64urlpad:()=>$c});var Oe=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yc=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wc=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$c=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Oi={};St(Oi,{base256emoji:()=>jc});var vs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Zc=vs.reduce((t,e,r)=>(t[r]=e,t),[]),Qc=vs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Xc(t){return t.reduce((e,r)=>(e+=Zc[r],e),"")}function Jc(t){let e=[];for(let r of t){let n=Qc[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var jc=or({prefix:"\u{1F680}",name:"base256emoji",encode:Xc,decode:Jc});var zi={};St(zi,{sha256:()=>At,sha512:()=>mu});var tu=Es,bs=128,eu=127,ru=~eu,nu=Math.pow(2,31);function Es(t,e,r){e=e||[],r=r||0;for(var n=r;t>=nu;)e[r++]=t&255|bs,t/=128;for(;t&ru;)e[r++]=t&255|bs,t>>>=7;return e[r]=t|0,Es.bytes=r-n+1,e}var iu=Mi,au=128,ws=127;function Mi(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw Mi.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&ws)<<i:(s&ws)*Math.pow(2,i),i+=7}while(s>=au);return Mi.bytes=a-n,r}var su=Math.pow(2,7),ou=Math.pow(2,14),fu=Math.pow(2,21),cu=Math.pow(2,28),uu=Math.pow(2,35),hu=Math.pow(2,42),lu=Math.pow(2,49),pu=Math.pow(2,56),du=Math.pow(2,63),yu=function(t){return t<su?1:t<ou?2:t<fu?3:t<cu?4:t<uu?5:t<hu?6:t<lu?7:t<pu?8:t<du?9:10},gu={encode:tu,decode:iu,encodingLength:yu},xu=gu,Fr=xu;var Or=(t,e=0)=>[Fr.decode(t,e),Fr.decode.bytes],fr=(t,e,r=0)=>(Fr.encode(t,e,r),e),cr=t=>Fr.encodingLength(t);var Jt=(t,e)=>{let r=e.byteLength,n=cr(t),i=n+cr(r),a=new Uint8Array(i+r);return fr(t,a,0),fr(r,a,n),a.set(e,i),new ur(t,r,e,a)},Mr=t=>{let e=he(t),[r,n]=Or(e),[i,a]=Or(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new ur(r,i,s,e)},Ss=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&ds(t.bytes,r.bytes)}},ur=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var qi=({name:t,code:e,encode:r})=>new Vi(t,e,r),Vi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Jt(this.code,r):r.then(n=>Jt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var As=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),At=qi({name:"sha2-256",code:18,encode:As("SHA-256")}),mu=qi({name:"sha2-512",code:19,encode:As("SHA-512")});var Hi={};St(Hi,{identity:()=>Be});var Cs=0,vu="identity",Is=he,bu=t=>Jt(Cs,Is(t)),Be={code:Cs,name:vu,encode:Is,digest:bu};var Iy=new TextEncoder,_y=new TextDecoder;var _s=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Bu(r,Gi(t),e||Bt.encoder);default:return Au(r,Gi(t),e||Se.encoder)}};var Ts=new WeakMap,Gi=t=>{let e=Ts.get(t);if(e==null){let r=new Map;return Ts.set(t,r),r}return e},ut=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Vr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Cu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ut.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Jt(e,r);return ut.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ut.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Ss(e.multihash,n.multihash)}toString(e){return _s(this,e)}toJSON(){return{"/":_s(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof ut)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new ut(n,i,a,s||Rs(n,i,a.bytes))}else if(r[Iu]===!0){let{version:n,multihash:i,code:a}=r,s=Mr(i);return ut.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Vr)throw new Error(`Version 0 CID must use dag-pb (code: ${Vr}) block encoding`);return new ut(e,r,n,n.bytes)}case 1:{let i=Rs(e,r,n.bytes);return new ut(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return ut.create(0,Vr,e)}static createV1(e,r){return ut.create(1,e,r)}static decode(e){let[r,n]=ut.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ut.inspectBytes(e),n=r.size-r.multihashSize,i=he(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new ur(r.multihashCode,r.digestSize,a,i);return[r.version===0?ut.createV0(s):ut.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Or(e.subarray(r));return r+=l,h},i=n(),a=Vr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=Su(e,r),a=ut.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Gi(a).set(n,e),a}},Su=(t,e)=>{switch(t[0]){case"Q":{let r=e||Bt;return[Bt.prefix,r.decode(`${Bt.prefix}${t}`)]}case Bt.prefix:{let r=e||Bt;return[Bt.prefix,r.decode(t)]}case Se.prefix:{let r=e||Se;return[Se.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Bu=(t,e,r)=>{let{prefix:n}=r;if(n!==Bt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},Au=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},Vr=112,Cu=18,Rs=(t,e,r)=>{let n=cr(t),i=n+cr(e),a=new Uint8Array(i+r.byteLength);return fr(t,a,0),fr(e,a,n),a.set(r,i),a},Iu=Symbol.for("@ipld/js-cid/CID");var lr={...Ri,...ki,...Ni,...Di,...Li,...Pi,...Ki,...Ui,...Fi,...Oi},Fy={...zi,...Hi};function wn(t=0){return globalThis.Buffer?.allocUnsafe!=null?sr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ns(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var ks=Ns("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Yi=Ns("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=wn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),_u={utf8:ks,"utf-8":ks,hex:lr.base16,latin1:Yi,ascii:Yi,binary:Yi,...lr},En=_u;function rt(t,e="utf8"){let r=En[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function ot(t,e="utf8"){let r=En[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var kt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Eg=tt(Hr(),1),Sg=tt(Po(),1);var ii=tt(J(),1);var ka={};St(ka,{Ed25519PrivateKey:()=>Ze,Ed25519PublicKey:()=>jr,generateKeyPair:()=>Cp,generateKeyPairFromSeed:()=>V0,unmarshalEd25519PrivateKey:()=>Bp,unmarshalEd25519PublicKey:()=>Ap});function Pt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Zl=tt(pr(),1);var wt=BigInt(0),H=BigInt(1),Te=BigInt(2),Ql=BigInt(8),Ko=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),it=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Ko,n:Ko,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Vo=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Wr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),_1=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Xl=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Jl=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),jl=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),tp=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),V=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ct))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ct.ZERO)?V.ZERO:new V(e.x,e.y,H,E(e.x*e.y))}static toAffineBatch(e){let r=np(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Fo(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=E(r*o),c=E(a*i),u=E(n*o),h=E(s*i);return f===c&&u===h}negate(){return new V(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=it,a=E(e*e),s=E(r*r),o=E(Te*E(n*n)),f=E(i*a),c=e+r,u=E(E(c*c)-a-s),h=f+s,l=h-o,d=f-s,p=E(u*l),g=E(h*d),m=E(u*d),v=E(l*h);return new V(p,g,v,m)}add(e){Fo(e);let{x:r,y:n,z:i,t:a}=this,{x:s,y:o,z:f,t:c}=e,u=E((n-r)*(o+s)),h=E((n+r)*(o-s)),l=E(h-u);if(l===wt)return this.double();let d=E(i*Te*c),p=E(a*Te*f),g=p+d,m=h+u,v=p-d,S=E(g*l),A=E(m*v),N=E(g*v),C=E(l*m);return new V(S,A,C,N)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(V.BASE)&&(r=ct.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&fa.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=V.normalizeZ(i),fa.set(r,i)));let a=V.ZERO,s=V.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=H);let g=d,m=d+Math.abs(p)-1,v=l%2!==0,S=p<0;p===0?s=s.add(Uo(v,i[g])):a=a.add(Uo(S,i[m]))}return V.normalizeZ([a,s])[0]}multiply(e,r){return this.wNAF(Un(e,it.l),r)}multiplyUnsafe(e){let r=Un(e,it.l,!1),n=V.BASE,i=V.ZERO;if(r===wt)return i;if(this.equals(i)||r===H)return this;if(this.equals(n))return this.wNAF(r);let a=i,s=this;for(;r>wt;)r&H&&(a=a.add(s)),s=s.double(),r>>=H;return a}isSmallOrder(){return this.multiplyUnsafe(it.h).equals(V.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(it.l/Te).double();return it.l%Te&&(e=e.add(this)),e.equals(V.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(V.ZERO);e==null&&(e=a?Ql:Fn(i));let s=E(r*e),o=E(n*e),f=E(i*e);if(a)return ct.ZERO;if(f!==H)throw new Error("invZ was invalid");return new ct(s,o)}fromRistrettoBytes(){aa()}toRistrettoBytes(){aa()}fromRistrettoHash(){aa()}};V.BASE=new V(it.Gx,it.Gy,H,E(it.Gx*it.Gy));V.ZERO=new V(wt,H,H,wt);function Uo(t,e){let r=e.negate();return t?r:e}function Fo(t){if(!(t instanceof V))throw new TypeError("ExtendedPoint expected")}function ia(t){if(!(t instanceof Dt))throw new TypeError("RistrettoPoint expected")}function aa(){throw new Error("Legacy method: switch to RistrettoPoint")}var Dt=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=it,n=E(Wr*e*e),i=E((n+H)*jl),a=BigInt(-1),s=E((a-r*n)*E(n+r)),{isValid:o,value:f}=ua(i,s),c=E(f*e);_e(c)||(c=E(-c)),o||(f=c),o||(a=n);let u=E(a*(n-H)*tp-s),h=f*f,l=E((f+f)*s),d=E(u*Xl),p=E(H-h),g=E(H+h);return new V(E(l*g),E(p*d),E(d*g),E(l*p))}static hashToCurve(e){e=Re(e,64);let r=sa(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=sa(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return new Dt(n.add(a))}static fromHex(e){e=Re(e,32);let{a:r,d:n}=it,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=sa(e);if(!ap($r(a),e)||_e(a))throw new Error(i);let s=E(a*a),o=E(H+r*s),f=E(H-r*s),c=E(o*o),u=E(f*f),h=E(r*n*c-u),{isValid:l,value:d}=Mo(E(h*u)),p=E(d*f),g=E(d*p*h),m=E((a+a)*p);_e(m)&&(m=E(-m));let v=E(o*g),S=E(m*v);if(!l||_e(S)||v===wt)throw new Error(i);return new Dt(new V(m,v,H,S))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,a=E(E(n+r)*E(n-r)),s=E(e*r),o=E(s*s),{value:f}=Mo(E(a*o)),c=E(f*a),u=E(f*s),h=E(c*u*i),l;if(_e(i*h)){let p=E(r*Wr),g=E(e*Wr);e=p,r=g,l=E(c*Jl)}else l=u;_e(e*h)&&(r=E(-r));let d=E((n-r)*l);return _e(d)&&(d=E(-d)),$r(d)}toHex(){return Zr(this.toRawBytes())}toString(){return this.toHex()}equals(e){ia(e);let r=this.ep,n=e.ep,i=E(r.x*n.y)===E(r.y*n.x),a=E(r.y*n.y)===E(r.x*n.x);return i||a}add(e){return ia(e),new Dt(this.ep.add(e.ep))}subtract(e){return ia(e),new Dt(this.ep.subtract(e.ep))}multiply(e){return new Dt(this.ep.multiply(e))}multiplyUnsafe(e){return new Dt(this.ep.multiplyUnsafe(e))}};Dt.BASE=new Dt(V.BASE);Dt.ZERO=new Dt(V.ZERO);var fa=new WeakMap,ct=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,fa.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=it;e=Re(e,32);let a=e.slice();a[31]=e[31]&-129;let s=Qr(a);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=Vo)throw new Error("Expected 0 < hex < 2**256");let o=E(s*s),f=E(o-H),c=E(n*o+H),{isValid:u,value:h}=ua(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&H)===H;return(e[31]&128)!==0!==l&&(h=E(-h)),new ct(h,s)}static async fromPrivateKey(e){return(await On(e)).point}toRawBytes(){let e=$r(this.y);return e[31]|=this.x&H?128:0,e}toHex(){return Zr(this.toRawBytes())}toX25519(){let{y:e}=this,r=E((H+e)*Fn(H-e));return $r(r)}isTorsionFree(){return V.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ct(E(-this.x),this.y)}add(e){return V.fromAffine(this).add(V.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return V.fromAffine(this).multiply(e,this).toAffine()}};ct.BASE=new ct(it.Gx,it.Gy);ct.ZERO=new ct(wt,H);var He=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Re(e,64),n=ct.fromHex(r.slice(0,32),!1),i=Qr(r.slice(32,64));return new He(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof ct))throw new Error("Expected Point instance");return Un(r,it.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set($r(this.s),32),e}toHex(){return Zr(this.toRawBytes())}};function Oo(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var ep=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Zr(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=ep[t[r]];return e}function ca(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function qo(t){let r=t.toString(16).padStart(64,"0");return ca(r)}function $r(t){return qo(t).reverse()}function _e(t){return(E(t)&H)===H}function Qr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Zr(Uint8Array.from(t).reverse()))}var rp=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function sa(t){return E(Qr(t)&rp)}function E(t,e=it.P){let r=t%e;return r>=wt?r:e+r}function Fn(t,e=it.P){if(t===wt||e<=wt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=E(t,e),n=e,i=wt,a=H,s=H,o=wt;for(;r!==wt;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==H)throw new Error("invert: does not exist");return E(i,e)}function np(t,e=it.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===wt?a:(r[o]=a,E(a*s,e)),H),i=Fn(n,e);return t.reduceRight((a,s,o)=>s===wt?a:(r[o]=E(a*r[o],e),E(a*s,e)),i),r}function ae(t,e){let{P:r}=it,n=t;for(;e-- >wt;)n*=n,n%=r;return n}function ip(t){let{P:e}=it,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),s=BigInt(80),f=t*t%e*t%e,c=ae(f,Te)*f%e,u=ae(c,H)*t%e,h=ae(u,r)*u%e,l=ae(h,n)*h%e,d=ae(l,i)*l%e,p=ae(d,a)*d%e,g=ae(p,s)*p%e,m=ae(g,s)*p%e,v=ae(m,n)*h%e;return{pow_p_5_8:ae(v,Te)*t%e,b2:f}}function ua(t,e){let r=E(e*e*e),n=E(r*r*e),i=ip(t*n).pow_p_5_8,a=E(t*r*i),s=E(e*a*a),o=a,f=E(a*Wr),c=s===t,u=s===E(-t),h=s===E(-t*Wr);return c&&(a=o),(u||h)&&(a=f),_e(a)&&(a=E(-a)),{isValid:c||u,value:a}}function Mo(t){return ua(H,t)}function Kn(t){return E(Qr(t),it.l)}function ap(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Re(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):ca(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Un(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(wt<t)return t}else if(wt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function sp(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function op(t){if(t=typeof t=="bigint"||typeof t=="number"?qo(Un(t,Vo)):Re(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function fp(t){let e=sp(t.slice(0,32)),r=t.slice(32,64),n=Kn(e),i=ct.BASE.multiply(n),a=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:a}}var oa;async function On(t){return fp(await ke.sha512(op(t)))}async function ha(t){return(await On(t)).pointBytes}async function zo(t,e){t=Re(t);let{prefix:r,scalar:n,pointBytes:i}=await On(e),a=Kn(await ke.sha512(r,t)),s=ct.BASE.multiply(a),o=Kn(await ke.sha512(s.toRawBytes(),i,t)),f=E(a+o*n,it.l);return new He(s,f).toRawBytes()}function cp(t,e,r){e=Re(e),r instanceof ct||(r=ct.fromHex(r,!1));let{r:n,s:i}=t instanceof He?t.assertValidity():He.fromHex(t),a=V.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:a,pub:r,msg:e}}function up(t,e,r,n){let i=Kn(n),a=V.fromAffine(t).multiplyUnsafe(i);return V.fromAffine(e).add(a).subtract(r).multiplyUnsafe(it.h).equals(V.ZERO)}async function Ho(t,e,r){let{r:n,SB:i,msg:a,pub:s}=cp(t,e,r),o=await ke.sha512(n.toRawBytes(),s.toRawBytes(),a);return up(s,n,i,o)}ct.BASE._setWindowSize(8);var Ie={node:Zl,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},ke={bytesToHex:Zr,hexToBytes:ca,concatBytes:Oo,getExtendedPublicKey:On,mod:E,invert:Fn,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Re(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(Qr(t),it.l-H)+H},randomBytes:(t=32)=>{if(Ie.web)return Ie.web.getRandomValues(new Uint8Array(t));if(Ie.node){let{randomBytes:e}=Ie.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ke.randomBytes(32),sha512:async(...t)=>{let e=Oo(...t);if(Ie.web){let r=await Ie.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(Ie.node)return Uint8Array.from(Ie.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ct.BASE){let r=e.equals(ct.BASE)?e:new ct(e.x,e.y);return r._setWindowSize(t),r.multiply(Te),r},sha512Sync:void 0};Object.defineProperties(ke,{sha512Sync:{configurable:!1,get(){return oa},set(t){oa||(oa=t)}}});var gr=32,ye=64,Mn=32;async function Go(){let t=ke.randomPrivateKey(),e=await ha(t);return{privateKey:Zo(t,e),publicKey:e}}async function Yo(t){if(t.length!==Mn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await ha(e);return{privateKey:Zo(e,r),publicKey:r}}async function Wo(t,e){let r=t.subarray(0,Mn);return zo(e,r)}async function $o(t,e,r){return Ho(e,r,t)}function Zo(t,e){let r=new Uint8Array(ye);for(let n=0;n<Mn;n++)r[n]=t[n],r[Mn+n]=e[n];return r}function Ge(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=wn(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return sr(r)}var la={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Vn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=kt.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(a)),p=o.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=rt(l));let m;if(l.length===0){m=await o.subtle.importKey("jwk",la,{name:"AES-GCM"},!0,["encrypt"]);try{let S={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(S,A,{name:e,length:r},!0,["encrypt"])}catch{m=await o.subtle.importKey("jwk",la,{name:"AES-GCM"},!0,["encrypt"])}}else{let S={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(S,A,{name:e,length:r},!0,["encrypt"])}let v=await o.subtle.encrypt(g,m,h);return Ge([d,g.iv,new Uint8Array(v)])}async function c(h,l){let d=h.subarray(0,a),p=h.subarray(a,a+n),g=h.subarray(a+n),m={name:e,iv:p};typeof l=="string"&&(l=rt(l));let v;if(l.length===0)try{let A={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},N=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await o.subtle.deriveKey(A,N,{name:e,length:r},!0,["decrypt"])}catch{v=await o.subtle.importKey("jwk",la,{name:"AES-GCM"},!0,["decrypt"])}else{let A={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},N=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await o.subtle.deriveKey(A,N,{name:e,length:r},!0,["decrypt"])}let S=await o.subtle.decrypt(m,v,g);return new Uint8Array(S)}return{encrypt:f,decrypt:c}}async function xr(t,e){let n=await Vn().encrypt(t,e);return Oe.encode(n)}var Aa=tt(xa(),1),U0=tt(T0(),1),F0=tt(We(),1),Ca=tt(Ba(),1),O0=tt(K0(),1);function wp(){F0.default._configure(),Aa.default._configure(U0.default),Ca.default._configure(O0.default)}wp();var M0=["uint64","int64","sint64","fixed64","sfixed64"];function Ep(t){for(let e of M0){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Ia(t){return Ep(new Aa.default(t))}function Sp(t){for(let e of M0){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function _a(){return Sp(Ca.default.create())}function Yn(t,e){let r=Ia(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Wn(t,e){let r=_a();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var vr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(vr||(vr={}));function $n(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Ta(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return $n("enum",vr.VARINT,r,n)}function Zn(t,e){return $n("message",vr.LENGTH_DELIMITED,t,e)}var yt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(yt||(yt={}));var Ra;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ra||(Ra={}));(function(t){t.codec=()=>Ta(Ra)})(yt||(yt={}));var ge;(function(t){let e;t.codec=()=>(e==null&&(e=Zn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),yt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=yt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Wn(r,t.codec()),t.decode=r=>Yn(r,t.codec())})(ge||(ge={}));var fe;(function(t){let e;t.codec=()=>(e==null&&(e=Zn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),yt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=yt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Wn(r,t.codec()),t.decode=r=>Yn(r,t.codec())})(fe||(fe={}));var jr=class{_key;constructor(e){this._key=br(e,gr)}async verify(e,r){return $o(this._key,r,e)}marshal(){return this._key}get bytes(){return ge.encode({Type:yt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},Ze=class{_key;_publicKey;constructor(e,r){this._key=br(e,ye),this._publicKey=br(r,gr)}async sign(e){return Wo(this._key,e)}get public(){return new jr(this._publicKey)}marshal(){return this._key}get bytes(){return fe.encode({Type:yt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=Be.digest(this.public.bytes);return Bt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return xr(this.bytes,e);throw new k(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Bp(t){if(t.length>ye){t=br(t,ye+gr);let n=t.subarray(0,ye),i=t.subarray(ye,t.length);return new Ze(n,i)}t=br(t,ye);let e=t.subarray(0,ye),r=t.subarray(gr);return new Ze(e,r)}function Ap(t){return t=br(t,gr),new jr(t)}async function Cp(){let{privateKey:t,publicKey:e}=await Go();return new Ze(t,e)}async function V0(t){let{privateKey:e,publicKey:r}=await Yo(t);return new Ze(e,r)}function br(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new k(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var m2=tt(pt(),1),v2=tt(Nn(),1),q0=tt(J(),1);function Zt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ge([new Uint8Array(e-r.length),r])}return ot(r,"base64url")}function Kt(t){let e=z0(t);return new q0.default.jsbn.BigInteger(ot(e,"base16"),16)}function z0(t,e){let r=rt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ge([new Uint8Array(e-r.length),r])}return r}var Ip={"P-256":256,"P-384":384,"P-521":521},_p=Object.keys(Ip),R2=_p.join(" / ");async function H0(t,e){let r=Oe.decode(t);return Vn().decrypt(r,e)}var qa={};St(qa,{RsaPrivateKey:()=>Ir,RsaPublicKey:()=>on,fromJwk:()=>jp,generateKeyPair:()=>td,unmarshalRsaPrivateKey:()=>Xp,unmarshalRsaPublicKey:()=>Jp});var sn=tt(J(),1);var ug=tt(Z0(),1);var Rp=tt(pr(),1);var G=BigInt(0),st=BigInt(1),Pe=BigInt(2),rn=BigInt(3),Q0=BigInt(8),lt=Object.freeze({a:G,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:st,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),X0=(t,e)=>(t+e/Pe)/e,Xn={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=lt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-st*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=X0(a*t,e),f=X0(-n*t,e),c=R(t-o*r-f*i,e),u=R(-o*n-f*a,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Qt=32,Sr=32,kp=32,J0=Qt+1,j0=2*Qt+1;function tf(t){let{a:e,b:r}=lt,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var Jn=lt.a===G,ei=class extends Error{constructor(e){super(e)}};function ef(t){if(!(t instanceof Z))throw new TypeError("JacobianPoint expected")}var Z=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Q))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(Q.ZERO)?Z.ZERO:new Z(e.x,e.y,st)}static toAffineBatch(e){let r=Kp(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Z.toAffineBatch(e).map(Z.fromAffine)}equals(e){ef(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f);return u===h&&l===d}negate(){return new Z(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),a=R(r*r),s=R(a*a),o=e+a,f=R(Pe*(R(o*o)-i-s)),c=R(rn*i),u=R(c*c),h=R(u-Pe*f),l=R(c*(f-h)-Q0*s),d=R(Pe*r*n);return new Z(h,l,d)}add(e){ef(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e;if(a===G||s===G)return this;if(r===G||n===G)return e;let f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f),p=R(h-u),g=R(d-l);if(p===G)return g===G?this.double():Z.ZERO;let m=R(p*p),v=R(p*m),S=R(u*m),A=R(g*g-v-Pe*S),N=R(g*(S-A)-l*v),C=R(i*o*p);return new Z(A,N,C)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Z.ZERO;if(typeof e=="bigint"&&e===G)return r;let n=af(e);if(n===st)return this;if(!Jn){let h=r,l=this;for(;n>G;)n&st&&(h=h.add(l)),l=l.double(),n>>=st;return h}let{k1neg:i,k1:a,k2neg:s,k2:o}=Xn.splitScalar(n),f=r,c=r,u=this;for(;a>G||o>G;)a&st&&(f=f.add(u)),o&st&&(c=c.add(u)),u=u.double(),a>>=st,o>>=st;return i&&(f=f.negate()),s&&(c=c.negate()),c=new Z(R(c.x*Xn.beta),c.y,c.z),f.add(c)}precomputeWindow(e){let r=Jn?128/e+1:256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(Z.BASE)&&(r=Q.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Pa.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Z.normalizeZ(i),Pa.set(r,i)));let a=Z.ZERO,s=Z.BASE,o=1+(Jn?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=st);let g=d,m=d+Math.abs(p)-1,v=l%2!==0,S=p<0;p===0?s=s.add(jn(v,i[g])):a=a.add(jn(S,i[m]))}return{p:a,f:s}}multiply(e,r){let n=af(e),i,a;if(Jn){let{k1neg:s,k1:o,k2neg:f,k2:c}=Xn.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=jn(s,u),l=jn(f,l),l=new Z(R(l.x*Xn.beta),l.y,l.z),i=u.add(l),a=h.add(d)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return Z.normalizeZ([i,a])[0]}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(Z.ZERO);e==null&&(e=a?Q0:Cr(i));let s=e,o=R(s*s),f=R(o*s),c=R(r*o),u=R(n*f),h=R(i*s);if(a)return Q.ZERO;if(h!==st)throw new Error("invZ was invalid");return new Q(c,u)}};Z.BASE=new Z(lt.Gx,lt.Gy,st);Z.ZERO=new Z(G,st,G);function jn(t,e){let r=e.negate();return t?r:e}var Pa=new WeakMap,Q=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Pa.delete(this)}hasEvenY(){return this.y%Pe===G}static fromCompressedHex(e){let r=e.length===32,n=Ke(r?e:e.subarray(1));if(!La(n))throw new Error("Point is not on curve");let i=tf(n),a=Pp(i),s=(a&st)===st;r?s&&(a=R(-a)):(e[0]&1)===1!==s&&(a=R(-a));let o=new Q(n,a);return o.assertValidity(),o}static fromUncompressedHex(e){let r=Ke(e.subarray(1,Qt+1)),n=Ke(e.subarray(Qt+1,Qt*2+1)),i=new Q(r,n);return i.assertValidity(),i}static fromHex(e){let r=Ar(e),n=r.length,i=r[0];if(n===Qt)return this.fromCompressedHex(r);if(n===J0&&(i===2||i===3))return this.fromCompressedHex(r);if(n===j0&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${J0} compressed bytes or ${j0} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return Q.BASE.multiply(ni(e))}static fromSignature(e,r,n){let{r:i,s:a}=sf(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let s=Fa(Ar(e)),{n:o}=lt,f=n===2||n===3?i+o:i,c=Cr(f,o),u=R(-s*c,o),h=R(a*c,o),l=n&1?"03":"02",d=Q.fromHex(l+wr(f)),p=Q.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return Xe(this.toHex(e))}toHex(e=!1){let r=wr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${wr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!La(r)||!La(n))throw new Error(e);let i=R(n*n),a=tf(r);if(R(i-a)!==G)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Q(this.x,R(-this.y))}double(){return Z.fromAffine(this).double().toAffine()}add(e){return Z.fromAffine(this).add(Z.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Z.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=Z.fromAffine(this),a=r===G||r===st||this!==Q.BASE?i.multiplyUnsafe(r):i.multiply(r),s=Z.fromAffine(e).multiplyUnsafe(n),o=a.add(s);return o.equals(Z.ZERO)?void 0:o.toAffine()}};Q.BASE=new Q(lt.Gx,lt.Gy);Q.ZERO=new Q(G,G);function rf(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function nf(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Br(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ke(r),left:t.subarray(e+2)}}function Np(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Br(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=nf(t.subarray(2)),{data:n,left:i}=nf(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Br(i)}`);return{r:e,s:n}}var ce=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Br(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ce(ri(i.slice(0,64)),ri(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Np(r?e:Xe(e));return new ce(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!an(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!an(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=lt.n>>st;return this.s>e}normalizeS(){return this.hasHighS()?new ce(this.r,R(-this.s,lt.n)):this}toDERRawBytes(){return Xe(this.toDERHex())}toDERHex(){let e=rf(en(this.s)),r=rf(en(this.r)),n=e.length/2,i=r.length/2,a=en(n),s=en(i);return`30${en(i+n+4)}02${s}${r}02${a}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Xe(this.toCompactHex())}toCompactHex(){return wr(this.r)+wr(this.s)}};function Le(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Dp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Br(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=Dp[t[r]];return e}var Lp=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function wr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(G<=t&&t<Lp))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function Ka(t){let e=Xe(wr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function en(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ri(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Xe(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function Ke(t){return ri(Br(t))}function Ar(t){return t instanceof Uint8Array?Uint8Array.from(t):Xe(t)}function af(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&an(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=lt.P){let r=t%e;return r>=G?r:e+r}function zt(t,e){let{P:r}=lt,n=t;for(;e-- >G;)n*=n,n%=r;return n}function Pp(t){let{P:e}=lt,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),f=t*t*t%e,c=f*f*t%e,u=zt(c,rn)*c%e,h=zt(u,rn)*c%e,l=zt(h,Pe)*f%e,d=zt(l,n)*l%e,p=zt(d,i)*d%e,g=zt(p,s)*p%e,m=zt(g,o)*g%e,v=zt(m,s)*p%e,S=zt(v,rn)*c%e,A=zt(S,a)*d%e,N=zt(A,r)*f%e,C=zt(N,Pe);if(C*C%e!==t)throw new Error("Cannot find square root");return C}function Cr(t,e=lt.P){if(t===G||e<=G)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=G,a=st,s=st,o=G;for(;r!==G;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==st)throw new Error("invert: does not exist");return R(i,e)}function Kp(t,e=lt.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===G?a:(r[o]=a,R(a*s,e)),st),i=Cr(n,e);return t.reduceRight((a,s,o)=>s===G?a:(r[o]=R(a*r[o],e),R(a*s,e)),i),r}function Up(t){let e=t.length*8-Sr*8,r=Ke(t);return e>0?r>>BigInt(e):r}function Fa(t,e=!1){let r=Up(t);if(e)return r;let{n}=lt;return r>=n?r-n:r}var Er,nn,Ua=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Xt.hmacSha256(this.k,...e)}hmacSync(...e){return nn(this.k,...e)}checkSync(){if(typeof nn!="function")throw new ei("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Le(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Le(...r)}};function an(t){return G<t&&t<lt.n}function La(t){return G<t&&t<lt.P}function Fp(t,e,r,n=!0){let{n:i}=lt,a=Fa(t,!0);if(!an(a))return;let s=Cr(a,i),o=Q.BASE.multiply(a),f=R(o.x,i);if(f===G)return;let c=R(s*R(e+r*f,i),i);if(c===G)return;let u=new ce(f,c),h=(o.x===u.r?0:2)|Number(o.y&st);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function ni(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*Sr)throw new Error("Expected 32 bytes of private key");e=ri(t)}else if(t instanceof Uint8Array){if(t.length!==Sr)throw new Error("Expected 32 bytes of private key");e=Ke(t)}else throw new TypeError("Expected valid private key");if(!an(e))throw new Error("Expected private key: 0 < key < n");return e}function Op(t){return t instanceof Q?(t.assertValidity(),t):Q.fromHex(t)}function sf(t){if(t instanceof ce)return t.assertValidity(),t;try{return ce.fromDER(t)}catch{return ce.fromCompact(t)}}function Oa(t,e=!1){return Q.fromPrivateKey(t).toRawBytes(e)}function of(t){let e=t.length>Qt?t.slice(0,Qt):t;return Ke(e)}function Mp(t){let e=of(t),r=R(e,lt.n);return ff(r<G?e:r)}function ff(t){return Ka(t)}function Vp(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Ar(t),i=ni(e),a=[ff(i),Mp(n)];if(r!=null){r===!0&&(r=Xt.randomBytes(Qt));let f=Ar(r);if(f.length!==Qt)throw new Error(`sign: Expected ${Qt} bytes of extra data`);a.push(f)}let s=Le(...a),o=of(n);return{seed:s,m:o,d:i}}function qp(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:a}=Object.assign({canonical:!0,der:!0},e),s=i?r.toDERRawBytes():r.toCompactRawBytes();return a?[s,n]:s}async function cf(t,e,r={}){let{seed:n,m:i,d:a}=Vp(t,e,r.extraEntropy),s=new Ua(kp,Sr);await s.reseed(n);let o;for(;!(o=Fp(await s.generate(),i,a,r.canonical));)await s.reseed();return qp(o,r)}var zp={strict:!0};function uf(t,e,r,n=zp){let i;try{i=sf(t),e=Ar(e)}catch{return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=Fa(e),f;try{f=Op(r)}catch{return!1}let{n:c}=lt,u=Cr(s,c),h=R(o*u,c),l=R(a*u,c),d=Q.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===a:!1}Q.BASE._setWindowSize(8);var Ut={node:Rp,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var ti={},Xt={bytesToHex:Br,hexToBytes:Xe,concatBytes:Le,mod:R,invert:Cr,isValidPrivateKey(t){try{return ni(t),!0}catch{return!1}},_bigintTo32Bytes:Ka,_normalizePrivateKey:ni,hashToPrivateKey:t=>{t=Ar(t);let e=Sr+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Ke(t),lt.n-st)+st;return Ka(r)},randomBytes:(t=32)=>{if(Ut.web)return Ut.web.getRandomValues(new Uint8Array(t));if(Ut.node){let{randomBytes:e}=Ut.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Xt.hashToPrivateKey(Xt.randomBytes(Sr+8)),precompute(t=8,e=Q.BASE){let r=e===Q.BASE?e:new Q(e.x,e.y);return r._setWindowSize(t),r.multiply(rn),r},sha256:async(...t)=>{if(Ut.web){let e=await Ut.web.subtle.digest("SHA-256",Le(...t));return new Uint8Array(e)}else if(Ut.node){let{createHash:e}=Ut.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Ut.web){let r=await Ut.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Le(...e),i=await Ut.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Ut.node){let{createHmac:r}=Ut.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=ti[t];if(r===void 0){let n=await Xt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Le(n,n),ti[t]=r}return Xt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof Er!="function")throw new ei("sha256Sync is undefined, you need to set it");let r=ti[t];if(r===void 0){let n=Er(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Le(n,n),ti[t]=r}return Er(r,...e)},_JacobianPoint:Z};Object.defineProperties(Xt,{sha256Sync:{configurable:!1,get(){return Er},set(t){Er||(Er=t)}},hmacSha256Sync:{configurable:!1,get(){return nn},set(t){nn||(nn=t)}}});function Je(t){if(isNaN(t)||t<=0)throw new k("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Xt.randomBytes(t)}var Y2=tt(Pn(),1),Ma=tt(J(),1);function hf(t,e){return e.map(r=>Kt(t[r]))}function lf(t){return Ma.default.pki.setRsaPrivateKey(...hf(t,["n","e","d","p","q","dp","dq","qi"]))}function pf(t){return Ma.default.pki.setRsaPublicKey(...hf(t,["n","e"]))}var je={};St(je,{jwkToPkcs1:()=>Yp,jwkToPkix:()=>$p,pkcs1ToJwk:()=>Gp,pkixToJwk:()=>Wp});var Z2=tt(Hr(),1),Q2=tt(Pn(),1);var xe=tt(J(),1);function Gp(t){let e=xe.default.asn1.fromDer(ot(t,"ascii")),r=xe.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e),d:Zt(r.d),p:Zt(r.p),q:Zt(r.q),dp:Zt(r.dP),dq:Zt(r.dQ),qi:Zt(r.qInv),alg:"RS256"}}function Yp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new k("JWK was missing components","ERR_INVALID_PARAMETERS");let e=xe.default.pki.privateKeyToAsn1({n:Kt(t.n),e:Kt(t.e),d:Kt(t.d),p:Kt(t.p),q:Kt(t.q),dP:Kt(t.dp),dQ:Kt(t.dq),qInv:Kt(t.qi)});return rt(xe.default.asn1.toDer(e).getBytes(),"ascii")}function Wp(t){let e=xe.default.asn1.fromDer(ot(t,"ascii")),r=xe.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e)}}function $p(t){if(t.n==null||t.e==null)throw new k("JWK was missing components","ERR_INVALID_PARAMETERS");let e=xe.default.pki.publicKeyToAsn1({n:Kt(t.n),e:Kt(t.e)});return rt(xe.default.asn1.toDer(e).getBytes(),"ascii")}async function df(t){let e=await kt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await xf(e);return{privateKey:r[0],publicKey:r[1]}}async function Va(t){let r=[await kt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Zp(t)],n=await xf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function yf(t,e){let r=await kt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await kt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function gf(t,e,r){let n=await kt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return kt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function xf(t){if(t.privateKey==null||t.publicKey==null)throw new k("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([kt.get().subtle.exportKey("jwk",t.privateKey),kt.get().subtle.exportKey("jwk",t.publicKey)])}async function Zp(t){return kt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function mf(t,e,r,n){let i=e?pf(t):lf(t),a=ot(Uint8Array.from(r),"ascii"),s=n(a,i);return rt(s,"ascii")}function vf(t,e){return mf(t,!0,e,(r,n)=>n.encrypt(r))}function bf(t,e){return mf(t,!1,e,(r,n)=>n.decrypt(r))}var on=class{_key;constructor(e){this._key=e}async verify(e,r){return gf(this._key,r,e)}marshal(){return je.jwkToPkix(this._key)}get bytes(){return ge.encode({Type:yt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return vf(this._key,e)}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},Ir=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Je(16)}async sign(e){return yf(this._key,e)}get public(){if(this._publicKey==null)throw new k("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new on(this._publicKey)}decrypt(e){return bf(this._key,e)}marshal(){return je.jwkToPkcs1(this._key)}get bytes(){return fe.encode({Type:yt.RSA,Data:this.marshal()}).subarray()}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new sn.default.util.ByteBuffer(this.marshal()),i=sn.default.asn1.fromDer(n),a=sn.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return sn.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return xr(this.bytes,e);throw new k(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Xp(t){let e=je.pkcs1ToJwk(t),r=await Va(e);return new Ir(r.privateKey,r.publicKey)}function Jp(t){let e=je.pkixToJwk(t);return new on(e)}async function jp(t){let e=await Va(t);return new Ir(e.privateKey,e.publicKey)}async function td(t){let e=await df(t);return new Ir(e.privateKey,e.publicKey)}var Ha={};St(Ha,{Secp256k1PrivateKey:()=>cn,Secp256k1PublicKey:()=>fn,generateKeyPair:()=>id,unmarshalSecp256k1PrivateKey:()=>rd,unmarshalSecp256k1PublicKey:()=>nd});function wf(){return Xt.randomPrivateKey()}async function Ef(t,e){let{digest:r}=await At.digest(e);try{return await cf(r,t)}catch(n){throw new k(String(n),"ERR_INVALID_INPUT")}}async function Sf(t,e,r){try{let{digest:n}=await At.digest(r);return uf(e,n,t)}catch(n){throw new k(String(n),"ERR_INVALID_INPUT")}}function Bf(t){return Q.fromHex(t).toRawBytes(!0)}function Af(t){try{Oa(t,!0)}catch(e){throw new k(String(e),"ERR_INVALID_PRIVATE_KEY")}}function za(t){try{Q.fromHex(t)}catch(e){throw new k(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Cf(t){try{return Oa(t,!0)}catch(e){throw new k(String(e),"ERR_INVALID_PRIVATE_KEY")}}var fn=class{_key;constructor(e){za(e),this._key=e}async verify(e,r){return Sf(this._key,r,e)}marshal(){return Bf(this._key)}get bytes(){return ge.encode({Type:yt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},cn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Cf(e),Af(this._key),za(this._publicKey)}async sign(e){return Ef(this._key,e)}get public(){return new fn(this._publicKey)}marshal(){return this._key}get bytes(){return fe.encode({Type:yt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Pt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return xr(this.bytes,e);throw new k(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function rd(t){return new cn(t)}function nd(t){return new fn(t)}async function id(){let t=wf();return new cn(t)}var _r={rsa:qa,ed25519:ka,secp256k1:Ha};function If(t){let e=Object.keys(_r).join(" / ");return new k(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function ad(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return _r[t];throw If(t)}async function _f(t,e){return ad(t).generateKeyPair(e??2048)}async function Ga(t){let e=fe.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case yt.RSA:return _r.rsa.unmarshalRsaPrivateKey(r);case yt.Ed25519:return _r.ed25519.unmarshalEd25519PrivateKey(r);case yt.Secp256k1:return _r.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw If(e.Type??"RSA")}}async function un(t,e){try{let i=await H0(t,e);return await Ga(i)}catch{}let r=ii.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new k("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=ii.default.asn1.toDer(ii.default.pki.privateKeyToAsn1(r));return n=rt(n.getBytes(),"ascii"),_r.rsa.unmarshalRsaPrivateKey(n)}var Rf=tt($i(),1),kf=tt(pt(),1),Tf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function hn(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(Tf).join(" / ");throw new k(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=Tf[i],s=(0,Rf.default)(t,e,r,n,a);return kf.default.encode64(s,null)}var Ot=tt(Kf(),1);Ot.default.formatters.b=t=>t==null?"undefined":Bt.baseEncode(t);Ot.default.formatters.t=t=>t==null?"undefined":Se.baseEncode(t);Ot.default.formatters.m=t=>t==null?"undefined":Oe.baseEncode(t);Ot.default.formatters.p=t=>t==null?"undefined":t.toString();Ot.default.formatters.c=t=>t==null?"undefined":t.toString();Ot.default.formatters.k=t=>t==null?"undefined":t.toString();Ot.default.formatters.a=t=>t==null?"undefined":t.toString();function vd(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function Uf(t){let e=vd(`${t}:trace`);return Ot.default.enabled(`${t}:trace`)&&Ot.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Ot.default)(`${t}:trace`)),Object.assign((0,Ot.default)(t),{error:(0,Ot.default)(`${t}:error`),trace:e})}var Ff=Symbol.for("@libp2p/peer-id");var bd=Symbol.for("nodejs.util.inspect.custom"),Of=Object.values(lr).map(t=>t.decoder).reduce((t,e)=>t.or(e),lr.identity.decoder),Mf=114,Ya=36,Wa=37,ln=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Ff](){return!0}toString(){return this.string==null&&(this.string=Bt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return ut.createV1(Mf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Pt(this.multihash.bytes,e);if(typeof e=="string")return wd(e).equals(this);if(e?.multihash?.bytes!=null)return Pt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[bd](){return`PeerId(${this.toString()})`}},Nr=class extends ln{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},Dr=class extends ln{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},Lr=class extends ln{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function wd(t,e){if(e=e??Of,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Mr(Bt.decode(`z${t}`));return t.startsWith("12D")?new Dr({multihash:r}):t.startsWith("16U")?new Lr({multihash:r}):new Nr({multihash:r})}return Ed(Of.decode(t))}function Ed(t){try{let e=Mr(t);if(e.code===Be.code){if(e.digest.length===Ya)return new Dr({multihash:e});if(e.digest.length===Wa)return new Lr({multihash:e})}if(e.code===At.code)return new Nr({multihash:e})}catch{return Sd(ut.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Sd(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Mf)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===At.code)return new Nr({multihash:t.multihash});if(e.code===Be.code){if(e.digest.length===Ya)return new Dr({multihash:t.multihash});if(e.digest.length===Wa)return new Lr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Vf(t,e){return t.length===Ya?new Dr({multihash:Jt(Be.code,t),privateKey:e}):t.length===Wa?new Lr({multihash:Jt(Be.code,t),privateKey:e}):new Nr({multihash:await At.digest(t),publicKey:t,privateKey:e})}var qf=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");var me="/",zf=new TextEncoder().encode(me),oi=zf[0],Ct=class{_buf;constructor(e,r){if(typeof e=="string")this._buf=rt(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==oi)throw new Error("Invalid key")}toString(e="utf8"){return ot(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ct(e.join(me))}static random(){return new Ct(qf().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Ct(e):typeof e.uint8Array=="function"?new Ct(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=zf),this._buf[0]!==oi){let e=new Uint8Array(this._buf.byteLength+1);e.fill(oi,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===oi;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let a=r[i],s=n[i];if(a<s)return!0;if(a>s)return!1}return r.length<n.length}reverse(){return Ct.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(me).slice(1)}type(){return Bd(this.baseNamespace())}name(){return Ad(this.baseNamespace())}instance(e){return new Ct(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(me)||(e+=me),e+=this.type(),new Ct(e)}parent(){let e=this.list();return e.length===1?new Ct(me):new Ct(e.slice(0,-1).join(me))}child(e){return this.toString()===me?e:e.toString()===me?this:new Ct(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ct.withNamespaces([...this.namespaces(),...Cd(e.map(r=>r.namespaces()))])}};function Bd(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Ad(t){let e=t.split(":");return e[e.length-1]}function Cd(t){return[].concat(...t)}var Jf=tt(Xf(),1),jf=Jf.default;var cc=tt(fc(),1);var Y;(function(t){t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"})(Y||(Y={}));var ui=Uf("libp2p:keychain"),Hd="/pkcs8/",uc="/info/",er=new WeakMap,rr={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Za={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function ve(t){return t==null||typeof t!="string"?!1:t===(0,cc.default)(t.trim())&&t.length>0}async function j(){let r=Math.random()*800+200;await new Promise(n=>setTimeout(n,r))}function ue(t){return new Ct(Hd+t)}function Ue(t){return new Ct(uc+t)}var Qa=class{components;init;constructor(e,r){if(this.components=e,this.init=jf(Za,r),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<rr.minKeyLength)throw new Error(`dek.keyLength must be least ${rr.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<rr.minSaltLength)throw new Error(`dek.saltLength must be least ${rr.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<rr.minIterationCount)throw new Error(`dek.iterationCount must be least ${rr.minIterationCount}`);let n=this.init.pass!=null&&this.init.dek?.salt!=null?hn(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";er.set(this,{dek:n})}static generateOptions(){let e=Object.assign({},Za),r=Math.ceil(rr.minSaltLength/3)*3;return e.dek.salt=ot(Je(r),"base64"),e}static get options(){return Za}async createKey(e,r,n=2048){if(!ve(e)||e==="self")throw await j(),new k("Invalid key name",Y.ERR_INVALID_KEY_NAME);if(typeof r!="string")throw await j(),new k("Invalid key type",Y.ERR_INVALID_KEY_TYPE);let i=ue(e);if(await this.components.datastore.has(i))throw await j(),new k("Key name already exists",Y.ERR_KEY_ALREADY_EXISTS);switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await j(),new k("Invalid RSA key size",Y.ERR_INVALID_KEY_SIZE);break;default:break}let s;try{let o=await _f(r,n),f=await o.id(),c=er.get(this);if(c==null)throw new k("dek missing",Y.ERR_INVALID_PARAMETERS);let u=c.dek,h=await o.export(u);s={name:e,id:f};let l=this.components.datastore.batch();l.put(i,rt(h)),l.put(Ue(e),rt(JSON.stringify(s))),await l.commit()}catch(o){throw await j(),o}return s}async listKeys(){let e={prefix:uc},r=[];for await(let n of this.components.datastore.query(e))r.push(JSON.parse(ot(n.value)));return r}async findKeyById(e){try{let n=(await this.listKeys()).find(i=>i.id===e);if(n==null)throw new k(`Key with id '${e}' does not exist.`,Y.ERR_KEY_NOT_FOUND);return n}catch(r){throw await j(),r}}async findKeyByName(e){if(!ve(e))throw await j(),new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);let r=Ue(e);try{let n=await this.components.datastore.get(r);return JSON.parse(ot(n))}catch(n){throw await j(),ui.error(n),new k(`Key '${e}' does not exist.`,Y.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!ve(e)||e==="self")throw await j(),new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);let r=ue(e),n=await this.findKeyByName(e),i=this.components.datastore.batch();return i.delete(r),i.delete(Ue(e)),await i.commit(),n}async renameKey(e,r){if(!ve(e)||e==="self")throw await j(),new k(`Invalid old key name '${e}'`,Y.ERR_OLD_KEY_NAME_INVALID);if(!ve(r)||r==="self")throw await j(),new k(`Invalid new key name '${r}'`,Y.ERR_NEW_KEY_NAME_INVALID);let n=ue(e),i=ue(r),a=Ue(e),s=Ue(r);if(await this.components.datastore.has(i))throw await j(),new k(`Key '${r}' already exists`,Y.ERR_KEY_ALREADY_EXISTS);try{let f=await this.components.datastore.get(n),c=await this.components.datastore.get(a),u=JSON.parse(ot(c));u.name=r;let h=this.components.datastore.batch();return h.put(i,f),h.put(s,rt(JSON.stringify(u))),h.delete(n),h.delete(a),await h.commit(),u}catch(f){throw await j(),f}}async exportKey(e,r){if(!ve(e))throw await j(),new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);if(r==null)throw await j(),new k("Password is required",Y.ERR_PASSWORD_REQUIRED);let n=ue(e);try{let i=await this.components.datastore.get(n),a=ot(i),s=er.get(this);if(s==null)throw new k("dek missing",Y.ERR_INVALID_PARAMETERS);let o=s.dek;return await(await un(a,o)).export(r)}catch(i){throw await j(),i}}async exportPeerId(e){let r="temporary-password",n=await this.exportKey(e,r),i=await un(n,r);return Vf(i.public.bytes,i.bytes)}async importKey(e,r,n){if(!ve(e)||e==="self")throw await j(),new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);if(r==null)throw await j(),new k("PEM encoded key is required",Y.ERR_PEM_REQUIRED);let i=ue(e);if(await this.components.datastore.has(i))throw await j(),new k(`Key '${e}' already exists`,Y.ERR_KEY_ALREADY_EXISTS);let s;try{s=await un(r,n)}catch{throw await j(),new k("Cannot read the key, most likely the password is wrong",Y.ERR_CANNOT_READ_KEY)}let o;try{o=await s.id();let u=er.get(this);if(u==null)throw new k("dek missing",Y.ERR_INVALID_PARAMETERS);let h=u.dek;r=await s.export(h)}catch(u){throw await j(),u}let f={name:e,id:o},c=this.components.datastore.batch();return c.put(i,rt(r)),c.put(Ue(e),rt(JSON.stringify(f))),await c.commit(),f}async importPeer(e,r){try{if(!ve(e))throw new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);if(r==null)throw new k("PeerId is required",Y.ERR_MISSING_PRIVATE_KEY);if(r.privateKey==null)throw new k("PeerId.privKey is required",Y.ERR_MISSING_PRIVATE_KEY);let n=await Ga(r.privateKey),i=ue(e);if(await this.components.datastore.has(i))throw await j(),new k(`Key '${e}' already exists`,Y.ERR_KEY_ALREADY_EXISTS);let s=er.get(this);if(s==null)throw new k("dek missing",Y.ERR_INVALID_PARAMETERS);let o=s.dek,f=await n.export(o),c={name:e,id:r.toString()},u=this.components.datastore.batch();return u.put(i,rt(f)),u.put(Ue(e),rt(JSON.stringify(c))),await u.commit(),c}catch(n){throw await j(),n}}async getPrivateKey(e){if(!ve(e))throw await j(),new k(`Invalid key name '${e}'`,Y.ERR_INVALID_KEY_NAME);try{let r=ue(e),n=await this.components.datastore.get(r);return ot(n)}catch(r){throw await j(),ui.error(r),new k(`Key '${e}' does not exist.`,Y.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,r){if(typeof e!="string")throw await j(),new k(`Invalid old pass type '${typeof e}'`,Y.ERR_INVALID_OLD_PASS_TYPE);if(typeof r!="string")throw await j(),new k(`Invalid new pass type '${typeof r}'`,Y.ERR_INVALID_NEW_PASS_TYPE);if(r.length<20)throw await j(),new k(`Invalid pass length ${r.length}`,Y.ERR_INVALID_PASS_LENGTH);ui("recreating keychain");let n=er.get(this);if(n==null)throw new k("dek missing",Y.ERR_INVALID_PARAMETERS);let i=n.dek;this.init.pass=r;let a=r!=null&&this.init.dek?.salt!=null?hn(r,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";er.set(this,{dek:a});let s=await this.listKeys();for(let o of s){let f=await this.components.datastore.get(ue(o.name)),c=ot(f),u=await un(c,i),h=a.toString(),l=await u.export(h),d=this.components.datastore.batch(),p={name:o.name,id:o.id};d.put(ue(o.name),rt(l)),d.put(Ue(o.name),rt(JSON.stringify(p))),await d.commit()}ui("keychain reconstructed")}};return gc(Gd);})();
/*! Bundled license information:

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PKeychain}));
