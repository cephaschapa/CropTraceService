(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var _h=Object.create;var Cn=Object.defineProperty;var Th=Object.getOwnPropertyDescriptor;var Ih=Object.getOwnPropertyNames;var Lh=Object.getPrototypeOf,Rh=Object.prototype.hasOwnProperty;var Uh=(e,t,r)=>t in e?Cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Oa=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var K=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ht=(e,t)=>{for(var r in t)Cn(e,r,{get:t[r],enumerable:!0})},Ha=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ih(t))!Rh.call(e,i)&&i!==r&&Cn(e,i,{get:()=>t[i],enumerable:!(n=Th(t,i))||n.enumerable});return e};var xt=(e,t,r)=>(r=e!=null?_h(Lh(e)):{},Ha(t||!e||!e.__esModule?Cn(r,"default",{value:e,enumerable:!0}):r,e)),Nh=e=>Ha(Cn({},"__esModule",{value:!0}),e);var fi=(e,t,r)=>(Uh(e,typeof t!="symbol"?t+"":t,r),r);var As=K((Y2,Wa)=>{"use strict";function Ga(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function qh(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return Ga(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),Ga(new i,r)}}Wa.exports=qh});var n0=K(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});function ll(e,t){var r=e>>>16&65535,n=e&65535,i=t>>>16&65535,s=t&65535;return n*s+(r*s+n*i<<16>>>0)|0}ce.mul=Math.imul||ll;function pl(e,t){return e+t|0}ce.add=pl;function dl(e,t){return e-t|0}ce.sub=dl;function yl(e,t){return e<<t|e>>>32-t}ce.rotl=yl;function gl(e,t){return e<<32-t|e>>>t}ce.rotr=gl;function xl(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}ce.isInteger=Number.isInteger||xl;ce.MAX_SAFE_INTEGER=9007199254740991;ce.isSafeInteger=function(e){return ce.isInteger(e)&&e>=-ce.MAX_SAFE_INTEGER&&e<=ce.MAX_SAFE_INTEGER}});var Si=K(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});var i0=n0();function ml(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}Y.readInt16BE=ml;function vl(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}Y.readUint16BE=vl;function wl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}Y.readInt16LE=wl;function bl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}Y.readUint16LE=bl;function s0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}Y.writeUint16BE=s0;Y.writeInt16BE=s0;function o0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}Y.writeUint16LE=o0;Y.writeInt16LE=o0;function ks(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}Y.readInt32BE=ks;function Ks(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}Y.readUint32BE=Ks;function Ms(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}Y.readInt32LE=Ms;function Fs(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}Y.readUint32LE=Fs;function bi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}Y.writeUint32BE=bi;Y.writeInt32BE=bi;function Ei(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}Y.writeUint32LE=Ei;Y.writeInt32LE=Ei;function El(e,t){t===void 0&&(t=0);var r=ks(e,t),n=ks(e,t+4);return r*4294967296+n-(n>>31)*4294967296}Y.readInt64BE=El;function Sl(e,t){t===void 0&&(t=0);var r=Ks(e,t),n=Ks(e,t+4);return r*4294967296+n}Y.readUint64BE=Sl;function Bl(e,t){t===void 0&&(t=0);var r=Ms(e,t),n=Ms(e,t+4);return n*4294967296+r-(r>>31)*4294967296}Y.readInt64LE=Bl;function Al(e,t){t===void 0&&(t=0);var r=Fs(e,t),n=Fs(e,t+4);return n*4294967296+r}Y.readUint64LE=Al;function a0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),bi(e/4294967296>>>0,t,r),bi(e>>>0,t,r+4),t}Y.writeUint64BE=a0;Y.writeInt64BE=a0;function f0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ei(e>>>0,t,r),Ei(e/4294967296>>>0,t,r+4),t}Y.writeUint64LE=f0;Y.writeInt64LE=f0;function Cl(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}Y.readUintBE=Cl;function _l(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}Y.readUintLE=_l;function Tl(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!i0.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}Y.writeUintBE=Tl;function Il(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!i0.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}Y.writeUintLE=Il;function Ll(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}Y.readFloat32BE=Ll;function Rl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}Y.readFloat32LE=Rl;function Ul(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}Y.readFloat64BE=Ul;function Nl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}Y.readFloat64LE=Nl;function Dl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}Y.writeFloat32BE=Dl;function Pl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}Y.writeFloat32LE=Pl;function kl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}Y.writeFloat64BE=kl;function Kl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}Y.writeFloat64LE=Kl});var Er=K(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});function Ml(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Os.wipe=Ml});var u0=K(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});var jt=Si(),Hs=Er(),Fl=20;function Ol(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],c=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],y=t[3]<<24|t[2]<<16|t[1]<<8|t[0],x=t[7]<<24|t[6]<<16|t[5]<<8|t[4],m=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=n,C=i,B=s,A=o,L=a,R=f,P=c,O=u,G=h,z=l,rt=d,pt=p,F=y,V=x,S=m,H=b,gt=0;gt<Fl;gt+=2)w=w+L|0,F^=w,F=F>>>32-16|F<<16,G=G+F|0,L^=G,L=L>>>32-12|L<<12,C=C+R|0,V^=C,V=V>>>32-16|V<<16,z=z+V|0,R^=z,R=R>>>32-12|R<<12,B=B+P|0,S^=B,S=S>>>32-16|S<<16,rt=rt+S|0,P^=rt,P=P>>>32-12|P<<12,A=A+O|0,H^=A,H=H>>>32-16|H<<16,pt=pt+H|0,O^=pt,O=O>>>32-12|O<<12,B=B+P|0,S^=B,S=S>>>32-8|S<<8,rt=rt+S|0,P^=rt,P=P>>>32-7|P<<7,A=A+O|0,H^=A,H=H>>>32-8|H<<8,pt=pt+H|0,O^=pt,O=O>>>32-7|O<<7,C=C+R|0,V^=C,V=V>>>32-8|V<<8,z=z+V|0,R^=z,R=R>>>32-7|R<<7,w=w+L|0,F^=w,F=F>>>32-8|F<<8,G=G+F|0,L^=G,L=L>>>32-7|L<<7,w=w+R|0,H^=w,H=H>>>32-16|H<<16,rt=rt+H|0,R^=rt,R=R>>>32-12|R<<12,C=C+P|0,F^=C,F=F>>>32-16|F<<16,pt=pt+F|0,P^=pt,P=P>>>32-12|P<<12,B=B+O|0,V^=B,V=V>>>32-16|V<<16,G=G+V|0,O^=G,O=O>>>32-12|O<<12,A=A+L|0,S^=A,S=S>>>32-16|S<<16,z=z+S|0,L^=z,L=L>>>32-12|L<<12,B=B+O|0,V^=B,V=V>>>32-8|V<<8,G=G+V|0,O^=G,O=O>>>32-7|O<<7,A=A+L|0,S^=A,S=S>>>32-8|S<<8,z=z+S|0,L^=z,L=L>>>32-7|L<<7,C=C+P|0,F^=C,F=F>>>32-8|F<<8,pt=pt+F|0,P^=pt,P=P>>>32-7|P<<7,w=w+R|0,H^=w,H=H>>>32-8|H<<8,rt=rt+H|0,R^=rt,R=R>>>32-7|R<<7;jt.writeUint32LE(w+n|0,e,0),jt.writeUint32LE(C+i|0,e,4),jt.writeUint32LE(B+s|0,e,8),jt.writeUint32LE(A+o|0,e,12),jt.writeUint32LE(L+a|0,e,16),jt.writeUint32LE(R+f|0,e,20),jt.writeUint32LE(P+c|0,e,24),jt.writeUint32LE(O+u|0,e,28),jt.writeUint32LE(G+h|0,e,32),jt.writeUint32LE(z+l|0,e,36),jt.writeUint32LE(rt+d|0,e,40),jt.writeUint32LE(pt+p|0,e,44),jt.writeUint32LE(F+y|0,e,48),jt.writeUint32LE(V+x|0,e,52),jt.writeUint32LE(S+m|0,e,56),jt.writeUint32LE(H+b|0,e,60)}function c0(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-t.length,s.set(t,o)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,o=i}for(var a=new Uint8Array(64),f=0;f<r.length;f+=64){Ol(a,s,e);for(var c=f;c<f+64&&c<r.length;c++)n[c]=r[c]^a[c-f];Vl(s,0,o)}return Hs.wipe(a),i===0&&Hs.wipe(s),n}Bi.streamXOR=c0;function Hl(e,t,r,n){return n===void 0&&(n=0),Hs.wipe(r),c0(e,t,r,r,n)}Bi.stream=Hl;function Vl(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}});var Vs=K(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});function ql(e,t,r){return~(e-1)&t|e-1&r}Wr.select=ql;function zl(e,t){return(e|0)-(t|0)-1>>>31&1}Wr.lessOrEqual=zl;function h0(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Wr.compare=h0;function Gl(e,t){return e.length===0||t.length===0?!1:h0(e,t)!==0}Wr.equal=Gl});var p0=K(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});var Wl=Vs(),Ai=Er();ze.DIGEST_LENGTH=16;var l0=function(){function e(t){this.digestLength=ze.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=r&8191;var n=t[2]|t[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=t[4]|t[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=t[6]|t[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var o=t[8]|t[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=t[10]|t[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var f=t[12]|t[13]<<8;this._r[7]=(a>>>11|f<<5)&8065;var c=t[14]|t[15]<<8;this._r[8]=(f>>>8|c<<8)&8191,this._r[9]=c>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return e.prototype._blocks=function(t,r,n){for(var i=this._fin?0:2048,s=this._h[0],o=this._h[1],a=this._h[2],f=this._h[3],c=this._h[4],u=this._h[5],h=this._h[6],l=this._h[7],d=this._h[8],p=this._h[9],y=this._r[0],x=this._r[1],m=this._r[2],b=this._r[3],w=this._r[4],C=this._r[5],B=this._r[6],A=this._r[7],L=this._r[8],R=this._r[9];n>=16;){var P=t[r+0]|t[r+1]<<8;s+=P&8191;var O=t[r+2]|t[r+3]<<8;o+=(P>>>13|O<<3)&8191;var G=t[r+4]|t[r+5]<<8;a+=(O>>>10|G<<6)&8191;var z=t[r+6]|t[r+7]<<8;f+=(G>>>7|z<<9)&8191;var rt=t[r+8]|t[r+9]<<8;c+=(z>>>4|rt<<12)&8191,u+=rt>>>1&8191;var pt=t[r+10]|t[r+11]<<8;h+=(rt>>>14|pt<<2)&8191;var F=t[r+12]|t[r+13]<<8;l+=(pt>>>11|F<<5)&8191;var V=t[r+14]|t[r+15]<<8;d+=(F>>>8|V<<8)&8191,p+=V>>>5|i;var S=0,H=S;H+=s*y,H+=o*(5*R),H+=a*(5*L),H+=f*(5*A),H+=c*(5*B),S=H>>>13,H&=8191,H+=u*(5*C),H+=h*(5*w),H+=l*(5*b),H+=d*(5*m),H+=p*(5*x),S+=H>>>13,H&=8191;var gt=S;gt+=s*x,gt+=o*y,gt+=a*(5*R),gt+=f*(5*L),gt+=c*(5*A),S=gt>>>13,gt&=8191,gt+=u*(5*B),gt+=h*(5*C),gt+=l*(5*w),gt+=d*(5*b),gt+=p*(5*m),S+=gt>>>13,gt&=8191;var X=S;X+=s*m,X+=o*x,X+=a*y,X+=f*(5*R),X+=c*(5*L),S=X>>>13,X&=8191,X+=u*(5*A),X+=h*(5*B),X+=l*(5*C),X+=d*(5*w),X+=p*(5*b),S+=X>>>13,X&=8191;var Z=S;Z+=s*b,Z+=o*m,Z+=a*x,Z+=f*y,Z+=c*(5*R),S=Z>>>13,Z&=8191,Z+=u*(5*L),Z+=h*(5*A),Z+=l*(5*B),Z+=d*(5*C),Z+=p*(5*w),S+=Z>>>13,Z&=8191;var Q=S;Q+=s*w,Q+=o*b,Q+=a*m,Q+=f*x,Q+=c*y,S=Q>>>13,Q&=8191,Q+=u*(5*R),Q+=h*(5*L),Q+=l*(5*A),Q+=d*(5*B),Q+=p*(5*C),S+=Q>>>13,Q&=8191;var ot=S;ot+=s*C,ot+=o*w,ot+=a*b,ot+=f*m,ot+=c*x,S=ot>>>13,ot&=8191,ot+=u*y,ot+=h*(5*R),ot+=l*(5*L),ot+=d*(5*A),ot+=p*(5*B),S+=ot>>>13,ot&=8191;var at=S;at+=s*B,at+=o*C,at+=a*w,at+=f*b,at+=c*m,S=at>>>13,at&=8191,at+=u*x,at+=h*y,at+=l*(5*R),at+=d*(5*L),at+=p*(5*A),S+=at>>>13,at&=8191;var ft=S;ft+=s*A,ft+=o*B,ft+=a*C,ft+=f*w,ft+=c*b,S=ft>>>13,ft&=8191,ft+=u*m,ft+=h*x,ft+=l*y,ft+=d*(5*R),ft+=p*(5*L),S+=ft>>>13,ft&=8191;var ct=S;ct+=s*L,ct+=o*A,ct+=a*B,ct+=f*C,ct+=c*w,S=ct>>>13,ct&=8191,ct+=u*b,ct+=h*m,ct+=l*x,ct+=d*y,ct+=p*(5*R),S+=ct>>>13,ct&=8191;var ut=S;ut+=s*R,ut+=o*L,ut+=a*A,ut+=f*B,ut+=c*C,S=ut>>>13,ut&=8191,ut+=u*w,ut+=h*b,ut+=l*m,ut+=d*x,ut+=p*y,S+=ut>>>13,ut&=8191,S=(S<<2)+S|0,S=S+H|0,H=S&8191,S=S>>>13,gt+=S,s=H,o=gt,a=X,f=Z,c=Q,u=ot,h=at,l=ft,d=ct,p=ut,r+=16,n-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=f,this._h[4]=c,this._h[5]=u,this._h[6]=h,this._h[7]=l,this._h[8]=d,this._h[9]=p},e.prototype.finish=function(t,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=i,i=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,a=1;a<10;a++)n[a]=this._h[a]+i,i=n[a]>>>13,n[a]&=8191;for(n[9]-=8192,s=(i^1)-1,a=0;a<10;a++)n[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|n[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return t[r+0]=this._h[0]>>>0,t[r+1]=this._h[0]>>>8,t[r+2]=this._h[1]>>>0,t[r+3]=this._h[1]>>>8,t[r+4]=this._h[2]>>>0,t[r+5]=this._h[2]>>>8,t[r+6]=this._h[3]>>>0,t[r+7]=this._h[3]>>>8,t[r+8]=this._h[4]>>>0,t[r+9]=this._h[4]>>>8,t[r+10]=this._h[5]>>>0,t[r+11]=this._h[5]>>>8,t[r+12]=this._h[6]>>>0,t[r+13]=this._h[6]>>>8,t[r+14]=this._h[7]>>>0,t[r+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(t){var r=0,n=t.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=t[r+s];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(t,r,i),r+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=t[r+s];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},e.prototype.clean=function(){return Ai.wipe(this._buffer),Ai.wipe(this._r),Ai.wipe(this._h),Ai.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();ze.Poly1305=l0;function Yl(e,t){var r=new l0(e);r.update(t);var n=r.digest();return r.clean(),n}ze.oneTimeAuth=Yl;function $l(e,t){return e.length!==ze.DIGEST_LENGTH||t.length!==ze.DIGEST_LENGTH?!1:Wl.equal(e,t)}ze.equal=$l});var qs=K(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});var Ci=u0(),Xl=p0(),Tn=Er(),d0=Si(),Zl=Vs();Ge.KEY_LENGTH=32;Ge.NONCE_LENGTH=12;Ge.TAG_LENGTH=16;var y0=new Uint8Array(16),Ql=function(){function e(t){if(this.nonceLength=Ge.NONCE_LENGTH,this.tagLength=Ge.TAG_LENGTH,t.length!==Ge.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return e.prototype.seal=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(t,s.length-t.length);var o=new Uint8Array(32);Ci.stream(this._key,s,o,4);var a=r.length+this.tagLength,f;if(i){if(i.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");f=i}else f=new Uint8Array(a);return Ci.streamXOR(this._key,s,r,f,4),this._authenticate(f.subarray(f.length-this.tagLength,f.length),o,f.subarray(0,f.length-this.tagLength),n),Tn.wipe(s),f},e.prototype.open=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(t,s.length-t.length);var o=new Uint8Array(32);Ci.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),n),!Zl.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var f=r.length-this.tagLength,c;if(i){if(i.length!==f)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(f);return Ci.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),c,4),Tn.wipe(s),c},e.prototype.clean=function(){return Tn.wipe(this._key),this},e.prototype._authenticate=function(t,r,n,i){var s=new Xl.Poly1305(r);i&&(s.update(i),i.length%16>0&&s.update(y0.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(y0.subarray(n.length%16));var o=new Uint8Array(8);i&&d0.writeUint64LE(i.length,o),s.update(o),d0.writeUint64LE(n.length,o),s.update(o);for(var a=s.digest(),f=0;f<a.length;f++)t[f]=a[f];s.clean(),Tn.wipe(a),Tn.wipe(o)},e}();Ge.ChaCha20Poly1305=Ql});var x0=K(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.BrowserRandomSource=void 0;var g0=65536,zs=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(t);for(let n=0;n<r.length;n+=g0)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,g0)));return r}};_i.BrowserRandomSource=zs});var Sr=K(()=>{});var m0=K(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.NodeRandomSource=void 0;var Jl=Er(),Gs=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Oa<"u"){let t=Sr();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Jl.wipe)(r),n}};Ti.NodeRandomSource=Gs});var v0=K(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.SystemRandomSource=void 0;var jl=x0(),tp=m0(),Ws=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new jl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new tp.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};Ii.SystemRandomSource=Ws});var S0=K(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.randomStringForEntropy=te.randomString=te.randomUint32=te.randomBytes=te.defaultRandomSource=void 0;var ep=v0(),rp=Si(),w0=Er();te.defaultRandomSource=new ep.SystemRandomSource;function Ys(e,t=te.defaultRandomSource){return t.randomBytes(e)}te.randomBytes=Ys;function np(e=te.defaultRandomSource){let t=Ys(4,e),r=(0,rp.readUint32LE)(t);return(0,w0.wipe)(t),r}te.randomUint32=np;var b0="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function E0(e,t=b0,r=te.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let n="",i=t.length,s=256-256%i;for(;e>0;){let o=Ys(Math.ceil(e*256/s),r);for(let a=0;a<o.length&&e>0;a++){let f=o[a];f<s&&(n+=t.charAt(f%i),e--)}(0,w0.wipe)(o)}return n}te.randomString=E0;function ip(e,t=b0,r=te.defaultRandomSource){let n=Math.ceil(e/(Math.log(t.length)/Math.LN2));return E0(n,t,r)}te.randomStringForEntropy=ip});var _0=K(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.sharedKey=Tt.generateKeyPair=Tt.generateKeyPairFromSeed=Tt.scalarMultBase=Tt.scalarMult=Tt.SHARED_KEY_LENGTH=Tt.SECRET_KEY_LENGTH=Tt.PUBLIC_KEY_LENGTH=void 0;var sp=S0(),op=Er();Tt.PUBLIC_KEY_LENGTH=32;Tt.SECRET_KEY_LENGTH=32;Tt.SHARED_KEY_LENGTH=32;function Te(e){let t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}var B0=new Uint8Array(32);B0[0]=9;var ap=Te([56129,1]);function $s(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-t*65536}e[0]+=t-1+37*(t-1)}function In(e,t,r){let n=~(r-1);for(let i=0;i<16;i++){let s=n&(e[i]^t[i]);e[i]^=s,t[i]^=s}}function fp(e,t){let r=Te(),n=Te();for(let i=0;i<16;i++)n[i]=t[i];$s(n),$s(n),$s(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let o=1;o<15;o++)r[o]=n[o]-65535-(r[o-1]>>16&1),r[o-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);let s=r[15]>>16&1;r[14]&=65535,In(n,r,1-s)}for(let i=0;i<16;i++)e[2*i]=n[i]&255,e[2*i+1]=n[i]>>8}function cp(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function Li(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function Ri(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function We(e,t,r){let n,i,s=0,o=0,a=0,f=0,c=0,u=0,h=0,l=0,d=0,p=0,y=0,x=0,m=0,b=0,w=0,C=0,B=0,A=0,L=0,R=0,P=0,O=0,G=0,z=0,rt=0,pt=0,F=0,V=0,S=0,H=0,gt=0,X=r[0],Z=r[1],Q=r[2],ot=r[3],at=r[4],ft=r[5],ct=r[6],ut=r[7],Gt=r[8],Wt=r[9],Yt=r[10],$t=r[11],Xt=r[12],Zt=r[13],Qt=r[14],Jt=r[15];n=t[0],s+=n*X,o+=n*Z,a+=n*Q,f+=n*ot,c+=n*at,u+=n*ft,h+=n*ct,l+=n*ut,d+=n*Gt,p+=n*Wt,y+=n*Yt,x+=n*$t,m+=n*Xt,b+=n*Zt,w+=n*Qt,C+=n*Jt,n=t[1],o+=n*X,a+=n*Z,f+=n*Q,c+=n*ot,u+=n*at,h+=n*ft,l+=n*ct,d+=n*ut,p+=n*Gt,y+=n*Wt,x+=n*Yt,m+=n*$t,b+=n*Xt,w+=n*Zt,C+=n*Qt,B+=n*Jt,n=t[2],a+=n*X,f+=n*Z,c+=n*Q,u+=n*ot,h+=n*at,l+=n*ft,d+=n*ct,p+=n*ut,y+=n*Gt,x+=n*Wt,m+=n*Yt,b+=n*$t,w+=n*Xt,C+=n*Zt,B+=n*Qt,A+=n*Jt,n=t[3],f+=n*X,c+=n*Z,u+=n*Q,h+=n*ot,l+=n*at,d+=n*ft,p+=n*ct,y+=n*ut,x+=n*Gt,m+=n*Wt,b+=n*Yt,w+=n*$t,C+=n*Xt,B+=n*Zt,A+=n*Qt,L+=n*Jt,n=t[4],c+=n*X,u+=n*Z,h+=n*Q,l+=n*ot,d+=n*at,p+=n*ft,y+=n*ct,x+=n*ut,m+=n*Gt,b+=n*Wt,w+=n*Yt,C+=n*$t,B+=n*Xt,A+=n*Zt,L+=n*Qt,R+=n*Jt,n=t[5],u+=n*X,h+=n*Z,l+=n*Q,d+=n*ot,p+=n*at,y+=n*ft,x+=n*ct,m+=n*ut,b+=n*Gt,w+=n*Wt,C+=n*Yt,B+=n*$t,A+=n*Xt,L+=n*Zt,R+=n*Qt,P+=n*Jt,n=t[6],h+=n*X,l+=n*Z,d+=n*Q,p+=n*ot,y+=n*at,x+=n*ft,m+=n*ct,b+=n*ut,w+=n*Gt,C+=n*Wt,B+=n*Yt,A+=n*$t,L+=n*Xt,R+=n*Zt,P+=n*Qt,O+=n*Jt,n=t[7],l+=n*X,d+=n*Z,p+=n*Q,y+=n*ot,x+=n*at,m+=n*ft,b+=n*ct,w+=n*ut,C+=n*Gt,B+=n*Wt,A+=n*Yt,L+=n*$t,R+=n*Xt,P+=n*Zt,O+=n*Qt,G+=n*Jt,n=t[8],d+=n*X,p+=n*Z,y+=n*Q,x+=n*ot,m+=n*at,b+=n*ft,w+=n*ct,C+=n*ut,B+=n*Gt,A+=n*Wt,L+=n*Yt,R+=n*$t,P+=n*Xt,O+=n*Zt,G+=n*Qt,z+=n*Jt,n=t[9],p+=n*X,y+=n*Z,x+=n*Q,m+=n*ot,b+=n*at,w+=n*ft,C+=n*ct,B+=n*ut,A+=n*Gt,L+=n*Wt,R+=n*Yt,P+=n*$t,O+=n*Xt,G+=n*Zt,z+=n*Qt,rt+=n*Jt,n=t[10],y+=n*X,x+=n*Z,m+=n*Q,b+=n*ot,w+=n*at,C+=n*ft,B+=n*ct,A+=n*ut,L+=n*Gt,R+=n*Wt,P+=n*Yt,O+=n*$t,G+=n*Xt,z+=n*Zt,rt+=n*Qt,pt+=n*Jt,n=t[11],x+=n*X,m+=n*Z,b+=n*Q,w+=n*ot,C+=n*at,B+=n*ft,A+=n*ct,L+=n*ut,R+=n*Gt,P+=n*Wt,O+=n*Yt,G+=n*$t,z+=n*Xt,rt+=n*Zt,pt+=n*Qt,F+=n*Jt,n=t[12],m+=n*X,b+=n*Z,w+=n*Q,C+=n*ot,B+=n*at,A+=n*ft,L+=n*ct,R+=n*ut,P+=n*Gt,O+=n*Wt,G+=n*Yt,z+=n*$t,rt+=n*Xt,pt+=n*Zt,F+=n*Qt,V+=n*Jt,n=t[13],b+=n*X,w+=n*Z,C+=n*Q,B+=n*ot,A+=n*at,L+=n*ft,R+=n*ct,P+=n*ut,O+=n*Gt,G+=n*Wt,z+=n*Yt,rt+=n*$t,pt+=n*Xt,F+=n*Zt,V+=n*Qt,S+=n*Jt,n=t[14],w+=n*X,C+=n*Z,B+=n*Q,A+=n*ot,L+=n*at,R+=n*ft,P+=n*ct,O+=n*ut,G+=n*Gt,z+=n*Wt,rt+=n*Yt,pt+=n*$t,F+=n*Xt,V+=n*Zt,S+=n*Qt,H+=n*Jt,n=t[15],C+=n*X,B+=n*Z,A+=n*Q,L+=n*ot,R+=n*at,P+=n*ft,O+=n*ct,G+=n*ut,z+=n*Gt,rt+=n*Wt,pt+=n*Yt,F+=n*$t,V+=n*Xt,S+=n*Zt,H+=n*Qt,gt+=n*Jt,s+=38*B,o+=38*A,a+=38*L,f+=38*R,c+=38*P,u+=38*O,h+=38*G,l+=38*z,d+=38*rt,p+=38*pt,y+=38*F,x+=38*V,m+=38*S,b+=38*H,w+=38*gt,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=f,e[4]=c,e[5]=u,e[6]=h,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=x,e[12]=m,e[13]=b,e[14]=w,e[15]=C}function Ln(e,t){We(e,t,t)}function up(e,t){let r=Te();for(let n=0;n<16;n++)r[n]=t[n];for(let n=253;n>=0;n--)Ln(r,r),n!==2&&n!==4&&We(r,r,t);for(let n=0;n<16;n++)e[n]=r[n]}function Xs(e,t){let r=new Uint8Array(32),n=new Float64Array(80),i=Te(),s=Te(),o=Te(),a=Te(),f=Te(),c=Te();for(let d=0;d<31;d++)r[d]=e[d];r[31]=e[31]&127|64,r[0]&=248,cp(n,t);for(let d=0;d<16;d++)s[d]=n[d];i[0]=a[0]=1;for(let d=254;d>=0;--d){let p=r[d>>>3]>>>(d&7)&1;In(i,s,p),In(o,a,p),Li(f,i,o),Ri(i,i,o),Li(o,s,a),Ri(s,s,a),Ln(a,f),Ln(c,i),We(i,o,i),We(o,s,f),Li(f,i,o),Ri(i,i,o),Ln(s,i),Ri(o,a,c),We(i,o,ap),Li(i,i,a),We(o,o,i),We(i,a,c),We(a,s,n),Ln(s,f),In(i,s,p),In(o,a,p)}for(let d=0;d<16;d++)n[d+16]=i[d],n[d+32]=o[d],n[d+48]=s[d],n[d+64]=a[d];let u=n.subarray(32),h=n.subarray(16);up(u,u),We(h,h,u);let l=new Uint8Array(32);return fp(l,h),l}Tt.scalarMult=Xs;function A0(e){return Xs(e,B0)}Tt.scalarMultBase=A0;function C0(e){if(e.length!==Tt.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${Tt.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(e);return{publicKey:A0(t),secretKey:t}}Tt.generateKeyPairFromSeed=C0;function hp(e){let t=(0,sp.randomBytes)(32,e),r=C0(t);return(0,op.wipe)(t),r}Tt.generateKeyPair=hp;function lp(e,t,r=!1){if(e.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(t.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let n=Xs(e,t);if(r){let i=0;for(let s=0;s<n.length;s++)i|=n[s];if(i===0)throw new Error("X25519: invalid shared key")}return n}Tt.sharedKey=lp});var dt=K((fm,K0)=>{K0.exports={options:{usePureJavaScript:!1}}});var O0=K((cm,F0)=>{var to={};F0.exports=to;var M0={};to.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=dp(e,t);else{var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var f=0,c=e[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%s,c=c/s|0;for(;c>0;)a.push(c%s),c=c/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};to.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=M0[t];if(!r){r=M0[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<o.length;++f)c+=o[f]*i,o[f]=c&255,c>>=8;for(;c>0;)o.push(c&255),c>>=8}for(var u=0;e[u]===s&&u<e.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function dp(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=t[s[r]];return f}});var Ut=K((um,z0)=>{var H0=dt(),V0=O0(),g=z0.exports=H0.util=H0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(a){return setImmediate(a)};return}if(g.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var c=t.slice();t.length=0,c.forEach(function(u){u()})}};var o=a,e="forge.setImmediate",t=[];g.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var s=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(t.push(f),t.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};g.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};g.isArrayBufferView=function(e){return e&&g.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Nn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}g.ByteBuffer=eo;function eo(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(g.isArrayBuffer(e)||g.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof eo||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}g.ByteStringBuffer=eo;var yp=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>yp&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};g.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};g.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};g.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(g.encodeUtf8(e))};g.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};g.ByteStringBuffer.prototype.putInt=function(e,t){Nn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};g.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};g.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};g.ByteStringBuffer.prototype.getInt=function(e){Nn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};g.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};g.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var e=g.createBuffer(this.data);return e.read=this.read,e};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function gp(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=g.isArrayBuffer(e),n=g.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}g.DataBuffer=gp;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};g.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};g.DataBuffer.prototype.putBytes=function(e,t){if(g.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof g.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&g.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof g.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=g.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};g.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};g.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};g.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(e,t){Nn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};g.DataBuffer.prototype.putSignedInt=function(e,t){return Nn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};g.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};g.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};g.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};g.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};g.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};g.DataBuffer.prototype.getInt=function(e){Nn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};g.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};g.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return g.binary.raw.encode(t);if(e==="hex")return g.binary.hex.encode(t);if(e==="base64")return g.binary.base64.encode(t);if(e==="utf8")return g.text.utf8.decode(t);if(e==="utf16")return g.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};g.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=g.encodeUtf8(e)),new g.ByteBuffer(e)};g.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};g.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};g.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};g.bytesToHex=function(e){return g.createBuffer(e).toHex()};g.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var ir="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],q0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.length;)i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=ir.charAt(i>>2),r+=ir.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ir.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ir.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,o=0;o<e.length;)r=sr[e.charCodeAt(o++)-43],n=sr[e.charCodeAt(o++)-43],i=sr[e.charCodeAt(o++)-43],s=sr[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};g.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};g.decodeUtf8=function(e){return decodeURIComponent(escape(e))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:V0.encode,decode:V0.decode}};g.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};g.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};g.binary.base64.encode=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.byteLength;)i=e[a++],s=e[a++],o=e[a++],r+=ir.charAt(i>>2),r+=ir.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ir.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ir.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,f=0,c=r;f<e.length;)i=sr[e.charCodeAt(f++)-43],s=sr[e.charCodeAt(f++)-43],o=sr[e.charCodeAt(f++)-43],a=sr[e.charCodeAt(f++)-43],n[c++]=i<<2|s>>4,o!==64&&(n[c++]=(s&15)<<4|o>>2,a!==64&&(n[c++]=(o&3)<<6|a));return t?c-r:n.subarray(0,c)};g.binary.base58.encode=function(e,t){return g.binary.baseN.encode(e,q0,t)};g.binary.base58.decode=function(e,t){return g.binary.baseN.decode(e,q0,t)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(e,t,r){e=g.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.text.utf8.decode=function(e){return g.decodeUtf8(String.fromCharCode.apply(null,e))};g.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n};g.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};g.deflate=function(e,t,r){if(t=g.decode64(e.deflate(g.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};g.inflate=function(e,t,r){var n=e.inflate(g.encode64(t)).rval;return n===null?null:g.decode64(n)};var ro=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=g.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},no=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},xp=function(e,t,r,n){var i=no(e,t);i===null&&(i={}),i[r]=n,ro(e,t,i)},mp=function(e,t,r){var n=no(e,t);return n!==null&&(n=r in n?n[r]:null),n},vp=function(e,t,r){var n=no(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),ro(e,t,n)}},wp=function(e,t){ro(e,t,null)},Ni=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(f){o=f}if(s)break}if(!s)throw o;return n};g.setItem=function(e,t,r,n,i){Ni(xp,arguments,i)};g.getItem=function(e,t,r,n){return Ni(mp,arguments,n)};g.removeItem=function(e,t,r,n){Ni(vp,arguments,n)};g.clearItems=function(e,t,r){Ni(wp,arguments,r)};g.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};g.format=function(e){for(var t=/%./g,r,n,i=0,s=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&s.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")};g.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-c).toFixed(s).slice(2):"")};g.formatSize=function(e){return e>=1073741824?e=g.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=g.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=g.formatNumber(e/1024,0)+" KiB":e=g.formatNumber(e,0)+" bytes",e};g.bytesFromIP=function(e){return e.indexOf(".")!==-1?g.bytesFromIPv4(e):e.indexOf(":")!==-1?g.bytesFromIPv6(e):null};g.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=g.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};g.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=g.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=g.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};g.bytesToIP=function(e){return e.length===4?g.bytesToIPv4(e):e.length===16?g.bytesToIPv6(e):null};g.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};g.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=g.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};g.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in g&&!e.update)return t(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,t(null,g.cores);if(typeof Worker>"u")return g.cores=1,t(null,g.cores);if(typeof Blob>"u")return g.cores=2,t(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,f){if(a===0){var c=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),t(null,g.cores)}i(f,function(u,h){o.push(s(f,h)),n(o,a-1,f)})}function i(o,a){for(var f=[],c=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===o){for(var d=0;d<o;++d)f[d].terminate();a(null,c)}}),f.push(h)}for(var u=0;u<o;++u)f[u].postMessage(u)}function s(o,a){for(var f=[],c=0;c<o;++c)for(var u=a[c],h=f[c]=[],l=0;l<o;++l)if(c!==l){var d=a[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var Di=K((hm,G0)=>{var Dn=dt();Dn.pki=Dn.pki||{};var io=G0.exports=Dn.pki.oids=Dn.oids=Dn.oids||{};function I(e,t){io[e]=t,io[t]=e}function lt(e,t){io[e]=t}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");lt("2.5.29.1","authorityKeyIdentifier");lt("2.5.29.2","keyAttributes");lt("2.5.29.3","certificatePolicies");lt("2.5.29.4","keyUsageRestriction");lt("2.5.29.5","policyMapping");lt("2.5.29.6","subtreesConstraint");lt("2.5.29.7","subjectAltName");lt("2.5.29.8","issuerAltName");lt("2.5.29.9","subjectDirectoryAttributes");lt("2.5.29.10","basicConstraints");lt("2.5.29.11","nameConstraints");lt("2.5.29.12","policyConstraints");lt("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");lt("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");lt("2.5.29.20","cRLNumber");lt("2.5.29.21","cRLReason");lt("2.5.29.22","expirationDate");lt("2.5.29.23","instructionCode");lt("2.5.29.24","invalidityDate");lt("2.5.29.25","cRLDistributionPoints");lt("2.5.29.26","issuingDistributionPoint");lt("2.5.29.27","deltaCRLIndicator");lt("2.5.29.28","issuingDistributionPoint");lt("2.5.29.29","certificateIssuer");lt("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");lt("2.5.29.33","policyMappings");lt("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");lt("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");lt("2.5.29.46","freshestCRL");lt("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var kn=K((lm,Y0)=>{var vt=dt();Ut();Di();var U=Y0.exports=vt.asn1=vt.asn1||{};U.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};U.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};U.create=function(e,t,r,n,i){if(vt.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:e,type:t,constructed:r,composed:r||vt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=U.copy(a)),a};U.copy=function(e,t){var r;if(vt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(U.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:U.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};U.equals=function(e,t,r){if(vt.util.isArray(e)){if(!vt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!U.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&U.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};U.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Pn(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var bp=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Pn(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};U.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=vt.util.createBuffer(e));var r=e.length(),n=Pi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Pi(e,t,r,n){var i;Pn(e,t,2);var s=e.getByte();t--;var o=s&192,a=s&31;i=e.length();var f=bp(e,t);if(t-=i-e.length(),f!==void 0&&f>t){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=f,c}f=t}var u,h,l=(s&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Pn(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),u.push(Pi(e,t,r+1,n)),t-=i-e.length()}else for(;f>0;)i=e.length(),u.push(Pi(e,f,r+1,n)),t-=i-e.length(),f-=i-e.length();if(u===void 0&&o===U.Class.UNIVERSAL&&a===U.Type.BITSTRING&&(h=e.bytes(f)),u===void 0&&n.decodeBitStrings&&o===U.Class.UNIVERSAL&&a===U.Type.BITSTRING&&f>1){var d=e.read,p=t,y=0;if(a===U.Type.BITSTRING&&(Pn(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var x={strict:!0,decodeBitStrings:!0},m=Pi(e,t,r+1,x),b=i-e.length();t-=b,a==U.Type.BITSTRING&&b++;var w=m.tagClass;b===f&&(w===U.Class.UNIVERSAL||w===U.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(e.read=d,t=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(a===U.Type.BMPSTRING)for(u="";f>0;f-=2)Pn(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var C=h===void 0?null:{bitStringContents:h};return U.create(o,a,l,u,C)}U.toDer=function(e){var t=vt.util.createBuffer(),r=e.tagClass|e.type,n=vt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=U.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(U.toDer(e.value[s]))}else if(e.type===U.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===U.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(n),t};U.oidToDer=function(e){var t=e.split("."),r=vt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,a=2;a<t.length;++a){n=!0,i=[],s=parseInt(t[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};U.derToOid=function(e){var t;typeof e=="string"&&(e=vt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};U.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var f=e.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),c&&(f=e.charAt(c),f==="+"||f==="-")){var u=parseInt(e.substr(c+1,2),10),h=parseInt(e.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};U.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),f=0,c=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,f),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(s,o,a,f)),t};U.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.integerToDer=function(e){var t=vt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};U.derToInteger=function(e){typeof e=="string"&&(e=vt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};U.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&vt.util.isArray(t.value))for(var s=0,o=0;i&&o<t.value.length;++o)i=t.value[o].optional||!1,e.value[s]&&(i=U.validate(e.value[s],t.value[o],r,n),i?++s:t.value[o].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var W0=/[^\\u0000-\\u00ff]/;U.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case U.Class.UNIVERSAL:n+="Universal:";break;case U.Class.APPLICATION:n+="Application:";break;case U.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case U.Class.PRIVATE:n+="Private:";break}if(e.tagClass===U.Class.UNIVERSAL)switch(n+=e.type,e.type){case U.Type.NONE:n+=" (None)";break;case U.Type.BOOLEAN:n+=" (Boolean)";break;case U.Type.INTEGER:n+=" (Integer)";break;case U.Type.BITSTRING:n+=" (Bit string)";break;case U.Type.OCTETSTRING:n+=" (Octet string)";break;case U.Type.NULL:n+=" (Null)";break;case U.Type.OID:n+=" (Object Identifier)";break;case U.Type.ODESC:n+=" (Object Descriptor)";break;case U.Type.EXTERNAL:n+=" (External or Instance of)";break;case U.Type.REAL:n+=" (Real)";break;case U.Type.ENUMERATED:n+=" (Enumerated)";break;case U.Type.EMBEDDED:n+=" (Embedded PDV)";break;case U.Type.UTF8:n+=" (UTF8)";break;case U.Type.ROID:n+=" (Relative Object Identifier)";break;case U.Type.SEQUENCE:n+=" (Sequence)";break;case U.Type.SET:n+=" (Set)";break;case U.Type.PRINTABLESTRING:n+=" (Printable String)";break;case U.Type.IA5String:n+=" (IA5String (ASCII))";break;case U.Type.UTCTIME:n+=" (UTC time)";break;case U.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case U.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(o+=1,a+=U.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",e.type===U.Type.OID){var f=U.derToOid(e.value);n+=f,vt.pki&&vt.pki.oids&&f in vt.pki.oids&&(n+=" ("+vt.pki.oids[f]+") ")}if(e.type===U.Type.INTEGER)try{n+=U.derToInteger(e.value)}catch{n+="0x"+vt.util.bytesToHex(e.value)}else if(e.type===U.Type.BITSTRING){if(e.value.length>1?n+="0x"+vt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(e.type===U.Type.OCTETSTRING)W0.test(e.value)||(n+="("+e.value+") "),n+="0x"+vt.util.bytesToHex(e.value);else if(e.type===U.Type.UTF8)try{n+=vt.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+vt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===U.Type.PRINTABLESTRING||e.type===U.Type.IA5String?n+=e.value:W0.test(e.value)?n+="0x"+vt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var oo=K((pm,$0)=>{var Pt=dt();Ut();$0.exports=Pt.cipher=Pt.cipher||{};Pt.cipher.algorithms=Pt.cipher.algorithms||{};Pt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Pt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Pt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Pt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Pt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Pt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Pt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Pt.cipher.algorithms[e]=t};Pt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Pt.cipher.algorithms?Pt.cipher.algorithms[e]:null};var so=Pt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};so.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Pt.util.createBuffer(),this.output=e.output||Pt.util.createBuffer(),this.mode.start(t)};so.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};so.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var fo=K((dm,X0)=>{var kt=dt();Ut();kt.cipher=kt.cipher||{};var $=X0.exports=kt.cipher.modes=kt.cipher.modes||{};$.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(e){};$.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=ki(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Ki(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=kt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=kt.util.createBuffer(e.additionalData):r=kt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=kt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ao(n*8)))}this._inBlock=this._j0.slice(0),Ki(this._inBlock),this._partialBytes=0,r=kt.util.createBuffer(r),this._aDataLength=ao(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ki(this._inBlock)};$.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ki(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=kt.util.createBuffer();var n=this._aDataLength.concat(ao(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};$.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};$.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};$.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],f=o/n|0,c=(n-1-o%n)*t;a[f]=1<<t-1<<c,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s};$.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],f=i[o];i[s+o]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var c=i[s^n];i[s]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i};function ki(e,t){if(typeof e=="string"&&(e=kt.util.createBuffer(e)),kt.util.isArray(e)&&e.length>4){var r=e;e=kt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!kt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function Ki(e){e[e.length-1]=e[e.length-1]+1&4294967295}function ao(e){return[e/4294967296|0,e&4294967295]}});var lo=K((ym,j0)=>{var mt=dt();oo();fo();Ut();j0.exports=mt.aes=mt.aes||{};mt.aes.startEncrypting=function(e,t,r,n){var i=Mi({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};mt.aes.createEncryptionCipher=function(e,t){return Mi({key:e,output:null,decrypt:!1,mode:t})};mt.aes.startDecrypting=function(e,t,r,n){var i=Mi({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};mt.aes.createDecryptionCipher=function(e,t){return Mi({key:e,output:null,decrypt:!0,mode:t})};mt.aes.Algorithm=function(e,t){ho||Q0();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return uo(r._w,n,i,!1)},decrypt:function(n,i){return uo(r._w,n,i,!0)}}}),r._init=!1};mt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=mt.util.createBuffer(t);else if(mt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=mt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!mt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!mt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=J0(t,e.decrypt&&!o),this._init=!0}};mt.aes._expandKey=function(e,t){return ho||Q0(),J0(e,t)};mt.aes._updateBlock=uo;Qr("AES-ECB",mt.cipher.modes.ecb);Qr("AES-CBC",mt.cipher.modes.cbc);Qr("AES-CFB",mt.cipher.modes.cfb);Qr("AES-OFB",mt.cipher.modes.ofb);Qr("AES-CTR",mt.cipher.modes.ctr);Qr("AES-GCM",mt.cipher.modes.gcm);function Qr(e,t){var r=function(){return new mt.aes.Algorithm(e,t)};mt.cipher.registerAlgorithm(e,r)}var ho=!1,Zr=4,ee,co,Z0,Br,be;function Q0(){ho=!0,Z0=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;ee=new Array(256),co=new Array(256),Br=new Array(4),be=new Array(4);for(var t=0;t<4;++t)Br[t]=new Array(256),be[t]=new Array(256);for(var r=0,n=0,i,s,o,a,f,c,u,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,ee[r]=a,co[a]=r,f=e[a],i=e[r],s=e[i],o=e[s],c=f<<24^a<<16^a<<8^(a^f),u=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)Br[h][r]=c,be[h][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^o]]],n^=e[e[n]])}}function J0(e,t){for(var r=e.slice(0),n,i=1,s=r.length,o=s+6+1,a=Zr*o,f=s;f<a;++f)n=r[f-1],f%s===0?(n=ee[n>>>16&255]<<24^ee[n>>>8&255]<<16^ee[n&255]<<8^ee[n>>>24]^Z0[i]<<24,i++):s>6&&f%s===4&&(n=ee[n>>>24]<<24^ee[n>>>16&255]<<16^ee[n>>>8&255]<<8^ee[n&255]),r[f]=r[f-s]^n;if(t){var c,u=be[0],h=be[1],l=be[2],d=be[3],p=r.slice(0);a=r.length;for(var f=0,y=a-Zr;f<a;f+=Zr,y-=Zr)if(f===0||f===a-Zr)p[f]=r[y],p[f+1]=r[y+3],p[f+2]=r[y+2],p[f+3]=r[y+1];else for(var x=0;x<Zr;++x)c=r[y+x],p[f+(3&-x)]=u[ee[c>>>24]]^h[ee[c>>>16&255]]^l[ee[c>>>8&255]]^d[ee[c&255]];r=p}return r}function uo(e,t,r,n){var i=e.length/4-1,s,o,a,f,c;n?(s=be[0],o=be[1],a=be[2],f=be[3],c=co):(s=Br[0],o=Br[1],a=Br[2],f=Br[3],c=ee);var u,h,l,d,p,y,x;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var m=3,b=1;b<i;++b)p=s[u>>>24]^o[h>>>16&255]^a[l>>>8&255]^f[d&255]^e[++m],y=s[h>>>24]^o[l>>>16&255]^a[d>>>8&255]^f[u&255]^e[++m],x=s[l>>>24]^o[d>>>16&255]^a[u>>>8&255]^f[h&255]^e[++m],d=s[d>>>24]^o[u>>>16&255]^a[h>>>8&255]^f[l&255]^e[++m],u=p,h=y,l=x;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^e[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^e[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^e[++m],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^e[++m]}function Mi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=mt.cipher.createDecipher(r,e.key):n=mt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof mt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var rf=K((gm,ef)=>{var St=dt();oo();fo();Ut();ef.exports=St.des=St.des||{};St.des.startEncrypting=function(e,t,r,n){var i=Fi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};St.des.createEncryptionCipher=function(e,t){return Fi({key:e,output:null,decrypt:!1,mode:t})};St.des.startDecrypting=function(e,t,r,n){var i=Fi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};St.des.createDecryptionCipher=function(e,t){return Fi({key:e,output:null,decrypt:!0,mode:t})};St.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return tf(r._keys,n,i,!1)},decrypt:function(n,i){return tf(r._keys,n,i,!0)}}}),r._init=!1};St.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=St.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Lp(t),this._init=!0}};Ie("DES-ECB",St.cipher.modes.ecb);Ie("DES-CBC",St.cipher.modes.cbc);Ie("DES-CFB",St.cipher.modes.cfb);Ie("DES-OFB",St.cipher.modes.ofb);Ie("DES-CTR",St.cipher.modes.ctr);Ie("3DES-ECB",St.cipher.modes.ecb);Ie("3DES-CBC",St.cipher.modes.cbc);Ie("3DES-CFB",St.cipher.modes.cfb);Ie("3DES-OFB",St.cipher.modes.ofb);Ie("3DES-CTR",St.cipher.modes.ctr);function Ie(e,t){var r=function(){return new St.des.Algorithm(e,t)};St.cipher.registerAlgorithm(e,r)}var Ep=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Sp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Bp=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Ap=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Cp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],_p=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Tp=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Ip=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Lp(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,x=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,w,C=0;C<y;C++){var B=e.getInt32(),A=e.getInt32();w=(B>>>4^A)&252645135,A^=w,B^=w<<4,w=(A>>>-16^B)&65535,B^=w,A^=w<<-16,w=(B>>>2^A)&858993459,A^=w,B^=w<<2,w=(A>>>-16^B)&65535,B^=w,A^=w<<-16,w=(B>>>1^A)&1431655765,A^=w,B^=w<<1,w=(A>>>8^B)&16711935,B^=w,A^=w<<8,w=(B>>>1^A)&1431655765,A^=w,B^=w<<1,w=B<<8|A>>>20&240,B=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=w;for(var L=0;L<m.length;++L){m[L]?(B=B<<2|B>>>26,A=A<<2|A>>>26):(B=B<<1|B>>>27,A=A<<1|A>>>27),B&=-15,A&=-15;var R=t[B>>>28]|r[B>>>24&15]|n[B>>>20&15]|i[B>>>16&15]|s[B>>>12&15]|o[B>>>8&15]|a[B>>>4&15],P=f[A>>>28]|c[A>>>24&15]|u[A>>>20&15]|h[A>>>16&15]|l[A>>>12&15]|d[A>>>8&15]|p[A>>>4&15];w=(P>>>16^R)&65535,x[b++]=R^w,x[b++]=P^w<<16}}return x}function tf(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],f=t[1];o=(a>>>4^f)&252645135,f^=o,a^=o<<4,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=s[c+1],h=s[c+2],l=s[c];l!=u;l+=h){var d=f^e[l],p=(f>>>4|f<<28)^e[l+1];o=a,a=f,f=o^(Sp[d>>>24&63]|Ap[d>>>16&63]|_p[d>>>8&63]|Ip[d&63]|Ep[p>>>24&63]|Bp[p>>>16&63]|Cp[p>>>8&63]|Tp[p&63])}o=a,a=f,f=o}a=a>>>1|a<<31,f=f>>>1|f<<31,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(a>>>4^f)&252645135,f^=o,a^=o<<4,r[0]=a,r[1]=f}function Fi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=St.cipher.createDecipher(r,e.key):n=St.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof St.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Ar=K((xm,nf)=>{var Oi=dt();nf.exports=Oi.md=Oi.md||{};Oi.md.algorithms=Oi.md.algorithms||{}});var of=K((mm,sf)=>{var Ye=dt();Ar();Ut();var Rp=sf.exports=Ye.hmac=Ye.hmac||{};Rp.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ye.md.algorithms)t=Ye.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(o===null)o=e;else{if(typeof o=="string")o=Ye.util.createBuffer(o);else if(Ye.util.isArray(o)){var a=o;o=Ye.util.createBuffer();for(var f=0;f<a.length;++f)o.putByte(a[f])}var c=o.length();c>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=Ye.util.createBuffer(),n=Ye.util.createBuffer(),c=o.length();for(var f=0;f<c;++f){var a=o.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<t.blockLength)for(var a=t.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var ff=K((vm,af)=>{var re=dt();of();Ar();Ut();var Up=re.pkcs5=re.pkcs5||{},$e;re.util.isNodejs&&!re.options.usePureJavaScript&&($e=Sr());af.exports=re.pbkdf2=Up.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),re.util.isNodejs&&!re.options.usePureJavaScript&&$e.pbkdf2&&(i===null||typeof i!="object")&&($e.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?$e.pbkdf2Sync.length===4?$e.pbkdf2(e,t,r,n,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):$e.pbkdf2(e,t,r,n,i,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):$e.pbkdf2Sync.length===4?$e.pbkdf2Sync(e,t,r,n).toString("binary"):$e.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in re.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=re.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var f=Math.ceil(n/o),c=n-(f-1)*o,u=re.hmac.create();u.start(i,e);var h="",l,d,p;if(!s){for(var y=1;y<=f;++y){u.start(null,null),u.update(t),u.update(re.util.int32ToBytes(y)),l=p=u.digest().getBytes();for(var x=2;x<=r;++x)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=re.util.xorBytes(l,d,o),p=d;h+=y<f?l:l.substr(0,c)}return h}var y=1,x;function m(){if(y>f)return s(null,h);u.start(null,null),u.update(t),u.update(re.util.int32ToBytes(y)),l=p=u.digest().getBytes(),x=2,b()}function b(){if(x<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=re.util.xorBytes(l,d,o),p=d,++x,re.util.setImmediate(b);h+=y<f?l:l.substr(0,c),++y,m()}m()}});var hf=K((wm,uf)=>{var Vi=dt();Ut();var cf=uf.exports=Vi.pem=Vi.pem||{};cf.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Hi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Hi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Hi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Hi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Vi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};cf.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Vi.util.decode64(s[3])};if(t.push(a),!!s[2]){for(var f=s[2].split(i),c=0;s&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)d.values.push(Np(p[y]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Hi(e){for(var t=e.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),s=i-o-1,o=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(o=i);return t}function Np(e){return e.replace(/^\s+/,"")}});var xf=K((bm,gf)=>{var Le=dt();Ar();Ut();var pf=gf.exports=Le.sha256=Le.sha256||{};Le.md.sha256=Le.md.algorithms.sha256=pf;pf.create=function(){df||Dp();var e=null,t=Le.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Le.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Le.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),lf(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Le.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(po.substr(0,n.blockLength-o));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};lf(h,r,i);var l=Le.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var po=null,df=!1,yf=null;function Dp(){po=String.fromCharCode(128),po+=Le.util.fillString(String.fromCharCode(0),64),yf=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],df=!0}function lf(e,t,r){for(var n,i,s,o,a,f,c,u,h,l,d,p,y,x,m,b=r.length();b>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=t[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,y=e.h5,x=e.h6,m=e.h7,c=0;c<64;++c)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=x^p&(y^x),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+o+a+yf[c]+t[c],i=s+f,m=x,x=y,y=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+x|0,e.h7=e.h7+m|0,b-=64}}});var vf=K((Em,mf)=>{var Re=dt();Ut();var qi=null;Re.util.isNodejs&&!Re.options.usePureJavaScript&&!process.versions["node-webkit"]&&(qi=Sr());var Pp=mf.exports=Re.prng=Re.prng||{};Pp.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(c,u){if(!u)return t.generateSync(c);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,y=Re.util.createBuffer();t.key=null,x();function x(m){if(m)return u(m);if(y.length()>=c)return u(null,y.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return Re.util.nextTick(function(){s(x)});var b=h(t.key,t.seed);t.generated+=b.length,y.putBytes(b),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),Re.util.setImmediate(x)}},t.generateSync=function(c){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=Re.util.createBuffer();p.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&o();var y=u(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=l(u(t.key,h(t.seed))),t.seed=d(u(t.key,t.seed))}return p.getBytes(c)};function s(c){if(t.pools[0].messageLength>=32)return a(),c();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return c(h);t.collect(l),a(),c()})}function o(){if(t.pools[0].messageLength>=32)return a();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(c.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var l=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(c){var u=null,h=Re.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(B){return l.getRandomValues(B)});var d=Re.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{u(y);for(var x=0;x<y.length;++x)d.putInt32(y[x])}catch(B){if(!(typeof QuotaExceededError<"u"&&B instanceof QuotaExceededError))throw B}}if(d.length()<c)for(var m,b,w,C=Math.floor(Math.random()*65536);d.length()<c;){b=16807*(C&65535),m=16807*(C>>16),b+=(m&32767)<<16,b+=m>>15,b=(b&2147483647)+(b>>31),C=b&4294967295;for(var x=0;x<3;++x)w=C>>>(x<<3),w^=Math.floor(Math.random()*256),d.putByte(w&255)}return d.getBytes(c)}return qi?(t.seedFile=function(c,u){qi.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(c){return qi.randomBytes(c).toString()}):(t.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},t.seedFileSync=f),t.collect=function(c){for(var u=c.length,h=0;h<u;++h)t.pools[t.pool].update(c.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);t.collect(h)},t.registerWorker=function(c){if(c===self)t.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},t}});var Kn=K((Sm,yo)=>{var Kt=dt();lo();xf();vf();Ut();(function(){if(Kt.random&&Kt.random.getBytes){yo.exports=Kt.random;return}(function(e){var t={},r=new Array(4),n=Kt.util.createBuffer();t.formatKey=function(h){var l=Kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Kt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Kt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Kt.md.sha256;function i(){var h=Kt.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=Kt.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Kt.options.usePureJavaScript||!Kt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}s.collect(c),c=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Kt.random)Kt.random=s;else for(var u in s)Kt.random[u]=s[u];Kt.random.createInstance=i,yo.exports=Kt.random})(typeof jQuery<"u"?jQuery:null)})()});var Sf=K((Bm,Ef)=>{var ie=dt();Ut();var go=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],wf=[1,2,3,5],kp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Kp=function(e,t){return(e&65535)>>t|e<<16-t&65535};Ef.exports=ie.rc2=ie.rc2||{};ie.rc2.expandKey=function(e,t){typeof e=="string"&&(e=ie.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(go[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,go[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,go[r.at(a+1)^r.at(a+s)]);return r};var bf=function(e,t,r){var n=!1,i=null,s=null,o=null,a,f,c,u,h=[];for(e=ie.rc2.expandKey(e,t),c=0;c<64;c++)h.push(e.getInt16Le());r?(a=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=kp(p[c],wf[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(a=function(p){for(c=3;c>=0;c--)p[c]=Kp(p[c],wf[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var y=[];for(c=0;c<4;c++){var x=i.getInt16Le();o!==null&&(r?x^=o.getInt16Le():o.putInt16Le(x)),y.push(x&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var b=0;b<p[m][0];b++)p[m][1](y);for(c=0;c<4;c++)o!==null&&(r?o.putInt16Le(y[c]):y[c]^=o.getInt16Le()),s.putInt16Le(y[c])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=ie.util.createBuffer(p)),n=!1,i=ie.util.createBuffer(),s=y||new ie.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var m=s.length(),b=s.at(m-1);b>m?y=!1:s.truncate(b)}return y}},d};ie.rc2.startEncrypting=function(e,t,r){var n=ie.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};ie.rc2.createEncryptionCipher=function(e,t){return bf(e,t,!0)};ie.rc2.startDecrypting=function(e,t,r){var n=ie.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};ie.rc2.createDecryptionCipher=function(e,t){return bf(e,t,!1)}});var Wi=K((Am,Rf)=>{var xo=dt();Rf.exports=xo.jsbn=xo.jsbn||{};var Xe,Mp=0xdeadbeefcafe,Bf=(Mp&16777215)==15715070;function _(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}xo.jsbn.BigInteger=_;function nt(){return new _(null)}function Fp(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function Op(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var f=this.data[e]&32767,c=this.data[e++]>>15,u=a*f+c*o;f=o*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function Af(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var f=this.data[e]&16383,c=this.data[e++]>>14,u=a*f+c*o;f=o*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(_.prototype.am=Af,Xe=28):Bf&&navigator.appName=="Microsoft Internet Explorer"?(_.prototype.am=Op,Xe=30):Bf&&navigator.appName!="Netscape"?(_.prototype.am=Fp,Xe=26):(_.prototype.am=Af,Xe=28);_.prototype.DB=Xe;_.prototype.DM=(1<<Xe)-1;_.prototype.DV=1<<Xe;var mo=52;_.prototype.FV=Math.pow(2,mo);_.prototype.F1=mo-Xe;_.prototype.F2=2*Xe-mo;var Hp="0123456789abcdefghijklmnopqrstuvwxyz",zi=new Array,Jr,de;Jr="0".charCodeAt(0);for(de=0;de<=9;++de)zi[Jr++]=de;Jr="a".charCodeAt(0);for(de=10;de<36;++de)zi[Jr++]=de;Jr="A".charCodeAt(0);for(de=10;de<36;++de)zi[Jr++]=de;function Cf(e){return Hp.charAt(e)}function _f(e,t){var r=zi[e.charCodeAt(t)];return r??-1}function Vp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function qp(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function or(e){var t=nt();return t.fromInt(e),t}function zp(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:_f(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&_.ZERO.subTo(this,this)}function Gp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Wp(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Cf(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Cf(n));return i?s:"0"}function Yp(){var e=nt();return _.ZERO.subTo(this,e),e}function $p(){return this.s<0?this.negate():this}function Xp(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Gi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Zp(){return this.t<=0?0:this.DB*(this.t-1)+Gi(this.data[this.t-1]^this.s&this.DM)}function Qp(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function Jp(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function jp(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)t.data[a]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function td(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function ed(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function rd(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&_.ZERO.subTo(t,t)}function nd(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function id(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=nt());var s=nt(),o=this.s,a=e.s,f=this.DB-Gi(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,u=s.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,x=y-c,m=t??nt();for(s.dlShiftTo(x,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),_.ONE.dlShiftTo(c,m),m.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--x>=0;){var b=r.data[--y]==u?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,b,r,x,0,c))<b)for(s.dlShiftTo(x,m),r.subTo(m,r);r.data[y]<--b;)r.subTo(m,r)}t!=null&&(r.drShiftTo(c,t),o!=a&&_.ZERO.subTo(t,t)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&_.ZERO.subTo(r,r)}}}function sd(e){var t=nt();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(_.ZERO)>0&&e.subTo(t,t),t}function Cr(e){this.m=e}function od(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ad(e){return e}function fd(e){e.divRemTo(this.m,null,e)}function cd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function ud(e,t){e.squareTo(t),this.reduce(t)}Cr.prototype.convert=od;Cr.prototype.revert=ad;Cr.prototype.reduce=fd;Cr.prototype.mulTo=cd;Cr.prototype.sqrTo=ud;function hd(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function _r(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function ld(e){var t=nt();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(_.ZERO)>0&&this.m.subTo(t,t),t}function pd(e){var t=nt();return e.copyTo(t),this.reduce(t),t}function dd(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function yd(e,t){e.squareTo(t),this.reduce(t)}function gd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}_r.prototype.convert=ld;_r.prototype.revert=pd;_r.prototype.reduce=dd;_r.prototype.mulTo=gd;_r.prototype.sqrTo=yd;function xd(){return(this.t>0?this.data[0]&1:this.s)==0}function md(e,t){if(e>4294967295||e<1)return _.ONE;var r=nt(),n=nt(),i=t.convert(this),s=Gi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function vd(e,t){var r;return e<256||t.isEven()?r=new Cr(t):r=new _r(t),this.exp(e,r)}_.prototype.copyTo=Vp;_.prototype.fromInt=qp;_.prototype.fromString=zp;_.prototype.clamp=Gp;_.prototype.dlShiftTo=Qp;_.prototype.drShiftTo=Jp;_.prototype.lShiftTo=jp;_.prototype.rShiftTo=td;_.prototype.subTo=ed;_.prototype.multiplyTo=rd;_.prototype.squareTo=nd;_.prototype.divRemTo=id;_.prototype.invDigit=hd;_.prototype.isEven=xd;_.prototype.exp=md;_.prototype.toString=Wp;_.prototype.negate=Yp;_.prototype.abs=$p;_.prototype.compareTo=Xp;_.prototype.bitLength=Zp;_.prototype.mod=sd;_.prototype.modPowInt=vd;_.ZERO=or(0);_.ONE=or(1);function wd(){var e=nt();return this.copyTo(e),e}function bd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Ed(){return this.t==0?this.s:this.data[0]<<24>>24}function Sd(){return this.t==0?this.s:this.data[0]<<16>>16}function Bd(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Ad(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Cd(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=or(r),i=nt(),s=nt(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function _d(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var f=_f(e,a);if(f<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&_.ZERO.subTo(this,this)}function Td(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(_.ONE.shiftLeft(e-1),vo,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(_.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Id(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Ld(e){return this.compareTo(e)==0}function Rd(e){return this.compareTo(e)<0?this:e}function Ud(e){return this.compareTo(e)>0?this:e}function Nd(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Dd(e,t){return e&t}function Pd(e){var t=nt();return this.bitwiseTo(e,Dd,t),t}function vo(e,t){return e|t}function kd(e){var t=nt();return this.bitwiseTo(e,vo,t),t}function Tf(e,t){return e^t}function Kd(e){var t=nt();return this.bitwiseTo(e,Tf,t),t}function If(e,t){return e&~t}function Md(e){var t=nt();return this.bitwiseTo(e,If,t),t}function Fd(){for(var e=nt(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Od(e){var t=nt();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Hd(e){var t=nt();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Vd(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function qd(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Vd(this.data[e]);return this.s<0?this.t*this.DB:-1}function zd(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Gd(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=zd(this.data[r]^t);return e}function Wd(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Yd(e,t){var r=_.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function $d(e){return this.changeBit(e,vo)}function Xd(e){return this.changeBit(e,If)}function Zd(e){return this.changeBit(e,Tf)}function Qd(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Jd(e){var t=nt();return this.addTo(e,t),t}function jd(e){var t=nt();return this.subTo(e,t),t}function ty(e){var t=nt();return this.multiplyTo(e,t),t}function ey(e){var t=nt();return this.divRemTo(e,t,null),t}function ry(e){var t=nt();return this.divRemTo(e,null,t),t}function ny(e){var t=nt(),r=nt();return this.divRemTo(e,t,r),new Array(t,r)}function iy(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function sy(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Mn(){}function Lf(e){return e}function oy(e,t,r){e.multiplyTo(t,r)}function ay(e,t){e.squareTo(t)}Mn.prototype.convert=Lf;Mn.prototype.revert=Lf;Mn.prototype.mulTo=oy;Mn.prototype.sqrTo=ay;function fy(e){return this.exp(e,new Mn)}function cy(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function uy(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function jr(e){this.r2=nt(),this.q3=nt(),_.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function hy(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=nt();return e.copyTo(t),this.reduce(t),t}function ly(e){return e}function py(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function dy(e,t){e.squareTo(t),this.reduce(t)}function yy(e,t,r){e.multiplyTo(t,r),this.reduce(r)}jr.prototype.convert=hy;jr.prototype.revert=ly;jr.prototype.reduce=py;jr.prototype.mulTo=yy;jr.prototype.sqrTo=dy;function gy(e,t){var r=e.bitLength(),n,i=or(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Cr(t):t.isEven()?s=new jr(t):s=new _r(t);var o=new Array,a=3,f=n-1,c=(1<<n)-1;if(o[1]=s.convert(this),n>1){var u=nt();for(s.sqrTo(o[1],u);a<=c;)o[a]=nt(),s.mulTo(u,o[a-2],o[a]),a+=2}var h=e.t-1,l,d=!0,p=nt(),y;for(r=Gi(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&c:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function xy(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function my(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function vy(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return _.ZERO;for(var r=e.clone(),n=this.clone(),i=or(1),s=or(0),o=or(0),a=or(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(_.ONE)!=0)return _.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var Ee=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],wy=(1<<26)/Ee[Ee.length-1];function by(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=Ee[Ee.length-1]){for(t=0;t<Ee.length;++t)if(r.data[0]==Ee[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Ee.length;){for(var n=Ee[t],i=t+1;i<Ee.length&&n<wy;)n*=Ee[i++];for(n=r.modInt(n);t<i;)if(n%Ee[t++]==0)return!1}return r.millerRabin(e)}function Ey(e){var t=this.subtract(_.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Sy(),s,o=0;o<e;++o){do s=new _(this.bitLength(),i);while(s.compareTo(_.ONE)<=0||s.compareTo(t)>=0);var a=s.modPow(n,this);if(a.compareTo(_.ONE)!=0&&a.compareTo(t)!=0){for(var f=1;f++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(_.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function Sy(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}_.prototype.chunkSize=Bd;_.prototype.toRadix=Cd;_.prototype.fromRadix=_d;_.prototype.fromNumber=Td;_.prototype.bitwiseTo=Nd;_.prototype.changeBit=Yd;_.prototype.addTo=Qd;_.prototype.dMultiply=iy;_.prototype.dAddOffset=sy;_.prototype.multiplyLowerTo=cy;_.prototype.multiplyUpperTo=uy;_.prototype.modInt=my;_.prototype.millerRabin=Ey;_.prototype.clone=wd;_.prototype.intValue=bd;_.prototype.byteValue=Ed;_.prototype.shortValue=Sd;_.prototype.signum=Ad;_.prototype.toByteArray=Id;_.prototype.equals=Ld;_.prototype.min=Rd;_.prototype.max=Ud;_.prototype.and=Pd;_.prototype.or=kd;_.prototype.xor=Kd;_.prototype.andNot=Md;_.prototype.not=Fd;_.prototype.shiftLeft=Od;_.prototype.shiftRight=Hd;_.prototype.getLowestSetBit=qd;_.prototype.bitCount=Gd;_.prototype.testBit=Wd;_.prototype.setBit=$d;_.prototype.clearBit=Xd;_.prototype.flipBit=Zd;_.prototype.add=Jd;_.prototype.subtract=jd;_.prototype.multiply=ty;_.prototype.divide=ey;_.prototype.remainder=ry;_.prototype.divideAndRemainder=ny;_.prototype.modPow=gy;_.prototype.modInverse=vy;_.prototype.pow=fy;_.prototype.gcd=xy;_.prototype.isProbablePrime=by});var kf=K((Cm,Pf)=>{var Ue=dt();Ar();Ut();var Nf=Pf.exports=Ue.sha1=Ue.sha1||{};Ue.md.sha1=Ue.md.algorithms.sha1=Nf;Nf.create=function(){Df||By();var e=null,t=Ue.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Ue.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Ue.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),Uf(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Ue.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(wo.substr(0,n.blockLength-o));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};Uf(h,r,i);var l=Ue.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var wo=null,Df=!1;function By(){wo=String.fromCharCode(128),wo+=Ue.util.fillString(String.fromCharCode(0),64),Df=!0}function Uf(e,t,r){for(var n,i,s,o,a,f,c,u,h=r.length();h>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,f=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,c=a^s&(o^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=a^s&(o^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=s^o^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^o^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s&o|a&(s^o),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^o^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+f|0,h-=64}}});var Ff=K((_m,Mf)=>{var Ne=dt();Ut();Kn();kf();var Kf=Mf.exports=Ne.pkcs1=Ne.pkcs1||{};Kf.encode_rsa_oaep=function(e,t,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Ne.md.sha1.create(),o||(o=s);var a=Math.ceil(e.n.bitLength()/8),f=a-2*s.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=f,c}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=f-t.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=Ne.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=s.digestLength,c}var y=Yi(i,a-s.digestLength-1,o),x=Ne.util.xorBytes(p,y,p.length),m=Yi(x,s.digestLength,o),b=Ne.util.xorBytes(i,m,i.length);return"\0"+b+x};Kf.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=t.length,x.expectedLength=o,x}if(i===void 0?i=Ne.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=t.charAt(0),c=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=Yi(u,i.digestLength,s),l=Ne.util.xorBytes(c,h,c.length),d=Yi(l,o-i.digestLength-1,s),p=Ne.util.xorBytes(u,d,u.length),y=p.substring(0,i.digestLength),x=f!=="\0",m=0;m<i.digestLength;++m)x|=a.charAt(m)!==y.charAt(m);for(var b=1,w=i.digestLength,C=i.digestLength;C<p.length;C++){var B=p.charCodeAt(C),A=B&1^1,L=b?65534:0;x|=B&L,b=b&A,w+=b}if(x||p.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(w+1)};function Yi(e,t,r){r||(r=Ne.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}});var Of=K((Tm,bo)=>{var ar=dt();Ut();Wi();Kn();(function(){if(ar.prime){bo.exports=ar.prime;return}var e=bo.exports=ar.prime=ar.prime||{},t=ar.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||ar.random,x={nextBytes:function(m){for(var b=y.getBytesSync(m.length),w=0;w<m.length;++w)m[w]=b.charCodeAt(w)}};if(p.name==="PRIMEINC")return s(h,x,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var y=c(h,l),x=0,m=u(y.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var b=10;"maxBlockTime"in d&&(b=d.maxBlockTime),a(y,h,l,x,m,b,p)}function a(h,l,d,p,y,x,m){var b=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[p++%8],0)}while(x<0||+new Date-b<x);ar.util.setImmediate(function(){a(h,l,d,p,y,x,m)})}function f(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var y=c(h,l),x=d.workers,m=d.workLoad||100,b=m*30/8,w=d.workerScript||"forge/prime.worker.js";if(x===-1)return ar.util.estimateCores(function(B,A){B&&(A=2),x=A-1,C()});C();function C(){x=Math.max(1,x);for(var B=[],A=0;A<x;++A)B[A]=new Worker(w);for(var L=x,A=0;A<x;++A)B[A].addEventListener("message",P);var R=!1;function P(O){if(!R){--L;var G=O.data;if(G.found){for(var z=0;z<B.length;++z)B[z].terminate();return R=!0,p(null,new t(G.prime,16))}y.bitLength()>h&&(y=c(h,l));var rt=y.toString(16);O.target.postMessage({hex:rt,workLoad:m}),y.dAddOffset(b,0)}}}}function c(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Xi=K((Im,Yf)=>{var M=dt();kn();Wi();Di();Ff();Of();Kn();Ut();typeof j>"u"&&(j=M.jsbn.BigInteger);var j,Eo=M.util.isNodejs?Sr():null,v=M.asn1,ye=M.util;M.pki=M.pki||{};Yf.exports=M.pki.rsa=M.rsa=M.rsa||{};var q=M.pki,Ay=[6,4,2,4,2,4,6,2],Cy={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},_y={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ty={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Iy=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ly={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Ry=function(e){var t;if(e.algorithm in q.oids)t=q.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=v.oidToDer(t).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),s=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);s.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),s.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var o=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),v.toDer(i).getBytes()},Gf=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(j.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(j.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new j(M.util.bytesToHex(M.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(j.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var o=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o};q.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Wf(e,t,r)):(i=M.util.createBuffer(),i.putBytes(e));for(var o=new j(i.toHex(),16),a=Gf(o,t,n),f=a.toString(16),c=M.util.createBuffer(),u=s-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),c.getBytes()};q.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var o=new j(M.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Gf(o,t,r),f=a.toString(16),c=M.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),n!==!1?$i(c.getBytes(),t,r):c.getBytes()};q.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new j(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};q.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,c=f-1;e.pqState===0?(e.num=new j(f,e.rng),e.num.testBit(c)||e.num.bitwiseTo(j.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Ny(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Ay[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(j.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-s,s=o}return e.keys!==null};q.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(Hf("generateKeyPair"))return Eo.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:q.privateKeyFromPem(c),publicKey:q.publicKeyFromPem(f)})});if(Vf("generateKey")&&Vf("exportKey"))return ye.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:zf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ye.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=q.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(a)));n(null,{privateKey:f,publicKey:q.setRsaPublicKey(f.n,f.e)})}});if(qf("generateKey")&&qf("exportKey")){var i=ye.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:zf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=ye.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=q.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(h)));n(null,{privateKey:l,publicKey:q.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(Hf("generateKeyPairSync")){var s=Eo.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:q.privateKeyFromPem(s.privateKey),publicKey:q.publicKeyFromPem(s.publicKey)}}}var o=q.rsa.createKeyPairGenerationState(e,t,r);if(!n)return q.rsa.stepKeyPairGenerationState(o,0),o.keys;Uy(o,r,n)};q.setRsaPublicKey=q.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return Wf(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return M.pkcs1.encode_rsa_oaep(f,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return q.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,c){c=$i(c,r,!0);var u=v.fromDer(c,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,Ly,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=v.derToOid(h.algorithmIdentifier);if(!(p===M.oids.md2||p===M.oids.md5||p===M.oids.sha1||p===M.oids.sha224||p===M.oids.sha256||p===M.oids.sha384||p===M.oids.sha512||p===M.oids["sha512-224"]||p===M.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===M.oids.md2||p===M.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,c){return c=$i(c,r,!0),f===c}});var a=q.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};q.setRsaPrivateKey=q.rsa.setPrivateKey=function(e,t,r,n,i,s,o,a){var f={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=q.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:$i};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return M.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Ry},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return q.rsa.encrypt(l,f,h)},f};q.wrapRsaPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(e).getBytes())])};q.privateKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,Cy,t,r)&&(e=v.fromDer(M.util.createBuffer(t.privateKey))),t={},r=[],!v.validate(e,_y,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,f,c,u,h;return i=M.util.createBuffer(t.privateKeyModulus).toHex(),s=M.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=M.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=M.util.createBuffer(t.privateKeyPrime1).toHex(),f=M.util.createBuffer(t.privateKeyPrime2).toHex(),c=M.util.createBuffer(t.privateKeyExponent1).toHex(),u=M.util.createBuffer(t.privateKeyExponent2).toHex(),h=M.util.createBuffer(t.privateKeyCoefficient).toHex(),q.setRsaPrivateKey(new j(i,16),new j(s,16),new j(o,16),new j(a,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};q.privateKeyToAsn1=q.privateKeyToRSAPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.qInv))])};q.publicKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,Iy,t,r)){var n=v.derToOid(t.publicKeyOid);if(n!==q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!v.validate(e,Ty,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=M.util.createBuffer(t.publicKeyModulus).toHex(),o=M.util.createBuffer(t.publicKeyExponent).toHex();return q.setRsaPublicKey(new j(s,16),new j(o,16))};q.publicKeyToAsn1=q.publicKeyToSubjectPublicKeyInfo=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[q.publicKeyToRSAPublicKey(e)])])};q.publicKeyToRSAPublicKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.e))])};function Wf(e,t,r){var n=M.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<o;++f)n.putByte(a)}else for(;o>0;){for(var c=0,u=M.random.getBytes(o),f=0;f<o;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);o=c}return n.putByte(0),n.putBytes(e),n}function $i(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=M.util.createBuffer(e),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(a===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var u=s.getByte();if(u!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Uy(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(a,f){if(a)return r(a);if(e.p=f,e.q!==null)return o(a,e.q);s(e.qBits,o)})}function s(a,f){M.prime.generateProbablePrime(a,n,f)}function o(a,f){if(a)return r(a);if(e.q=f,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.p=null,i();return}if(e.q.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.q=null,s(e.qBits,o);return}if(e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(j.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,o);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function De(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=M.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Ny(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Hf(e){return M.util.isNodejs&&typeof Eo[e]=="function"}function Vf(e){return typeof ye.globalScope<"u"&&typeof ye.globalScope.crypto=="object"&&typeof ye.globalScope.crypto.subtle=="object"&&typeof ye.globalScope.crypto.subtle[e]=="function"}function qf(e){return typeof ye.globalScope<"u"&&typeof ye.globalScope.msCrypto=="object"&&typeof ye.globalScope.msCrypto.subtle=="object"&&typeof ye.globalScope.msCrypto.subtle[e]=="function"}function zf(e){for(var t=M.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var jf=K((Lm,Jf)=>{var N=dt();lo();kn();rf();Ar();Di();ff();hf();Kn();Sf();Xi();Ut();typeof $f>"u"&&($f=N.jsbn.BigInteger);var $f,E=N.asn1,W=N.pki=N.pki||{};Jf.exports=W.pbe=N.pbe=N.pbe||{};var Tr=W.oids,Dy={name:"EncryptedPrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Py={name:"PBES2Algorithms",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},ky={name:"pkcs-12PbeParams",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=N.random.getBytesSync(r.saltSize),i=r.count,s=E.integerToDer(i),o,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":o=16,c=16,u=Tr["aes128-CBC"],h=N.aes.createEncryptionCipher;break;case"aes192":o=24,c=16,u=Tr["aes192-CBC"],h=N.aes.createEncryptionCipher;break;case"aes256":o=32,c=16,u=Tr["aes256-CBC"],h=N.aes.createEncryptionCipher;break;case"des":o=8,c=8,u=Tr.desCBC,h=N.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Qf(d),y=N.pkcs5.pbkdf2(t,n,i,o,p),x=N.random.getBytesSync(c),m=h(y);m.start(x),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes();var b=Ky(n,s,o,d);a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Tr.pkcs5PBES2).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Tr.pkcs5PBKDF2).getBytes()),b]),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(u).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){o=24;var w=new N.util.ByteBuffer(n),y=W.pbe.generatePkcs12Key(t,w,1,i,o),x=W.pbe.generatePkcs12Key(t,w,2,i,o),m=N.des.createEncryptionCipher(y);m.start(x),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes(),a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Tr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,n),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[a,E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,f)]);return C};W.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!E.validate(e,Dy,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=E.derToOid(n.encryptionOid),a=W.pbe.getCipher(o,n.encryptionParams,t),f=N.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=E.fromDer(a.output)),r};W.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:E.toDer(e).getBytes()};return N.pem.encode(r,{maxline:t})};W.encryptedPrivateKeyFromPem=function(e){var t=N.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return E.fromDer(t.body)};W.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(e));return n=W.encryptPrivateKeyInfo(n,t,r),W.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=N.random.getBytesSync(8),a=N.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=N.random.getBytesSync(8),a=N.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=N.pbe.opensslDeriveBytes(t,s.substr(0,8),o),u=a(c);u.start(s),u.update(E.toDer(W.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:N.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return N.pem.encode(h)};W.decryptRsaPrivateKey=function(e,t){var r=null,n=N.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=N.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=N.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=N.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=N.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=N.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return N.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return N.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return N.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=N.util.hexToBytes(n.dekInfo.parameters),f=N.pbe.opensslDeriveBytes(t,a.substr(0,8),s),c=o(f);if(c.start(a),c.update(N.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(E.fromDer(r),t):r=E.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in N.md))throw new Error('"sha1" hash algorithm unavailable.');s=N.md.sha1.create()}var f=s.digestLength,c=s.blockLength,u=new N.util.ByteBuffer,h=new N.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=t.length(),p=new N.util.ByteBuffer;p.fillWithByte(r,c);var y=c*Math.ceil(d/c),x=new N.util.ByteBuffer;for(a=0;a<y;a++)x.putByte(t.at(a%d));var m=c*Math.ceil(l/c),b=new N.util.ByteBuffer;for(a=0;a<m;a++)b.putByte(h.at(a%l));var w=x;w.putBuffer(b);for(var C=Math.ceil(i/f),B=1;B<=C;B++){var A=new N.util.ByteBuffer;A.putBytes(p.bytes()),A.putBytes(w.bytes());for(var L=0;L<n;L++)s.start(),s.update(A.getBytes()),A=s.digest();var R=new N.util.ByteBuffer;for(a=0;a<c;a++)R.putByte(A.at(a%f));var P=Math.ceil(d/c)+Math.ceil(l/c),O=new N.util.ByteBuffer;for(o=0;o<P;o++){var G=new N.util.ByteBuffer(w.getBytes(c)),z=511;for(a=R.length()-1;a>=0;a--)z=z>>8,z+=R.at(a)+G.at(a),G.setAt(a,z&255);O.putBuffer(G)}w=O,u.putBuffer(A)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(e,t,r){switch(e){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(e,t,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!E.validate(t,Py,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=E.derToOid(n.kdfOid),e!==W.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=E.derToOid(n.encOid),e!==W.oids["aes128-CBC"]&&e!==W.oids["aes192-CBC"]&&e!==W.oids["aes256-CBC"]&&e!==W.oids["des-EDE3-CBC"]&&e!==W.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=N.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch(W.oids[e]){case"aes128-CBC":f=16,c=N.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=N.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=N.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=N.des.createDecryptionCipher;break;case"desCBC":f=8,c=N.des.createDecryptionCipher;break}var u=Zf(n.prfOid),h=N.pkcs5.pbkdf2(r,o,a,f,u),l=n.encIv,d=c(h);return d.start(l),d};W.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!E.validate(t,ky,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=N.util.createBuffer(n.salt),a=N.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(e){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=N.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(y,x){var m=N.rc2.createDecryptionCipher(y,40);return m.start(x,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=Zf(n.prfOid),l=W.pbe.generatePkcs12Key(r,o,1,a,f,h);h.start();var d=W.pbe.generatePkcs12Key(r,o,2,a,c,h);return u(l,d)};W.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in N.md))throw new Error('"md5" hash algorithm unavailable.');n=N.md.md5.create()}t===null&&(t="");for(var i=[Xf(n,e+t)],s=16,o=1;s<r;++o,s+=16)i.push(Xf(n,i[o-1]+e+t));return i.join("").substr(0,r)};function Xf(e,t){return e.start().update(t).digest().getBytes()}function Zf(e){var t;if(!e)t="hmacWithSHA1";else if(t=W.oids[E.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Qf(t)}function Qf(e){var t=N.md;switch(e){case"hmacWithSHA224":t=N.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Ky(e,t,r,n){var i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,e),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,N.util.hexToBytes(r.toString(16))),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(W.oids[n]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])),i}});var kc=K((_v,Pc)=>{"use strict";Pc.exports=ag;function ag(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(u){if(s)if(s=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{e.apply(t||null,r)}catch(c){s&&(s=!1,f(c))}})}});var Oc=K(Fc=>{"use strict";var ns=Fc;ns.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var un=new Array(64),Mc=new Array(123);for(Se=0;Se<64;)Mc[un[Se]=Se<26?Se+65:Se<52?Se+71:Se<62?Se-4:Se-59|43]=Se++;var Se;ns.encode=function(t,r,n){for(var i=null,s=[],o=0,a=0,f;r<n;){var c=t[r++];switch(a){case 0:s[o++]=un[c>>2],f=(c&3)<<4,a=1;break;case 1:s[o++]=un[f|c>>4],f=(c&15)<<2,a=2;break;case 2:s[o++]=un[f|c>>6],s[o++]=un[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=un[f],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Kc="invalid encoding";ns.decode=function(t,r,n){for(var i=n,s=0,o,a=0;a<t.length;){var f=t.charCodeAt(a++);if(f===61&&s>1)break;if((f=Mc[f])===void 0)throw Error(Kc);switch(s){case 0:o=f,s=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,s=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,s=3;break;case 3:r[n++]=(o&3)<<6|f,s=0;break}}if(s===1)throw Error(Kc);return n-i};ns.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Vc=K((Iv,Hc)=>{"use strict";Hc.exports=is;function is(){this._listeners={}}is.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};is.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};is.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Xc=K((Lv,$c)=>{"use strict";$c.exports=qc(qc);function qc(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(f,c,u){t[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function o(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],t[0]}function a(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],t[0]}e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|c)>>>0,s,o)}}e.writeFloatLE=t.bind(null,zc),e.writeFloatBE=t.bind(null,Gc);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,f=o>>>23&255,c=o&8388607;return f===255?c?NaN:a*(1/0):f===0?a*1401298464324817e-60*c:a*Math.pow(2,f-150)*(c+8388608)}e.readFloatLE=r.bind(null,Wc),e.readFloatBE=r.bind(null,Yc)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(f,c,u){t[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function o(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],t[0]}function a(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],t[0]}e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(n,i,s,o,a,f){var c=o<0?1:0;if(c&&(o=-o),o===0)n(0,a,f+i),n(1/o>0?0:2147483648,a,f+s);else if(isNaN(o))n(0,a,f+i),n(2146959360,a,f+s);else if(o>17976931348623157e292)n(0,a,f+i),n((c<<31|2146435072)>>>0,a,f+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,n(u>>>0,a,f+i),n((c<<31|u/4294967296)>>>0,a,f+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),n(u*4503599627370496>>>0,a,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,a,f+s)}}}e.writeDoubleLE=t.bind(null,zc,0,4),e.writeDoubleBE=t.bind(null,Gc,4,0);function r(n,i,s,o,a){var f=n(o,a+i),c=n(o,a+s),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,Wc,0,4),e.readDoubleBE=r.bind(null,Yc,4,0)}(),e}function zc(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Gc(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Wc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Yc(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Zc=K((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Jc=K(Qc=>{"use strict";var ta=Qc;ta.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ta.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,f;r<n;)f=t[r++],f<128?o[a++]=f:f>191&&f<224?o[a++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,o[a++]=55296+(f>>10),o[a++]=56320+(f&1023)):o[a++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};ta.write=function(t,r,n){for(var i=n,s,o,a=0;a<t.length;++a)s=t.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var tu=K((Uv,jc)=>{"use strict";jc.exports=fg;function fg(e,t,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(f){if(f<1||f>i)return e(f);o+f>n&&(s=e(n),o=0);var c=t.call(s,o,o+=f);return o&7&&(o=(o|7)+1),c}}});var ru=K((Nv,eu)=>{"use strict";eu.exports=Ft;var Yn=Rr();function Ft(e,t){this.lo=e>>>0,this.hi=t>>>0}var Lr=Ft.zero=new Ft(0,0);Lr.toNumber=function(){return 0};Lr.zzEncode=Lr.zzDecode=function(){return this};Lr.length=function(){return 1};var cg=Ft.zeroHash="\0\0\0\0\0\0\0\0";Ft.fromNumber=function(t){if(t===0)return Lr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Ft(n,i)};Ft.from=function(t){if(typeof t=="number")return Ft.fromNumber(t);if(Yn.isString(t))if(Yn.Long)t=Yn.Long.fromString(t);else return Ft.fromNumber(parseInt(t,10));return t.low||t.high?new Ft(t.low>>>0,t.high>>>0):Lr};Ft.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Ft.prototype.toLong=function(t){return Yn.Long?new Yn.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var gr=String.prototype.charCodeAt;Ft.fromHash=function(t){return t===cg?Lr:new Ft((gr.call(t,0)|gr.call(t,1)<<8|gr.call(t,2)<<16|gr.call(t,3)<<24)>>>0,(gr.call(t,4)|gr.call(t,5)<<8|gr.call(t,6)<<16|gr.call(t,7)<<24)>>>0)};Ft.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ft.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};Ft.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};Ft.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Rr=K(ea=>{"use strict";var k=ea;k.asPromise=kc();k.base64=Oc();k.EventEmitter=Vc();k.float=Xc();k.inquire=Zc();k.utf8=Jc();k.pool=tu();k.LongBits=ru();k.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ea;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};k.isString=function(t){return typeof t=="string"||t instanceof String};k.isObject=function(t){return t&&typeof t=="object"};k.isset=k.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var e=k.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(t){return typeof t=="number"?k.Buffer?k._Buffer_allocUnsafe(t):new k.Array(t):k.Buffer?k._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};k.Array=typeof Uint8Array<"u"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(t){return t?k.LongBits.from(t).toHash():k.LongBits.zeroHash};k.longFromHash=function(t,r){var n=k.LongBits.fromHash(t);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function nu(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}k.merge=nu;k.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function iu(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&nu(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}k.newError=iu;k.ProtocolError=iu("ProtocolError");k.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};k.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var e=k.Buffer;if(!e){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},k._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var ia=K((Pv,cu)=>{"use strict";cu.exports=Rt;var Ke=Rr(),na,au=Ke.LongBits,ug=Ke.utf8;function Be(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Rt(e){this.buf=e,this.pos=0,this.len=e.length}var su=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Rt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Rt(t);throw Error("illegal buffer")},fu=function(){return Ke.Buffer?function(r){return(Rt.create=function(i){return Ke.Buffer.isBuffer(i)?new na(i):su(i)})(r)}:su};Rt.create=fu();Rt.prototype._slice=Ke.Array.prototype.subarray||Ke.Array.prototype.slice;Rt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Be(this,10);return t}}();Rt.prototype.int32=function(){return this.uint32()|0};Rt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function ra(){var e=new au(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Be(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Be(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Rt.prototype.bool=function(){return this.uint32()!==0};function ss(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Rt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Be(this,4);return ss(this.buf,this.pos+=4)};Rt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Be(this,4);return ss(this.buf,this.pos+=4)|0};function ou(){if(this.pos+8>this.len)throw Be(this,8);return new au(ss(this.buf,this.pos+=4),ss(this.buf,this.pos+=4))}Rt.prototype.float=function(){if(this.pos+4>this.len)throw Be(this,4);var t=Ke.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Rt.prototype.double=function(){if(this.pos+8>this.len)throw Be(this,4);var t=Ke.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Rt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Be(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Rt.prototype.string=function(){var t=this.bytes();return ug.read(t,0,t.length)};Rt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Be(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Be(this);while(this.buf[this.pos++]&128);return this};Rt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Rt._configure=function(e){na=e,Rt.create=fu(),na._configure();var t=Ke.Long?"toLong":"toNumber";Ke.merge(Rt.prototype,{int64:function(){return ra.call(this)[t](!1)},uint64:function(){return ra.call(this)[t](!0)},sint64:function(){return ra.call(this).zzDecode()[t](!1)},fixed64:function(){return ou.call(this)[t](!0)},sfixed64:function(){return ou.call(this)[t](!1)}})}});var pu=K((kv,lu)=>{"use strict";lu.exports=Ur;var hu=ia();(Ur.prototype=Object.create(hu.prototype)).constructor=Ur;var uu=Rr();function Ur(e){hu.call(this,e)}Ur._configure=function(){uu.Buffer&&(Ur.prototype._slice=uu.Buffer.prototype.slice)};Ur.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Ur._configure()});var ha=K((Kv,xu)=>{"use strict";xu.exports=it;var ge=Rr(),sa,os=ge.LongBits,du=ge.base64,yu=ge.utf8;function $n(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function aa(){}function hg(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function it(){this.len=0,this.head=new $n(aa,0,0),this.tail=this.head,this.states=null}var gu=function(){return ge.Buffer?function(){return(it.create=function(){return new sa})()}:function(){return new it}};it.create=gu();it.alloc=function(t){return new ge.Array(t)};ge.Array!==Array&&(it.alloc=ge.pool(it.alloc,ge.Array.prototype.subarray));it.prototype._push=function(t,r,n){return this.tail=this.tail.next=new $n(t,r,n),this.len+=r,this};function fa(e,t,r){t[r]=e&255}function lg(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function ca(e,t){this.len=e,this.next=void 0,this.val=t}ca.prototype=Object.create($n.prototype);ca.prototype.fn=lg;it.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new ca((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};it.prototype.int32=function(t){return t<0?this._push(ua,10,os.fromNumber(t)):this.uint32(t)};it.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function ua(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}it.prototype.uint64=function(t){var r=os.from(t);return this._push(ua,r.length(),r)};it.prototype.int64=it.prototype.uint64;it.prototype.sint64=function(t){var r=os.from(t).zzEncode();return this._push(ua,r.length(),r)};it.prototype.bool=function(t){return this._push(fa,1,t?1:0)};function oa(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}it.prototype.fixed32=function(t){return this._push(oa,4,t>>>0)};it.prototype.sfixed32=it.prototype.fixed32;it.prototype.fixed64=function(t){var r=os.from(t);return this._push(oa,4,r.lo)._push(oa,4,r.hi)};it.prototype.sfixed64=it.prototype.fixed64;it.prototype.float=function(t){return this._push(ge.float.writeFloatLE,4,t)};it.prototype.double=function(t){return this._push(ge.float.writeDoubleLE,8,t)};var pg=ge.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};it.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(fa,1,0);if(ge.isString(t)){var n=it.alloc(r=du.length(t));du.decode(t,n,0),t=n}return this.uint32(r)._push(pg,r,t)};it.prototype.string=function(t){var r=yu.length(t);return r?this.uint32(r)._push(yu.write,r,t):this._push(fa,1,0)};it.prototype.fork=function(){return this.states=new hg(this),this.head=this.tail=new $n(aa,0,0),this.len=0,this};it.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new $n(aa,0,0),this.len=0),this};it.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};it.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};it._configure=function(e){sa=e,it.create=gu(),sa._configure()}});var wu=K((Mv,vu)=>{"use strict";vu.exports=Me;var mu=ha();(Me.prototype=Object.create(mu.prototype)).constructor=Me;var xr=Rr();function Me(){mu.call(this)}Me._configure=function(){Me.alloc=xr._Buffer_allocUnsafe,Me.writeBytesBuffer=xr.Buffer&&xr.Buffer.prototype instanceof Uint8Array&&xr.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};Me.prototype.bytes=function(t){xr.isString(t)&&(t=xr._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(Me.writeBytesBuffer,r,t),this};function dg(e,t,r){e.length<40?xr.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}Me.prototype.string=function(t){var r=xr.Buffer.byteLength(t);return this.uint32(r),r&&this._push(dg,r,t),this};Me._configure()});var Uu=K((Mw,Ru)=>{var bt=dt();Ar();Ut();var Zn=Ru.exports=bt.sha512=bt.sha512||{};bt.md.sha512=bt.md.algorithms.sha512=Zn;var Iu=bt.sha384=bt.sha512.sha384=bt.sha512.sha384||{};Iu.create=function(){return Zn.create("SHA-384")};bt.md.sha384=bt.md.algorithms.sha384=Iu;bt.sha512.sha256=bt.sha512.sha256||{create:function(){return Zn.create("SHA-512/256")}};bt.md["sha512/256"]=bt.md.algorithms["sha512/256"]=bt.sha512.sha256;bt.sha512.sha224=bt.sha512.sha224||{create:function(){return Zn.create("SHA-512/224")}};bt.md["sha512/224"]=bt.md.algorithms["sha512/224"]=bt.sha512.sha224;Zn.create=function(e){if(Lu||Bg(),typeof e>"u"&&(e="SHA-512"),!(e in Kr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Kr[e],r=null,n=bt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=bt.util.createBuffer(),r=new Array(t.length);for(var c=0;c<t.length;++c)r[c]=t[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=bt.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),Tu(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=bt.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(va.substr(0,a.blockLength-u));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);Tu(y,i,f);var x=bt.util.createBuffer(),m;e==="SHA-512"?m=y.length:e==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)x.putInt32(y[p][0]),(p!==m-1||e!=="SHA-512/224")&&x.putInt32(y[p][1]);return x},a};var va=null,Lu=!1,wa=null,Kr=null;function Bg(){va=String.fromCharCode(128),va+=bt.util.fillString(String.fromCharCode(0),128),wa=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Kr={},Kr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Kr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Kr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Kr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Lu=!0}function Tu(e,t,r){for(var n,i,s,o,a,f,c,u,h,l,d,p,y,x,m,b,w,C,B,A,L,R,P,O,G,z,rt,pt,F,V,S,H,gt,X,Z,Q=r.length();Q>=128;){for(F=0;F<16;++F)t[F][0]=r.getInt32()>>>0,t[F][1]=r.getInt32()>>>0;for(;F<80;++F)H=t[F-2],V=H[0],S=H[1],n=((V>>>19|S<<13)^(S>>>29|V<<3)^V>>>6)>>>0,i=((V<<13|S>>>19)^(S<<3|V>>>29)^(V<<26|S>>>6))>>>0,X=t[F-15],V=X[0],S=X[1],s=((V>>>1|S<<31)^(V>>>8|S<<24)^V>>>7)>>>0,o=((V<<31|S>>>1)^(V<<24|S>>>8)^(V<<25|S>>>7))>>>0,gt=t[F-7],Z=t[F-16],S=i+gt[1]+o+Z[1],t[F][0]=n+gt[0]+s+Z[0]+(S/4294967296>>>0)>>>0,t[F][1]=S>>>0;for(y=e[0][0],x=e[0][1],m=e[1][0],b=e[1][1],w=e[2][0],C=e[2][1],B=e[3][0],A=e[3][1],L=e[4][0],R=e[4][1],P=e[5][0],O=e[5][1],G=e[6][0],z=e[6][1],rt=e[7][0],pt=e[7][1],F=0;F<80;++F)c=((L>>>14|R<<18)^(L>>>18|R<<14)^(R>>>9|L<<23))>>>0,u=((L<<18|R>>>14)^(L<<14|R>>>18)^(R<<23|L>>>9))>>>0,h=(G^L&(P^G))>>>0,l=(z^R&(O^z))>>>0,a=((y>>>28|x<<4)^(x>>>2|y<<30)^(x>>>7|y<<25))>>>0,f=((y<<4|x>>>28)^(x<<30|y>>>2)^(x<<25|y>>>7))>>>0,d=(y&m|w&(y^m))>>>0,p=(x&b|C&(x^b))>>>0,S=pt+u+l+wa[F][1]+t[F][1],n=rt+c+h+wa[F][0]+t[F][0]+(S/4294967296>>>0)>>>0,i=S>>>0,S=f+p,s=a+d+(S/4294967296>>>0)>>>0,o=S>>>0,rt=G,pt=z,G=P,z=O,P=L,O=R,S=A+i,L=B+n+(S/4294967296>>>0)>>>0,R=S>>>0,B=w,A=C,w=m,C=b,m=y,b=x,S=i+o,y=n+s+(S/4294967296>>>0)>>>0,x=S>>>0;S=e[0][1]+x,e[0][0]=e[0][0]+y+(S/4294967296>>>0)>>>0,e[0][1]=S>>>0,S=e[1][1]+b,e[1][0]=e[1][0]+m+(S/4294967296>>>0)>>>0,e[1][1]=S>>>0,S=e[2][1]+C,e[2][0]=e[2][0]+w+(S/4294967296>>>0)>>>0,e[2][1]=S>>>0,S=e[3][1]+A,e[3][0]=e[3][0]+B+(S/4294967296>>>0)>>>0,e[3][1]=S>>>0,S=e[4][1]+R,e[4][0]=e[4][0]+L+(S/4294967296>>>0)>>>0,e[4][1]=S>>>0,S=e[5][1]+O,e[5][0]=e[5][0]+P+(S/4294967296>>>0)>>>0,e[5][1]=S>>>0,S=e[6][1]+z,e[6][0]=e[6][0]+G+(S/4294967296>>>0)>>>0,e[6][1]=S>>>0,S=e[7][1]+pt,e[7][0]=e[7][0]+rt+(S/4294967296>>>0)>>>0,e[7][1]=S>>>0,Q-=128}}});var mh=K((i3,xh)=>{var Sn=1e3,Bn=Sn*60,An=Bn*60,Hr=An*24,a2=Hr*7,f2=Hr*365.25;xh.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return c2(e);if(r==="number"&&isFinite(e))return t.long?h2(e):u2(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function c2(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*f2;case"weeks":case"week":case"w":return r*a2;case"days":case"day":case"d":return r*Hr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*An;case"minutes":case"minute":case"mins":case"min":case"m":return r*Bn;case"seconds":case"second":case"secs":case"sec":case"s":return r*Sn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function u2(e){var t=Math.abs(e);return t>=Hr?Math.round(e/Hr)+"d":t>=An?Math.round(e/An)+"h":t>=Bn?Math.round(e/Bn)+"m":t>=Sn?Math.round(e/Sn)+"s":e+"ms"}function h2(e){var t=Math.abs(e);return t>=Hr?ms(e,t,Hr,"day"):t>=An?ms(e,t,An,"hour"):t>=Bn?ms(e,t,Bn,"minute"):t>=Sn?ms(e,t,Sn,"second"):e+" ms"}function ms(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var wh=K((s3,vh)=>{function l2(e){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=i,r.enabled=o,r.humanize=mh(),r.destroy=c,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(u){let h,l=null,d,p;function y(...x){if(!y.enabled)return;let m=y,b=Number(new Date),w=b-(h||b);m.diff=w,m.prev=h,m.curr=b,h=b,x[0]=r.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let C=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(A,L)=>{if(A==="%%")return"%";C++;let R=r.formatters[L];if(typeof R=="function"){let P=x[C];A=R.call(m,P),x.splice(C,1),C--}return A}),r.formatArgs.call(m,x),(m.log||r.log).apply(m,x)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:x=>{l=x}}),typeof r.init=="function"&&r.init(y),y}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function f(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}vh.exports=l2});var bh=K((le,vs)=>{le.formatArgs=d2;le.save=y2;le.load=g2;le.useColors=p2;le.storage=x2();le.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();le.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function p2(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function d2(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+vs.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}le.log=console.debug||console.log||(()=>{});function y2(e){try{e?le.storage.setItem("debug",e):le.storage.removeItem("debug")}catch{}}function g2(){let e;try{e=le.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function x2(){try{return localStorage}catch{}}vs.exports=wh()(le);var{formatters:m2}=vs.exports;m2.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var E2={};Ht(E2,{noise:()=>b2,pureJsCrypto:()=>Ui});function je(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ve(e=0){return globalThis.Buffer?.alloc!=null?je(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function pe(e=0){return globalThis.Buffer?.allocUnsafe!=null?je(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Nt(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=pe(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return je(r)}function Dt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var qa=Symbol.for("@achingbrain/uint8arraylist");function Va(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function ci(e){return!!e?.[qa]}var ne=class{constructor(...t){Object.defineProperty(this,qa,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ci(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ci(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Va(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Va(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(ci(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Nt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Nt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new ne;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,f=a+o.byteLength;if(i=f,t>=f)continue;let c=t>=a&&t<f,u=r>a&&r<=f;if(c&&u){if(t===a&&r===f){n.push(o);break}let h=t-a;n.push(o.subarray(h,h+(r-t)));break}if(c){if(t===0){n.push(o);continue}n.push(o.subarray(t-a));continue}if(u){if(r===f){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!ci(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=-1;for(let h=0;h<i;h++)o[n[h]]=h;let a=o,f=this.byteLength-n.byteLength,c=n.byteLength-1,u;for(let h=r;h<=f;h+=u){u=0;for(let l=c;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-a[d]);break}}if(u===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=Ve(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=Ve(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof ne)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Dt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new ne;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function ui(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var za=4294967296,ae=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new ae(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new ae(r,n)}toBytes(t,r=0){let n=ui(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new ae;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>za&&(i=0,++n>za&&(n=0))),new ae(n,i)}static fromNumber(t){if(t===0)return new ae;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new ae(i,n)}static fromBytes(t,r=0){let n=ui(t),i=new ae,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Dh=Math.pow(2,7),Ph=Math.pow(2,14),kh=Math.pow(2,21),Kh=Math.pow(2,28),Mh=Math.pow(2,35),Fh=Math.pow(2,42),Oh=Math.pow(2,49),Hh=Math.pow(2,56),Vh=Math.pow(2,63),qe={encodingLength(e){return e<Dh?1:e<Ph?2:e<kh?3:e<Kh?4:e<Mh?5:e<Fh?6:e<Oh?7:e<Hh?8:e<Vh?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=pe(qe.encodingLength(e))),ae.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return ae.fromBytes(e,t).toNumber(!0)}};function hi(e){return e[Symbol.asyncIterator]!=null}var li=e=>{let t=qe.encodingLength(e),r=pe(t);return qe.encode(e,r),li.bytes=t,r};li.bytes=0;function pi(e,t){t=t??{};let r=t.lengthEncoder??li;function*n(i){let s=r(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}return hi(e)?async function*(){for await(let i of e)yield*n(i)}():function*(){for(let i of e)yield*n(i)}()}pi.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??li;return new ne(r(e.byteLength),e)};var Vr=xt(As(),1);var zh=8,Gh=1024*1024*4,br;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(br||(br={}));var Cs=e=>{let t=qe.decode(e);return Cs.bytes=qe.encodingLength(t),t};Cs.bytes=0;function _n(e,t){let r=new ne,n=br.LENGTH,i=-1,s=t?.lengthDecoder??Cs,o=t?.maxLengthLength??zh,a=t?.maxDataLength??Gh;function*f(){for(;r.byteLength>0;){if(n===br.LENGTH)try{if(i=s(r),i<0)throw(0,Vr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,Vr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let c=s.bytes;r.consume(c),t?.onLength!=null&&t.onLength(i),n=br.DATA}catch(c){if(c instanceof RangeError){if(r.byteLength>o)throw(0,Vr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw c}if(n===br.DATA){if(r.byteLength<i)break;let c=r.sublist(0,i);r.consume(i),t?.onData!=null&&t.onData(c),yield c,n=br.LENGTH}}}return hi(e)?async function*(){for await(let c of e)r.append(c),yield*f();if(r.byteLength>0)throw(0,Vr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let c of e)r.append(c),yield*f();if(r.byteLength>0)throw(0,Vr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}_n.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await e.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return _n(n,{...t??{},onLength:s=>{r=s}})};function _s(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}function Ts(){let e=_s(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function Ya(){let e=Ts(),t=Ts();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}var di=class{constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},qr=class{constructor(t={}){this.hwm=t.splitLimit??16,this.head=new di(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new di(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};function zr(e={}){return Yh(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Yh(e,t){t=t??{};let r=t.onEnd,n=new qr,i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((y,x)=>{s=m=>{s=null,n.push(m);try{y(e(n))}catch(b){x(b)}return i}}):e(n),f=y=>s!=null?s(y):(n.push(y),i),c=y=>(n=new qr,s!=null?s({error:y}):(n.push({error:y}),i)),u=y=>{if(o)return i;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},h=y=>o?i:(o=!0,y!=null?c(y):f({done:!0})),l=()=>(n=new qr,h(),{done:!0}),d=y=>(h(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:u,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:u,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength}},i}var yi=xt(As(),1),$a=e=>qe.decode(e);$a.bytes=0;function Is(e,t){let r=zr();e.sink(r).catch(o=>{r.end(o)}),e.sink=async o=>{for await(let a of o)r.push(a);r.end()};let n=e.source;e.source[Symbol.iterator]!=null?n=e.source[Symbol.iterator]():e.source[Symbol.asyncIterator]!=null&&(n=e.source[Symbol.asyncIterator]());let i=new ne,s={read:async o=>{if(o==null){let{done:f,value:c}=await n.next();return f===!0?new ne:c}for(;i.byteLength<o;){let{value:f,done:c}=await n.next();if(c===!0)throw(0,yi.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");i.append(f)}let a=i.sublist(0,o);return i.consume(o),a},readLP:async()=>{let o=-1,a=new ne,f=t?.lengthDecoder??$a;for(;;){a.append(await s.read(1));try{o=f(a)}catch(c){if(c instanceof RangeError)continue;throw c}if(o>-1)break;if(t?.maxLengthLength!=null&&a.byteLength>t.maxLengthLength)throw(0,yi.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG")}if(t?.maxDataLength!=null&&o>t.maxDataLength)throw(0,yi.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");return await s.read(o)},readPB:async o=>{let a=await s.readLP();if(a==null)throw new Error("Value is null");let f=a instanceof Uint8Array?a:a.subarray();return o.decode(f)},write:o=>{o instanceof Uint8Array?r.push(o):r.push(o.subarray())},writeLP:o=>{s.write(pi.single(o,t))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:async()=>await s.readPB(o),write:a=>{s.writePB(a,o)},unwrap:()=>s}),unwrap:()=>{let o=e.source;return e.source=async function*(){yield*i,yield*o}(),e}};return s}function $h(e){return e[Symbol.asyncIterator]!=null}function Xh(...e){let t=[];for(let r of e)$h(r)||t.push(r);return t.length===e.length?function*(){for(let r of t)yield*r}():async function*(){let r=zr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var Xa=Xh;function Za(e,...t){if(e==null)throw new Error("Empty pipeline");if(Ls(e)){let n=e;e=()=>n.source}else if(Ja(e)||Qa(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&Ls(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)Ls(r[n])&&(r[n]=Qh(r[n]));return Zh(...r)}var Zh=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Qa=e=>e?.[Symbol.asyncIterator]!=null,Ja=e=>e?.[Symbol.iterator]!=null,Ls=e=>e==null?!1:e.sink!=null&&e.source!=null,Qh=e=>t=>{let r=e.sink(t);if(r?.then!=null){let n=zr({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let i,s=e.source;if(Qa(s))i=async function*(){yield*s,n.end()};else if(Ja(s))i=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Xa(n,i())}return e.source};var ja=!!globalThis.process?.env?.DUMP_SESSION_KEYS;function Rs(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Jh(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function t0(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function jh(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Rs(e.outputLen),Rs(e.blockLen)}function tl(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function el(e,t){t0(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var rl={number:Rs,bool:Jh,bytes:t0,hash:jh,exists:tl,output:el},fe=rl;var nl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var gi=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),we=(e,t)=>e<<32-t|e>>>t,il=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!il)throw new Error("Non little-endian hardware is not supported");var bx=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function sl(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function tr(e){if(typeof e=="string"&&(e=sl(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}var Gr=class{clone(){return this._cloneInto()}};function Us(e){let t=n=>e().update(tr(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}var xi=class extends Gr{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,fe.hash(t);let n=tr(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return fe.exists(this),this.iHash.update(t),this}digestInto(t){fe.exists(this),fe.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},mi=(e,t,r)=>new xi(e,t).update(r).digest();mi.create=(e,t)=>new xi(e,t);function ol(e,t,r){return fe.hash(e),r===void 0&&(r=new Uint8Array(e.outputLen)),mi(e,tr(r),tr(t))}var Ns=new Uint8Array([0]),e0=new Uint8Array;function al(e,t,r,n=32){if(fe.hash(e),fe.number(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/e.outputLen);r===void 0&&(r=e0);let s=new Uint8Array(i*e.outputLen),o=mi.create(e,t),a=o._cloneInto(),f=new Uint8Array(o.outputLen);for(let c=0;c<i;c++)Ns[0]=c+1,a.update(c===0?e0:f).update(r).update(Ns).digestInto(f),s.set(f,e.outputLen*c),o._cloneInto(a);return o.destroy(),a.destroy(),f.fill(0),Ns.fill(0),s.slice(0,n)}var r0=(e,t,r,n,i)=>al(e,ol(e,t,r),n,i);function fl(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),f=n?4:0,c=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+c,a,n)}var vi=class extends Gr{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=gi(this.buffer)}update(t){fe.exists(this);let{view:r,buffer:n,blockLen:i}=this;t=tr(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let f=gi(t);for(;i<=s-o;o+=i)this.process(f,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){fe.exists(this),fe.output(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;fl(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=gi(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};var cl=(e,t,r)=>e&t^~e&r,ul=(e,t,r)=>e&t^e&r^t&r,hl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),er=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),rr=new Uint32Array(64),wi=class extends vi{constructor(){super(64,32,8,!1),this.A=er[0]|0,this.B=er[1]|0,this.C=er[2]|0,this.D=er[3]|0,this.E=er[4]|0,this.F=er[5]|0,this.G=er[6]|0,this.H=er[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:f}=this;return[t,r,n,i,s,o,a,f]}set(t,r,n,i,s,o,a,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,r){for(let h=0;h<16;h++,r+=4)rr[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let l=rr[h-15],d=rr[h-2],p=we(l,7)^we(l,18)^l>>>3,y=we(d,17)^we(d,19)^d>>>10;rr[h]=y+rr[h-7]+p+rr[h-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let l=we(a,6)^we(a,11)^we(a,25),d=u+l+cl(a,f,c)+hl[h]+rr[h]|0,y=(we(n,2)^we(n,13)^we(n,22))+ul(n,i,s)|0;u=c,c=f,f=a,a=o+d|0,o=s,s=i,i=n,n=d+y|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,f,c,u)}roundClean(){rr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Ds=class extends wi{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Ps=Us(()=>new wi),Px=Us(()=>new Ds);var Zs=xt(qs(),1),Yr=xt(_0(),1),Ui={hashSHA256(e){return Ps(e)},getHKDF(e,t){let r=r0(Ps,t,e,void 0,96),n=r.subarray(0,32),i=r.subarray(32,64),s=r.subarray(64,96);return[n,i,s]},generateX25519KeyPair(){let e=Yr.generateKeyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){let t=Yr.generateKeyPairFromSeed(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return Yr.sharedKey(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return new Zs.ChaCha20Poly1305(n).seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n,i){return new Zs.ChaCha20Poly1305(n).open(t,e,r,i)}};var Qs=xt(qs(),1);var pp=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),$r=e=>{let t=pp(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};$r.bytes=2;var Rn=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};Rn.bytes=2;function T0(e){return Nt([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function I0(e){return Nt([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function L0(e){return Nt([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function R0(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function U0(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function N0(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}function P0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let s=i+65519;s>n.length&&(s=n.length);let o=e.encrypt(n.subarray(i,s),e.session);t?.encryptedPackets.increment(),yield $r(o.byteLength),yield o}}}function k0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let s=i+65535;if(s>n.length&&(s=n.length),s-Qs.TAG_LENGTH<i)throw new Error("Invalid chunk");let o=n.subarray(i,s),a=n.subarray(i,s-Qs.TAG_LENGTH),{plaintext:f,valid:c}=e.decrypt(o,e.session,a);if(!c)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield f}}}var Js=class extends Error{code;constructor(t="Unexpected Peer"){super(t),this.code=Js.code}},Xr=Js;fi(Xr,"code","ERR_UNEXPECTED_PEER");var js=class extends Error{code;constructor(t="Invalid crypto exchange"){super(t),this.code=js.code}},nr=js;fi(nr,"code","ERR_INVALID_CRYPTO_EXCHANGE");var vb=xt(kn(),1),wb=xt(jf(),1);var yt=class extends Error{code;props;constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var t2=xt(dt(),1);var _o={};Ht(_o,{identity:()=>qy});function My(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,f=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,x=0,m=0,b=p.length;m!==b&&p[m]===0;)m++,y++;for(var w=(b-m)*u+1>>>0,C=new Uint8Array(w);m!==b;){for(var B=p[m],A=0,L=w-1;(B!==0||A<x)&&L!==-1;L--,A++)B+=256*C[L]>>>0,C[L]=B%a>>>0,B=B/a>>>0;if(B!==0)throw new Error("Non-zero carry");x=A,m++}for(var R=w-x;R!==w&&C[R]===0;)R++;for(var P=f.repeat(y);R<w;++R)P+=e.charAt(C[R]);return P}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var x=0,m=0;p[y]===f;)x++,y++;for(var b=(p.length-y)*c+1>>>0,w=new Uint8Array(b);p[y];){var C=r[p.charCodeAt(y)];if(C===255)return;for(var B=0,A=b-1;(C!==0||B<m)&&A!==-1;A--,B++)C+=a*w[A]>>>0,w[A]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");m=B,y++}if(p[y]!==" "){for(var L=b-m;L!==b&&w[L]===0;)L++;for(var R=new Uint8Array(x+(b-L)),P=x;L!==b;)R[P++]=w[L++];return R}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Fy=My,Oy=Fy,tc=Oy;var Dm=new Uint8Array(0);var ec=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Ze=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var rc=e=>new TextEncoder().encode(e),nc=e=>new TextDecoder().decode(e);var So=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Bo=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return sc(this,t)}},Ao=class{constructor(t){this.decoders=t}or(t){return sc(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},sc=(e,t)=>new Ao({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Co=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new So(t,r,n),this.decoder=new Bo(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},tn=({name:e,prefix:t,encode:r,decode:n})=>new Co(e,t,r,n),fr=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=tc(r,t);return tn({prefix:e,name:t,encode:n,decode:s=>Ze(i(s))})},Hy=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,f=0,c=0;for(let u=0;u<s;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,o[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},Vy=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},It=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>tn({prefix:t,name:e,encode(i){return Vy(i,n,r)},decode(i){return Hy(i,n,r,e)}});var qy=tn({prefix:"\0",name:"identity",encode:e=>nc(e),decode:e=>rc(e)});var To={};Ht(To,{base2:()=>zy});var zy=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Io={};Ht(Io,{base8:()=>Gy});var Gy=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Lo={};Ht(Lo,{base10:()=>Wy});var Wy=fr({prefix:"9",name:"base10",alphabet:"0123456789"});var Ro={};Ht(Ro,{base16:()=>Yy,base16upper:()=>$y});var Yy=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$y=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Uo={};Ht(Uo,{base32:()=>cr,base32hex:()=>Jy,base32hexpad:()=>t1,base32hexpadupper:()=>e1,base32hexupper:()=>jy,base32pad:()=>Zy,base32padupper:()=>Qy,base32upper:()=>Xy,base32z:()=>r1});var cr=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xy=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Zy=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Qy=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jy=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jy=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),t1=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),e1=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),r1=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var No={};Ht(No,{base36:()=>n1,base36upper:()=>i1});var n1=fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),i1=fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Do={};Ht(Do,{base58btc:()=>Vt,base58flickr:()=>s1});var Vt=fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s1=fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Po={};Ht(Po,{base64:()=>en,base64pad:()=>o1,base64url:()=>a1,base64urlpad:()=>f1});var en=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),o1=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),a1=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),f1=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ko={};Ht(ko,{base256emoji:()=>p1});var oc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),c1=oc.reduce((e,t,r)=>(e[r]=t,e),[]),u1=oc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function h1(e){return e.reduce((t,r)=>(t+=c1[r],t),"")}function l1(e){let t=[];for(let r of e){let n=u1[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var p1=tn({prefix:"\u{1F680}",name:"base256emoji",encode:h1,decode:l1});var Oo={};Ht(Oo,{sha256:()=>qt,sha512:()=>U1});var d1=cc,ac=128,y1=127,g1=~y1,x1=Math.pow(2,31);function cc(e,t,r){t=t||[],r=r||0;for(var n=r;e>=x1;)t[r++]=e&255|ac,e/=128;for(;e&g1;)t[r++]=e&255|ac,e>>>=7;return t[r]=e|0,cc.bytes=r-n+1,t}var m1=Ko,v1=128,fc=127;function Ko(e,n){var r=0,n=n||0,i=0,s=n,o,a=e.length;do{if(s>=a)throw Ko.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&fc)<<i:(o&fc)*Math.pow(2,i),i+=7}while(o>=v1);return Ko.bytes=s-n,r}var w1=Math.pow(2,7),b1=Math.pow(2,14),E1=Math.pow(2,21),S1=Math.pow(2,28),B1=Math.pow(2,35),A1=Math.pow(2,42),C1=Math.pow(2,49),_1=Math.pow(2,56),T1=Math.pow(2,63),I1=function(e){return e<w1?1:e<b1?2:e<E1?3:e<S1?4:e<B1?5:e<A1?6:e<C1?7:e<_1?8:e<T1?9:10},L1={encode:d1,decode:m1,encodingLength:I1},R1=L1,Fn=R1;var On=(e,t=0)=>[Fn.decode(e,t),Fn.decode.bytes],rn=(e,t,r=0)=>(Fn.encode(e,t,r),t),nn=e=>Fn.encodingLength(e);var Pe=(e,t)=>{let r=t.byteLength,n=nn(e),i=n+nn(r),s=new Uint8Array(i+r);return rn(e,s,0),rn(r,s,n),s.set(t,i),new sn(e,r,t,s)},Hn=e=>{let t=Ze(e),[r,n]=On(t),[i,s]=On(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new sn(r,i,o,t)},uc=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&ec(e.bytes,r.bytes)}},sn=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var Fo=({name:e,code:t,encode:r})=>new Mo(e,t,r),Mo=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Pe(this.code,r):r.then(n=>Pe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var lc=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),qt=Fo({name:"sha2-256",code:18,encode:lc("SHA-256")}),U1=Fo({name:"sha2-512",code:19,encode:lc("SHA-512")});var Ho={};Ht(Ho,{identity:()=>ur});var pc=0,N1="identity",dc=Ze,D1=e=>Pe(pc,dc(e)),ur={code:pc,name:N1,encode:dc,digest:D1};var ev=new TextEncoder,rv=new TextDecoder;var yc=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return M1(r,Vo(e),t||Vt.encoder);default:return F1(r,Vo(e),t||cr.encoder)}};var gc=new WeakMap,Vo=e=>{let t=gc.get(e);if(t==null){let r=new Map;return gc.set(e,r),r}return t},Ct=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Vn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==O1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ct.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Pe(t,r);return Ct.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return Ct.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&uc(t.multihash,n.multihash)}toString(t){return yc(this,t)}toJSON(){return{"/":yc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof Ct)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new Ct(n,i,s,o||xc(n,i,s.bytes))}else if(r[H1]===!0){let{version:n,multihash:i,code:s}=r,o=Hn(i);return Ct.create(n,s,o)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Vn)throw new Error(`Version 0 CID must use dag-pb (code: ${Vn}) block encoding`);return new Ct(t,r,n,n.bytes)}case 1:{let i=xc(t,r,n.bytes);return new Ct(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return Ct.create(0,Vn,t)}static createV1(t,r){return Ct.create(1,t,r)}static decode(t){let[r,n]=Ct.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=Ct.inspectBytes(t),n=r.size-r.multihashSize,i=Ze(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new sn(r.multihashCode,r.digestSize,s,i);return[r.version===0?Ct.createV0(o):Ct.createV1(r.codec,o),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=On(t.subarray(r));return r+=l,h},i=n(),s=Vn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),f=n(),c=r+f,u=c-o;return{version:i,codec:s,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(t,r){let[n,i]=K1(t,r),s=Ct.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Vo(s).set(n,t),s}},K1=(e,t)=>{switch(e[0]){case"Q":{let r=t||Vt;return[Vt.prefix,r.decode(`${Vt.prefix}${e}`)]}case Vt.prefix:{let r=t||Vt;return[Vt.prefix,r.decode(e)]}case cr.prefix:{let r=t||cr;return[cr.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},M1=(e,t,r)=>{let{prefix:n}=r;if(n!==Vt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},F1=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},Vn=112,O1=18,xc=(e,t,r)=>{let n=nn(e),i=n+nn(t),s=new Uint8Array(i+r.byteLength);return rn(e,s,0),rn(t,s,n),s.set(r,i),s},H1=Symbol.for("@ipld/js-cid/CID");var an={..._o,...To,...Io,...Lo,...Ro,...Uo,...No,...Do,...Po,...ko},lv={...Oo,...Ho};function vc(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var mc=vc("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),qo=vc("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=pe(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),V1={utf8:mc,"utf-8":mc,hex:an.base16,latin1:qo,ascii:qo,binary:qo,...an},Qi=V1;function zt(e,t="utf8"){let r=Qi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?je(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var ma={};Ht(ma,{Ed25519PrivateKey:()=>kr,Ed25519PublicKey:()=>Xn,generateKeyPair:()=>wg,generateKeyPairFromSeed:()=>Au,unmarshalEd25519PrivateKey:()=>mg,unmarshalEd25519PublicKey:()=>vg});var q1=xt(Sr(),1);var Mt=BigInt(0),tt=BigInt(1),pr=BigInt(2),z1=BigInt(8),wc=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),wt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:wc,n:wc,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Ac=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),qn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),wv=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),G1=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),W1=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Y1=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),$1=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),J=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof Bt))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(Bt.ZERO)?J.ZERO:new J(t.x,t.y,tt,T(t.x*t.y))}static toAffineBatch(t){let r=Q1(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){Ec(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t,f=T(r*a),c=T(s*i),u=T(n*a),h=T(o*i);return f===c&&u===h}negate(){return new J(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=wt,s=T(t*t),o=T(r*r),a=T(pr*T(n*n)),f=T(i*s),c=t+r,u=T(T(c*c)-s-o),h=f+o,l=h-a,d=f-o,p=T(u*l),y=T(h*d),x=T(u*d),m=T(l*h);return new J(p,y,m,x)}add(t){Ec(t);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:f,t:c}=t,u=T((n-r)*(a+o)),h=T((n+r)*(a-o)),l=T(h-u);if(l===Mt)return this.double();let d=T(i*pr*c),p=T(s*pr*f),y=p+d,x=h+u,m=p-d,b=T(y*l),w=T(x*m),C=T(y*m),B=T(l*x);return new J(b,w,B,C)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(t-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(J.BASE)&&(r=Bt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&$o.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=J.normalizeZ(i),$o.set(r,i)));let s=J.ZERO,o=J.BASE,a=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=tt);let y=d,x=d+Math.abs(p)-1,m=l%2!==0,b=p<0;p===0?o=o.add(bc(m,i[y])):s=s.add(bc(b,i[x]))}return J.normalizeZ([s,o])[0]}multiply(t,r){return this.wNAF(ji(t,wt.l),r)}multiplyUnsafe(t){let r=ji(t,wt.l,!1),n=J.BASE,i=J.ZERO;if(r===Mt)return i;if(this.equals(i)||r===tt)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>Mt;)r&tt&&(s=s.add(o)),o=o.double(),r>>=tt;return s}isSmallOrder(){return this.multiplyUnsafe(wt.h).equals(J.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(wt.l/pr).double();return wt.l%pr&&(t=t.add(this)),t.equals(J.ZERO)}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(J.ZERO);t==null&&(t=s?z1:ts(i));let o=T(r*t),a=T(n*t),f=T(i*t);if(s)return Bt.ZERO;if(f!==tt)throw new Error("invZ was invalid");return new Bt(o,a)}fromRistrettoBytes(){Go()}toRistrettoBytes(){Go()}fromRistrettoHash(){Go()}};J.BASE=new J(wt.Gx,wt.Gy,tt,T(wt.Gx*wt.Gy));J.ZERO=new J(Mt,tt,tt,Mt);function bc(e,t){let r=t.negate();return e?r:t}function Ec(e){if(!(e instanceof J))throw new TypeError("ExtendedPoint expected")}function zo(e){if(!(e instanceof se))throw new TypeError("RistrettoPoint expected")}function Go(){throw new Error("Legacy method: switch to RistrettoPoint")}var se=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=wt,n=T(qn*t*t),i=T((n+tt)*Y1),s=BigInt(-1),o=T((s-r*n)*T(n+r)),{isValid:a,value:f}=Zo(i,o),c=T(f*t);lr(c)||(c=T(-c)),a||(f=c),a||(s=n);let u=T(s*(n-tt)*$1-o),h=f*f,l=T((f+f)*o),d=T(u*G1),p=T(tt-h),y=T(tt+h);return new J(T(l*y),T(p*d),T(d*y),T(l*p))}static hashToCurve(t){t=dr(t,64);let r=Wo(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Wo(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new se(n.add(s))}static fromHex(t){t=dr(t,32);let{a:r,d:n}=wt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Wo(t);if(!j1(zn(s),t)||lr(s))throw new Error(i);let o=T(s*s),a=T(tt+r*o),f=T(tt-r*o),c=T(a*a),u=T(f*f),h=T(r*n*c-u),{isValid:l,value:d}=Bc(T(h*u)),p=T(d*f),y=T(d*p*h),x=T((s+s)*p);lr(x)&&(x=T(-x));let m=T(a*y),b=T(x*m);if(!l||lr(b)||m===Mt)throw new Error(i);return new se(new J(x,m,tt,b))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=T(T(n+r)*T(n-r)),o=T(t*r),a=T(o*o),{value:f}=Bc(T(s*a)),c=T(f*s),u=T(f*o),h=T(c*u*i),l;if(lr(i*h)){let p=T(r*qn),y=T(t*qn);t=p,r=y,l=T(c*W1)}else l=u;lr(t*h)&&(r=T(-r));let d=T((n-r)*l);return lr(d)&&(d=T(-d)),zn(d)}toHex(){return Gn(this.toRawBytes())}toString(){return this.toHex()}equals(t){zo(t);let r=this.ep,n=t.ep,i=T(r.x*n.y)===T(r.y*n.x),s=T(r.y*n.y)===T(r.x*n.x);return i||s}add(t){return zo(t),new se(this.ep.add(t.ep))}subtract(t){return zo(t),new se(this.ep.subtract(t.ep))}multiply(t){return new se(this.ep.multiply(t))}multiplyUnsafe(t){return new se(this.ep.multiplyUnsafe(t))}};se.BASE=new se(J.BASE);se.ZERO=new se(J.ZERO);var $o=new WeakMap,Bt=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,$o.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=wt;t=dr(t,32);let s=t.slice();s[31]=t[31]&-129;let o=Wn(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=Ac)throw new Error("Expected 0 < hex < 2**256");let a=T(o*o),f=T(a-tt),c=T(n*a+tt),{isValid:u,value:h}=Zo(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&tt)===tt;return(t[31]&128)!==0!==l&&(h=T(-h)),new Bt(h,o)}static async fromPrivateKey(t){return(await es(t)).point}toRawBytes(){let t=zn(this.y);return t[31]|=this.x&tt?128:0,t}toHex(){return Gn(this.toRawBytes())}toX25519(){let{y:t}=this,r=T((tt+t)*ts(tt-t));return zn(r)}isTorsionFree(){return J.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Bt(T(-this.x),this.y)}add(t){return J.fromAffine(this).add(J.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return J.fromAffine(this).multiply(t,this).toAffine()}};Bt.BASE=new Bt(wt.Gx,wt.Gy);Bt.ZERO=new Bt(Mt,tt);var Ir=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=dr(t,64),n=Bt.fromHex(r.slice(0,32),!1),i=Wn(r.slice(32,64));return new Ir(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof Bt))throw new Error("Expected Point instance");return ji(r,wt.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(zn(this.s),32),t}toHex(){return Gn(this.toRawBytes())}};function Sc(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var X1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Gn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=X1[e[r]];return t}function Xo(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Cc(e){let r=e.toString(16).padStart(64,"0");return Xo(r)}function zn(e){return Cc(e).reverse()}function lr(e){return(T(e)&tt)===tt}function Wn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Gn(Uint8Array.from(e).reverse()))}var Z1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Wo(e){return T(Wn(e)&Z1)}function T(e,t=wt.P){let r=e%t;return r>=Mt?r:t+r}function ts(e,t=wt.P){if(e===Mt||t<=Mt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=T(e,t),n=t,i=Mt,s=tt,o=tt,a=Mt;for(;r!==Mt;){let c=n/r,u=n%r,h=i-o*c,l=s-a*c;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==tt)throw new Error("invert: does not exist");return T(i,t)}function Q1(e,t=wt.P){let r=new Array(e.length),n=e.reduce((s,o,a)=>o===Mt?s:(r[a]=s,T(s*o,t)),tt),i=ts(n,t);return e.reduceRight((s,o,a)=>o===Mt?s:(r[a]=T(s*r[a],t),T(s*o,t)),i),r}function ke(e,t){let{P:r}=wt,n=e;for(;t-- >Mt;)n*=n,n%=r;return n}function J1(e){let{P:t}=wt,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),f=e*e%t*e%t,c=ke(f,pr)*f%t,u=ke(c,tt)*e%t,h=ke(u,r)*u%t,l=ke(h,n)*h%t,d=ke(l,i)*l%t,p=ke(d,s)*d%t,y=ke(p,o)*p%t,x=ke(y,o)*p%t,m=ke(x,n)*h%t;return{pow_p_5_8:ke(m,pr)*e%t,b2:f}}function Zo(e,t){let r=T(t*t*t),n=T(r*r*t),i=J1(e*n).pow_p_5_8,s=T(e*r*i),o=T(t*s*s),a=s,f=T(s*qn),c=o===e,u=o===T(-e),h=o===T(-e*qn);return c&&(s=a),(u||h)&&(s=f),lr(s)&&(s=T(-s)),{isValid:c||u,value:s}}function Bc(e){return Zo(tt,e)}function Ji(e){return T(Wn(e),wt.l)}function j1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function dr(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):Xo(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function ji(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(Mt<e)return e}else if(Mt<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function tg(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function eg(e){if(e=typeof e=="bigint"||typeof e=="number"?Cc(ji(e,Ac)):dr(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function rg(e){let t=tg(e.slice(0,32)),r=e.slice(32,64),n=Ji(t),i=Bt.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var Yo;async function es(e){return rg(await yr.sha512(eg(e)))}async function Qo(e){return(await es(e)).pointBytes}async function _c(e,t){e=dr(e);let{prefix:r,scalar:n,pointBytes:i}=await es(t),s=Ji(await yr.sha512(r,e)),o=Bt.BASE.multiply(s),a=Ji(await yr.sha512(o.toRawBytes(),i,e)),f=T(s+a*n,wt.l);return new Ir(o,f).toRawBytes()}function ng(e,t,r){t=dr(t),r instanceof Bt||(r=Bt.fromHex(r,!1));let{r:n,s:i}=e instanceof Ir?e.assertValidity():Ir.fromHex(e),s=J.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function ig(e,t,r,n){let i=Ji(n),s=J.fromAffine(e).multiplyUnsafe(i);return J.fromAffine(t).add(s).subtract(r).multiplyUnsafe(wt.h).equals(J.ZERO)}async function Tc(e,t,r){let{r:n,SB:i,msg:s,pub:o}=ng(e,t,r),a=await yr.sha512(n.toRawBytes(),o.toRawBytes(),s);return ig(o,n,i,a)}Bt.BASE._setWindowSize(8);var hr={node:q1,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},yr={bytesToHex:Gn,hexToBytes:Xo,concatBytes:Sc,getExtendedPublicKey:es,mod:T,invert:ts,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=dr(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(Wn(e),wt.l-tt)+tt},randomBytes:(e=32)=>{if(hr.web)return hr.web.getRandomValues(new Uint8Array(e));if(hr.node){let{randomBytes:t}=hr.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>yr.randomBytes(32),sha512:async(...e)=>{let t=Sc(...e);if(hr.web){let r=await hr.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(hr.node)return Uint8Array.from(hr.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=Bt.BASE){let r=t.equals(Bt.BASE)?t:new Bt(t.x,t.y);return r._setWindowSize(e),r.multiply(pr),r},sha512Sync:void 0};Object.defineProperties(yr,{sha512Sync:{configurable:!1,get(){return Yo},set(e){Yo||(Yo=e)}}});var fn=32,Qe=64,rs=32;async function Ic(){let e=yr.randomPrivateKey(),t=await Qo(e);return{privateKey:Nc(e,t),publicKey:t}}async function Lc(e){if(e.length!==rs)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await Qo(t);return{privateKey:Nc(t,r),publicKey:r}}async function Rc(e,t){let r=e.subarray(0,rs);return _c(t,r)}async function Uc(e,t,r){return Tc(t,r,e)}function Nc(e,t){let r=new Uint8Array(Qe);for(let n=0;n<rs;n++)r[n]=e[n],r[rs+n]=t[n];return r}var oe={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Jo={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function jo(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=oe.get();r*=8;async function f(h,l){let d=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),y={name:t,iv:p};typeof l=="string"&&(l=zt(l));let x;if(l.length===0){x=await a.subtle.importKey("jwk",Jo,{name:"AES-GCM"},!0,["encrypt"]);try{let b={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},w=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,w,{name:t,length:r},!0,["encrypt"])}catch{x=await a.subtle.importKey("jwk",Jo,{name:"AES-GCM"},!0,["encrypt"])}}else{let b={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},w=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,w,{name:t,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(y,x,h);return Nt([d,y.iv,new Uint8Array(m)])}async function c(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),y=h.subarray(s+n),x={name:t,iv:p};typeof l=="string"&&(l=zt(l));let m;if(l.length===0)try{let w={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(w,C,{name:t,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",Jo,{name:"AES-GCM"},!0,["decrypt"])}else{let w={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(w,C,{name:t,length:r},!0,["decrypt"])}let b=await a.subtle.decrypt(x,m,y);return new Uint8Array(b)}return{encrypt:f,decrypt:c}}async function cn(e,t){let n=await jo().encrypt(e,t);return en.encode(n)}var la=xt(ia(),1),bu=xt(pu(),1),Eu=xt(Rr(),1),pa=xt(ha(),1),Su=xt(wu(),1);function yg(){Eu.default._configure(),la.default._configure(bu.default),pa.default._configure(Su.default)}yg();var Bu=["uint64","int64","sint64","fixed64","sfixed64"];function gg(e){for(let t of Bu){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function da(e){return gg(new la.default(e))}function xg(e){for(let t of Bu){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function ya(){return xg(pa.default.create())}function Nr(e,t){let r=da(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Dr(e,t){let r=ya();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var hn;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(hn||(hn={}));function as(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function ga(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,o){let a=t(s);o.int32(a)},n=function(s){let o=s.int32();return t(o)};return as("enum",hn.VARINT,r,n)}function Pr(e,t){return as("message",hn.LENGTH_DELIMITED,e,t)}var At;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(At||(At={}));var xa;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(xa||(xa={}));(function(e){e.codec=()=>ga(xa)})(At||(At={}));var Fe;(function(e){let t;e.codec=()=>(t==null&&(t=Pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),At.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=At.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>Dr(r,e.codec()),e.decode=r=>Nr(r,e.codec())})(Fe||(Fe={}));var Oe;(function(e){let t;e.codec=()=>(t==null&&(t=Pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),At.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=At.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>Dr(r,e.codec()),e.decode=r=>Nr(r,e.codec())})(Oe||(Oe={}));var Xn=class{_key;constructor(t){this._key=ln(t,fn)}async verify(t,r){return Uc(this._key,r,t)}marshal(){return this._key}get bytes(){return Fe.encode({Type:At.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},kr=class{_key;_publicKey;constructor(t,r){this._key=ln(t,Qe),this._publicKey=ln(r,fn)}async sign(t){return Rc(this._key,t)}get public(){return new Xn(this._publicKey)}marshal(){return this._key}get bytes(){return Oe.encode({Type:At.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=ur.digest(this.public.bytes);return Vt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return cn(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function mg(e){if(e.length>Qe){e=ln(e,Qe+fn);let n=e.subarray(0,Qe),i=e.subarray(Qe,e.length);return new kr(n,i)}e=ln(e,Qe);let t=e.subarray(0,Qe),r=e.subarray(fn);return new kr(t,r)}function vg(e){return e=ln(e,fn),new Xn(e)}async function wg(){let{privateKey:e,publicKey:t}=await Ic();return new kr(e,t)}async function Au(e){let{privateKey:t,publicKey:r}=await Lc(e);return new kr(t,r)}function ln(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new yt(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function _t(e,t="utf8"){let r=Qi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var uw=xt(Ut(),1),hw=xt(Wi(),1),Cu=xt(dt(),1);function Ae(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Nt([new Uint8Array(t-r.length),r])}return _t(r,"base64url")}function ue(e){let t=_u(e);return new Cu.default.jsbn.BigInteger(_t(t,"base16"),16)}function _u(e,t){let r=zt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Nt([new Uint8Array(t-r.length),r])}return r}var bg={"P-256":256,"P-384":384,"P-521":521},Eg=Object.keys(bg),Ew=Eg.join(" / ");var Ia={};Ht(Ia,{RsaPrivateKey:()=>vn,RsaPublicKey:()=>ri,fromJwk:()=>$g,generateKeyPair:()=>Xg,unmarshalRsaPrivateKey:()=>Wg,unmarshalRsaPublicKey:()=>Yg});var ei=xt(dt(),1);var ob=xt(Uu(),1);var Ag=xt(Sr(),1);var et=BigInt(0),Et=BigInt(1),vr=BigInt(2),Jn=BigInt(3),Nu=BigInt(8),Lt=Object.freeze({a:et,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:Et,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Du=(e,t)=>(e+t/vr)/t,cs={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=Lt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Et*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Du(s*e,t),f=Du(-n*e,t),c=D(e-a*r-f*i,t),u=D(-a*n-f*s,t),h=c>o,l=u>o;if(h&&(c=t-c),l&&(u=t-u),c>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Ce=32,yn=32,Cg=32,Pu=Ce+1,ku=2*Ce+1;function Ku(e){let{a:t,b:r}=Lt,n=D(e*e),i=D(n*e);return D(i+t*e+r)}var us=Lt.a===et,ps=class extends Error{constructor(t){super(t)}};function Mu(e){if(!(e instanceof st))throw new TypeError("JacobianPoint expected")}var st=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof ht))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(ht.ZERO)?st.ZERO:new st(t.x,t.y,Et)}static toAffineBatch(t){let r=Rg(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return st.toAffineBatch(t).map(st.fromAffine)}equals(t){Mu(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t,f=D(i*i),c=D(a*a),u=D(r*c),h=D(s*f),l=D(D(n*a)*c),d=D(D(o*i)*f);return u===h&&l===d}negate(){return new st(this.x,D(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=D(t*t),s=D(r*r),o=D(s*s),a=t+s,f=D(vr*(D(a*a)-i-o)),c=D(Jn*i),u=D(c*c),h=D(u-vr*f),l=D(c*(f-h)-Nu*o),d=D(vr*r*n);return new st(h,l,d)}add(t){Mu(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t;if(s===et||o===et)return this;if(r===et||n===et)return t;let f=D(i*i),c=D(a*a),u=D(r*c),h=D(s*f),l=D(D(n*a)*c),d=D(D(o*i)*f),p=D(h-u),y=D(d-l);if(p===et)return y===et?this.double():st.ZERO;let x=D(p*p),m=D(p*x),b=D(u*x),w=D(y*y-m-vr*b),C=D(y*(b-w)-l*m),B=D(i*a*p);return new st(w,C,B)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=st.ZERO;if(typeof t=="bigint"&&t===et)return r;let n=Hu(t);if(n===Et)return this;if(!us){let h=r,l=this;for(;n>et;)n&Et&&(h=h.add(l)),l=l.double(),n>>=Et;return h}let{k1neg:i,k1:s,k2neg:o,k2:a}=cs.splitScalar(n),f=r,c=r,u=this;for(;s>et||a>et;)s&Et&&(f=f.add(u)),a&Et&&(c=c.add(u)),u=u.double(),s>>=Et,a>>=Et;return i&&(f=f.negate()),o&&(c=c.negate()),c=new st(D(c.x*cs.beta),c.y,c.z),f.add(c)}precomputeWindow(t){let r=us?128/t+1:256/t+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(t-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(st.BASE)&&(r=ht.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ea.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=st.normalizeZ(i),Ea.set(r,i)));let s=st.ZERO,o=st.BASE,a=1+(us?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=Et);let y=d,x=d+Math.abs(p)-1,m=l%2!==0,b=p<0;p===0?o=o.add(hs(m,i[y])):s=s.add(hs(b,i[x]))}return{p:s,f:o}}multiply(t,r){let n=Hu(t),i,s;if(us){let{k1neg:o,k1:a,k2neg:f,k2:c}=cs.splitScalar(n),{p:u,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(c,r);u=hs(o,u),l=hs(f,l),l=new st(D(l.x*cs.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return st.normalizeZ([i,s])[0]}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(st.ZERO);t==null&&(t=s?Nu:mn(i));let o=t,a=D(o*o),f=D(a*o),c=D(r*a),u=D(n*f),h=D(i*o);if(s)return ht.ZERO;if(h!==Et)throw new Error("invZ was invalid");return new ht(c,u)}};st.BASE=new st(Lt.Gx,Lt.Gy,Et);st.ZERO=new st(et,Et,et);function hs(e,t){let r=t.negate();return e?r:t}var Ea=new WeakMap,ht=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Ea.delete(this)}hasEvenY(){return this.y%vr===et}static fromCompressedHex(t){let r=t.length===32,n=wr(r?t:t.subarray(1));if(!ba(n))throw new Error("Point is not on curve");let i=Ku(n),s=Lg(i),o=(s&Et)===Et;r?o&&(s=D(-s)):(t[0]&1)===1!==o&&(s=D(-s));let a=new ht(n,s);return a.assertValidity(),a}static fromUncompressedHex(t){let r=wr(t.subarray(1,Ce+1)),n=wr(t.subarray(Ce+1,Ce*2+1)),i=new ht(r,n);return i.assertValidity(),i}static fromHex(t){let r=xn(t),n=r.length,i=r[0];if(n===Ce)return this.fromCompressedHex(r);if(n===Pu&&(i===2||i===3))return this.fromCompressedHex(r);if(n===ku&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Pu} compressed bytes or ${ku} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return ht.BASE.multiply(ys(t))}static fromSignature(t,r,n){let{r:i,s}=Vu(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let o=Aa(xn(t)),{n:a}=Lt,f=n===2||n===3?i+a:i,c=mn(f,a),u=D(-o*c,a),h=D(s*c,a),l=n&1?"03":"02",d=ht.fromHex(l+pn(f)),p=ht.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(t=!1){return Mr(this.toHex(t))}toHex(t=!1){let r=pn(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${pn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!ba(r)||!ba(n))throw new Error(t);let i=D(n*n),s=Ku(r);if(D(i-s)!==et)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ht(this.x,D(-this.y))}double(){return st.fromAffine(this).double().toAffine()}add(t){return st.fromAffine(this).add(st.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return st.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=st.fromAffine(this),s=r===et||r===Et||this!==ht.BASE?i.multiplyUnsafe(r):i.multiply(r),o=st.fromAffine(t).multiplyUnsafe(n),a=s.add(o);return a.equals(st.ZERO)?void 0:a.toAffine()}};ht.BASE=new ht(Lt.Gx,Lt.Gy);ht.ZERO=new ht(et,et);function Fu(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Ou(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${gn(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:wr(r),left:e.subarray(t+2)}}function _g(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${gn(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=Ou(e.subarray(2)),{data:n,left:i}=Ou(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${gn(i)}`);return{r:t,s:n}}var He=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?gn(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new He(ds(i.slice(0,64)),ds(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=_g(r?t:Mr(t));return new He(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!ti(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!ti(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=Lt.n>>Et;return this.s>t}normalizeS(){return this.hasHighS()?new He(this.r,D(-this.s,Lt.n)):this}toDERRawBytes(){return Mr(this.toDERHex())}toDERHex(){let t=Fu(Qn(this.s)),r=Fu(Qn(this.r)),n=t.length/2,i=r.length/2,s=Qn(n),o=Qn(i);return`30${Qn(i+n+4)}02${o}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Mr(this.toCompactHex())}toCompactHex(){return pn(this.r)+pn(this.s)}};function mr(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var Tg=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function gn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=Tg[e[r]];return t}var Ig=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function pn(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(et<=e&&e<Ig))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function Sa(e){let t=Mr(pn(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Qn(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function ds(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function Mr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function wr(e){return ds(gn(e))}function xn(e){return e instanceof Uint8Array?Uint8Array.from(e):Mr(e)}function Hu(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&ti(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function D(e,t=Lt.P){let r=e%t;return r>=et?r:t+r}function xe(e,t){let{P:r}=Lt,n=e;for(;t-- >et;)n*=n,n%=r;return n}function Lg(e){let{P:t}=Lt,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),f=e*e*e%t,c=f*f*e%t,u=xe(c,Jn)*c%t,h=xe(u,Jn)*c%t,l=xe(h,vr)*f%t,d=xe(l,n)*l%t,p=xe(d,i)*d%t,y=xe(p,o)*p%t,x=xe(y,a)*y%t,m=xe(x,o)*p%t,b=xe(m,Jn)*c%t,w=xe(b,s)*d%t,C=xe(w,r)*f%t,B=xe(C,vr);if(B*B%t!==e)throw new Error("Cannot find square root");return B}function mn(e,t=Lt.P){if(e===et||t<=et)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=D(e,t),n=t,i=et,s=Et,o=Et,a=et;for(;r!==et;){let c=n/r,u=n%r,h=i-o*c,l=s-a*c;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==Et)throw new Error("invert: does not exist");return D(i,t)}function Rg(e,t=Lt.P){let r=new Array(e.length),n=e.reduce((s,o,a)=>o===et?s:(r[a]=s,D(s*o,t)),Et),i=mn(n,t);return e.reduceRight((s,o,a)=>o===et?s:(r[a]=D(s*r[a],t),D(s*o,t)),i),r}function Ug(e){let t=e.length*8-yn*8,r=wr(e);return t>0?r>>BigInt(t):r}function Aa(e,t=!1){let r=Ug(e);if(t)return r;let{n}=Lt;return r>=n?r-n:r}var dn,jn,Ba=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return _e.hmacSha256(this.k,...t)}hmacSync(...t){return jn(this.k,...t)}checkSync(){if(typeof jn!="function")throw new ps("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return mr(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return mr(...r)}};function ti(e){return et<e&&e<Lt.n}function ba(e){return et<e&&e<Lt.P}function Ng(e,t,r,n=!0){let{n:i}=Lt,s=Aa(e,!0);if(!ti(s))return;let o=mn(s,i),a=ht.BASE.multiply(s),f=D(a.x,i);if(f===et)return;let c=D(o*D(t+r*f,i),i);if(c===et)return;let u=new He(f,c),h=(a.x===u.r?0:2)|Number(a.y&Et);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function ys(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*yn)throw new Error("Expected 32 bytes of private key");t=ds(e)}else if(e instanceof Uint8Array){if(e.length!==yn)throw new Error("Expected 32 bytes of private key");t=wr(e)}else throw new TypeError("Expected valid private key");if(!ti(t))throw new Error("Expected private key: 0 < key < n");return t}function Dg(e){return e instanceof ht?(e.assertValidity(),e):ht.fromHex(e)}function Vu(e){if(e instanceof He)return e.assertValidity(),e;try{return He.fromDER(e)}catch{return He.fromCompact(e)}}function Ca(e,t=!1){return ht.fromPrivateKey(e).toRawBytes(t)}function qu(e){let t=e.length>Ce?e.slice(0,Ce):e;return wr(t)}function Pg(e){let t=qu(e),r=D(t,Lt.n);return zu(r<et?t:r)}function zu(e){return Sa(e)}function kg(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=xn(e),i=ys(t),s=[zu(i),Pg(n)];if(r!=null){r===!0&&(r=_e.randomBytes(Ce));let f=xn(r);if(f.length!==Ce)throw new Error(`sign: Expected ${Ce} bytes of extra data`);s.push(f)}let o=mr(...s),a=qu(n);return{seed:o,m:a,d:i}}function Kg(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),o=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function Gu(e,t,r={}){let{seed:n,m:i,d:s}=kg(e,t,r.extraEntropy),o=new Ba(Cg,yn);await o.reseed(n);let a;for(;!(a=Ng(await o.generate(),i,s,r.canonical));)await o.reseed();return Kg(a,r)}var Mg={strict:!0};function Wu(e,t,r,n=Mg){let i;try{i=Vu(e),t=xn(t)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=Aa(t),f;try{f=Dg(r)}catch{return!1}let{n:c}=Lt,u=mn(o,c),h=D(a*u,c),l=D(s*u,c),d=ht.BASE.multiplyAndAddUnsafe(f,h,l);return d?D(d.x,c)===s:!1}ht.BASE._setWindowSize(8);var he={node:Ag,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var ls={},_e={bytesToHex:gn,hexToBytes:Mr,concatBytes:mr,mod:D,invert:mn,isValidPrivateKey(e){try{return ys(e),!0}catch{return!1}},_bigintTo32Bytes:Sa,_normalizePrivateKey:ys,hashToPrivateKey:e=>{e=xn(e);let t=yn+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=D(wr(e),Lt.n-Et)+Et;return Sa(r)},randomBytes:(e=32)=>{if(he.web)return he.web.getRandomValues(new Uint8Array(e));if(he.node){let{randomBytes:t}=he.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>_e.hashToPrivateKey(_e.randomBytes(yn+8)),precompute(e=8,t=ht.BASE){let r=t===ht.BASE?t:new ht(t.x,t.y);return r._setWindowSize(e),r.multiply(Jn),r},sha256:async(...e)=>{if(he.web){let t=await he.web.subtle.digest("SHA-256",mr(...e));return new Uint8Array(t)}else if(he.node){let{createHash:t}=he.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(he.web){let r=await he.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=mr(...t),i=await he.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(he.node){let{createHmac:r}=he.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=ls[e];if(r===void 0){let n=await _e.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=mr(n,n),ls[e]=r}return _e.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof dn!="function")throw new ps("sha256Sync is undefined, you need to set it");let r=ls[e];if(r===void 0){let n=dn(Uint8Array.from(e,i=>i.charCodeAt(0)));r=mr(n,n),ls[e]=r}return dn(r,...t)},_JacobianPoint:st};Object.defineProperties(_e,{sha256Sync:{configurable:!1,get(){return dn},set(e){dn||(dn=e)}},hmacSha256Sync:{configurable:!1,get(){return jn},set(e){jn||(jn=e)}}});function gs(e){if(isNaN(e)||e<=0)throw new yt("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _e.randomBytes(e)}var Vw=xt(Xi(),1),_a=xt(dt(),1);function Yu(e,t){return t.map(r=>ue(e[r]))}function $u(e){return _a.default.pki.setRsaPrivateKey(...Yu(e,["n","e","d","p","q","dp","dq","qi"]))}function Xu(e){return _a.default.pki.setRsaPublicKey(...Yu(e,["n","e"]))}var Fr={};Ht(Fr,{jwkToPkcs1:()=>Hg,jwkToPkix:()=>qg,pkcs1ToJwk:()=>Og,pkixToJwk:()=>Vg});var Gw=xt(kn(),1),Ww=xt(Xi(),1);var Je=xt(dt(),1);function Og(e){let t=Je.default.asn1.fromDer(_t(e,"ascii")),r=Je.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Ae(r.n),e:Ae(r.e),d:Ae(r.d),p:Ae(r.p),q:Ae(r.q),dp:Ae(r.dP),dq:Ae(r.dQ),qi:Ae(r.qInv),alg:"RS256"}}function Hg(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new yt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Je.default.pki.privateKeyToAsn1({n:ue(e.n),e:ue(e.e),d:ue(e.d),p:ue(e.p),q:ue(e.q),dP:ue(e.dp),dQ:ue(e.dq),qInv:ue(e.qi)});return zt(Je.default.asn1.toDer(t).getBytes(),"ascii")}function Vg(e){let t=Je.default.asn1.fromDer(_t(e,"ascii")),r=Je.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Ae(r.n),e:Ae(r.e)}}function qg(e){if(e.n==null||e.e==null)throw new yt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Je.default.pki.publicKeyToAsn1({n:ue(e.n),e:ue(e.e)});return zt(Je.default.asn1.toDer(t).getBytes(),"ascii")}async function Zu(e){let t=await oe.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await ju(t);return{privateKey:r[0],publicKey:r[1]}}async function Ta(e){let r=[await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await zg(e)],n=await ju({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Qu(e,t){let r=await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await oe.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Ju(e,t,r){let n=await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return oe.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function ju(e){if(e.privateKey==null||e.publicKey==null)throw new yt("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([oe.get().subtle.exportKey("jwk",e.privateKey),oe.get().subtle.exportKey("jwk",e.publicKey)])}async function zg(e){return oe.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function th(e,t,r,n){let i=t?Xu(e):$u(e),s=_t(Uint8Array.from(r),"ascii"),o=n(s,i);return zt(o,"ascii")}function eh(e,t){return th(e,!0,t,(r,n)=>n.encrypt(r))}function rh(e,t){return th(e,!1,t,(r,n)=>n.decrypt(r))}var ri=class{_key;constructor(t){this._key=t}async verify(t,r){return Ju(this._key,r,t)}marshal(){return Fr.jwkToPkix(this._key)}get bytes(){return Fe.encode({Type:At.RSA,Data:this.marshal()}).subarray()}encrypt(t){return eh(this._key,t)}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},vn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return gs(16)}async sign(t){return Qu(this._key,t)}get public(){if(this._publicKey==null)throw new yt("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new ri(this._publicKey)}decrypt(t){return rh(this._key,t)}marshal(){return Fr.jwkToPkcs1(this._key)}get bytes(){return Oe.encode({Type:At.RSA,Data:this.marshal()}).subarray()}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return _t(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new ei.default.util.ByteBuffer(this.marshal()),i=ei.default.asn1.fromDer(n),s=ei.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return ei.default.pki.encryptRsaPrivateKey(s,t,o)}else{if(r==="libp2p-key")return cn(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Wg(e){let t=Fr.pkcs1ToJwk(e),r=await Ta(t);return new vn(r.privateKey,r.publicKey)}function Yg(e){let t=Fr.pkixToJwk(e);return new ri(t)}async function $g(e){let t=await Ta(e);return new vn(t.privateKey,t.publicKey)}async function Xg(e){let t=await Zu(e);return new vn(t.privateKey,t.publicKey)}var Ra={};Ht(Ra,{Secp256k1PrivateKey:()=>ii,Secp256k1PublicKey:()=>ni,generateKeyPair:()=>jg,unmarshalSecp256k1PrivateKey:()=>Qg,unmarshalSecp256k1PublicKey:()=>Jg});function nh(){return _e.randomPrivateKey()}async function ih(e,t){let{digest:r}=await qt.digest(t);try{return await Gu(r,e)}catch(n){throw new yt(String(n),"ERR_INVALID_INPUT")}}async function sh(e,t,r){try{let{digest:n}=await qt.digest(r);return Wu(t,n,e)}catch(n){throw new yt(String(n),"ERR_INVALID_INPUT")}}function oh(e){return ht.fromHex(e).toRawBytes(!0)}function ah(e){try{Ca(e,!0)}catch(t){throw new yt(String(t),"ERR_INVALID_PRIVATE_KEY")}}function La(e){try{ht.fromHex(e)}catch(t){throw new yt(String(t),"ERR_INVALID_PUBLIC_KEY")}}function fh(e){try{return Ca(e,!0)}catch(t){throw new yt(String(t),"ERR_INVALID_PRIVATE_KEY")}}var ni=class{_key;constructor(t){La(t),this._key=t}async verify(t,r){return sh(this._key,r,t)}marshal(){return oh(this._key)}get bytes(){return Fe.encode({Type:At.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},ii=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r??fh(t),ah(this._key),La(this._publicKey)}async sign(t){return ih(this._key,t)}get public(){return new ni(this._publicKey)}marshal(){return this._key}get bytes(){return Oe.encode({Type:At.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Dt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return _t(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return cn(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Qg(e){return new ii(e)}function Jg(e){return new ni(e)}async function jg(){let e=nh();return new ii(e)}var Or={rsa:Ia,ed25519:ma,secp256k1:Ra};function ch(e){let t=Object.keys(Or).join(" / ");return new yt(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function uh(e){let t=Fe.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case At.RSA:return Or.rsa.unmarshalRsaPublicKey(r);case At.Ed25519:return Or.ed25519.unmarshalEd25519PublicKey(r);case At.Secp256k1:return Or.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw ch(t.Type??"RSA")}}async function hh(e){let t=Oe.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case At.RSA:return Or.rsa.unmarshalRsaPrivateKey(r);case At.Ed25519:return Or.ed25519.unmarshalEd25519PrivateKey(r);case At.Secp256k1:return Or.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw ch(t.Type??"RSA")}}var lh=Symbol.for("@libp2p/peer-id");var e2=Symbol.for("nodejs.util.inspect.custom"),ph=Object.values(an).map(e=>e.decoder).reduce((e,t)=>e.or(t),an.identity.decoder),dh=114,Ua=36,Na=37,si=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[lh](){return!0}toString(){return this.string==null&&(this.string=Vt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ct.createV1(dh,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Dt(this.multihash.bytes,t);if(typeof t=="string")return r2(t).equals(this);if(t?.multihash?.bytes!=null)return Dt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[e2](){return`PeerId(${this.toString()})`}},wn=class extends si{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},bn=class extends si{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},En=class extends si{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function r2(e,t){if(t=t??ph,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Hn(Vt.decode(`z${e}`));return e.startsWith("12D")?new bn({multihash:r}):e.startsWith("16U")?new En({multihash:r}):new wn({multihash:r})}return n2(ph.decode(e))}function n2(e){try{let t=Hn(e);if(t.code===ur.code){if(t.digest.length===Ua)return new bn({multihash:t});if(t.digest.length===Na)return new En({multihash:t})}if(t.code===qt.code)return new wn({multihash:t})}catch{return i2(Ct.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function i2(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==dh)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===qt.code)return new wn({multihash:e.multihash});if(t.code===ur.code){if(t.digest.length===Ua)return new bn({multihash:e.multihash});if(t.digest.length===Na)return new En({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Da(e,t){return e.length===Ua?new bn({multihash:Pe(ur.code,e),privateKey:t}):e.length===Na?new En({multihash:Pe(ur.code,e),privateKey:t}):new wn({multihash:await qt.digest(e),publicKey:e,privateKey:t})}var xs;(function(e){let t;e.codec=()=>(t==null&&(t=Pr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>Dr(r,e.codec()),e.decode=r=>Nr(r,e.codec())})(xs||(xs={}));var oi;(function(e){let t;e.codec=()=>(t==null&&(t=Pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),xs.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=xs.codec().decode(r,r.uint32());break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>Dr(r,e.codec()),e.decode=r=>Nr(r,e.codec())})(oi||(oi={}));async function yh(e,t,r){let n=await o2(e,gh(t));if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return s2(e.publicKey,n,r)}function s2(e,t,r){return oi.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function o2(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await hh(e.privateKey)).sign(t)}async function Pa(e){return Da(e.identityKey)}function ka(e){return oi.decode(e)}function gh(e){let t=zt("noise-libp2p-static-key:");return Nt([t,e],t.length+e.length)}async function Ka(e,t,r){let n=await Da(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=gh(e);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await uh(n.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function ai(e){return!(!(e instanceof Uint8Array)||e.length!==32)}var me=xt(bh(),1);me.default.formatters.b=e=>e==null?"undefined":Vt.baseEncode(e);me.default.formatters.t=e=>e==null?"undefined":cr.baseEncode(e);me.default.formatters.m=e=>e==null?"undefined":en.baseEncode(e);me.default.formatters.p=e=>e==null?"undefined":e.toString();me.default.formatters.c=e=>e==null?"undefined":e.toString();me.default.formatters.k=e=>e==null?"undefined":e.toString();function v2(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function Eh(e){let t=v2(`${e}:trace`);return me.default.enabled(`${e}:trace`)&&me.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=(0,me.default)(`${e}:trace`)),Object.assign((0,me.default)(e),{error:(0,me.default)(`${e}:error`),trace:t})}var Ot=Eh("libp2p:noise");var ve;ja?ve=Ot:ve=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function Sh(e){ve(`LOCAL_STATIC_PUBLIC_KEY ${_t(e.publicKey,"hex")}`),ve(`LOCAL_STATIC_PRIVATE_KEY ${_t(e.privateKey,"hex")}`)}function Ma(e){e?(ve(`LOCAL_PUBLIC_EPHEMERAL_KEY ${_t(e.publicKey,"hex")}`),ve(`LOCAL_PRIVATE_EPHEMERAL_KEY ${_t(e.privateKey,"hex")}`)):ve("Missing local ephemeral keys.")}function Bh(e){ve(`REMOTE_STATIC_PUBLIC_KEY ${_t(e,"hex")}`)}function Fa(e){ve(`REMOTE_EPHEMERAL_PUBLIC_KEY ${_t(e,"hex")}`)}function Ah(e){e.cs1&&e.cs2?(ve(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${_t(e.cs1.k,"hex")}`),ve(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${_t(e.cs2.k,"hex")}`)):ve("Missing cipher state.")}var w2="Cipherstate has reached maximum n, a new handshake must be performed",ws=class{n;bytes;view;constructor(t=0){this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(w2)}};var bs=class{crypto;constructor(t){this.crypto=t}encryptWithAd(t,r,n){let i=this.encrypt(t.k,t.n,r,n);return t.n.increment(),i}decryptWithAd(t,r,n,i){let{plaintext:s,valid:o}=this.decrypt(t.k,t.n,r,n,i);return o&&t.n.increment(),{plaintext:s,valid:o}}hasKey(t){return!this.isEmptyKey(t.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(t){let r=this.createEmptyKey();return Dt(r,t)}encrypt(t,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,t)}encryptAndHash(t,r){let n;return this.hasKey(t.cs)?n=this.encryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,n),n}decrypt(t,r,n,i,s){r.assertValue();let o=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,t,s);return o?{plaintext:o,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(t,r){let n,i=!0;return this.hasKey(t.cs)?{plaintext:n,valid:i}=this.decryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,r),{plaintext:n,valid:i}}dh(t,r){try{let n=this.crypto.generateX25519SharedKey(t,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Ot.error(i),new Uint8Array(32)}}mixHash(t,r){t.h=this.getHash(t.h,r)}getHash(t,r){return this.crypto.hashSHA256(Nt([t,r],t.length+r.length))}mixKey(t,r){let[n,i]=this.crypto.getHKDF(t.ck,r);t.cs=this.initializeKey(i),t.ck=n}initializeKey(t){return{k:t,n:new ws}}initializeSymmetric(t){let r=zt(t,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(t){if(t.length<=32){let r=new Uint8Array(32);return r.set(t),r}else return this.getHash(t,new Uint8Array(0))}split(t){let[r,n]=this.crypto.getHKDF(t.ck,new Uint8Array(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(t,r){let n=this.encryptWithAd(t,new Uint8Array(0),r),i=this.createEmptyKey(),s=new Uint8Array(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(t,r){return this.decryptWithAd(t,new Uint8Array(0),r.ciphertext)}};var Es=class extends bs{initializeInitiator(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,t);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,psk:i,re:a}}initializeResponder(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,t);let a=new Uint8Array(32);return{ss:o,s:r,rs:n,psk:i,re:a}}writeMessageA(t,r,n){let i=new Uint8Array(0);n!==void 0?t.e=n:t.e=this.crypto.generateX25519KeyPair();let s=t.e.publicKey;this.mixHash(t.ss,s);let o=this.encryptAndHash(t.ss,r);return{ne:s,ns:i,ciphertext:o}}writeMessageB(t,r){t.e=this.crypto.generateX25519KeyPair();let n=t.e.publicKey;this.mixHash(t.ss,n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let i=t.s.publicKey,s=this.encryptAndHash(t.ss,i);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let o=this.encryptAndHash(t.ss,r);return{ne:n,ns:s,ciphertext:o}}writeMessageC(t,r){let n=t.s.publicKey,i=this.encryptAndHash(t.ss,n);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let s=this.encryptAndHash(t.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:f,cs2:c}=this.split(t.ss);return{h:t.ss.h,messageBuffer:a,cs1:f,cs2:c}}readMessageA(t,r){return ai(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),this.decryptAndHash(t.ss,r.ciphertext)}readMessageB(t,r){if(ai(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);i&&ai(n)&&(t.rs=n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:o}=this.decryptAndHash(t.ss,r.ciphertext);return{plaintext:s,valid:i&&o}}readMessageC(t,r){let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);if(i&&ai(n)&&(t.rs=n),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:o}=this.decryptAndHash(t.ss,r.ciphertext),{cs1:a,cs2:f}=this.split(t.ss);return{h:t.ss.h,plaintext:s,valid:i&&o,cs1:a,cs2:f}}initSession(t,r,n){let i=this.createEmptyKey(),s=new Uint8Array(32),o;return t?o=this.initializeInitiator(r,n,s,i):o=this.initializeResponder(r,n,s,i),{hs:o,i:t,mc:0}}sendMessage(t,r,n){let i;if(t.mc===0)i=this.writeMessageA(t.hs,r,n);else if(t.mc===1)i=this.writeMessageB(t.hs,r);else if(t.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:f}=this.writeMessageC(t.hs,r);i=o,t.h=s,t.cs1=a,t.cs2=f}else if(t.mc>2)if(t.i){if(!t.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(t.cs1,r)}else{if(!t.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(t.cs2,r)}else throw new Error("Session invalid.");return t.mc++,i}recvMessage(t,r){let n=new Uint8Array(0),i=!1;if(t.mc===0)({plaintext:n,valid:i}=this.readMessageA(t.hs,r));else if(t.mc===1)({plaintext:n,valid:i}=this.readMessageB(t.hs,r));else if(t.mc===2){let{h:s,plaintext:o,valid:a,cs1:f,cs2:c}=this.readMessageC(t.hs,r);n=o,i=a,t.h=s,t.cs1=f,t.cs2=c}return t.mc++,{plaintext:n,valid:i}}};var Ss=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(t,r,n,i,s,o,a,f){this.isInitiator=t,this.payload=r,this.prologue=n,this.staticKeypair=s,this.connection=o,a&&(this.remotePeer=a),this.xx=f??new Es(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(Sh(this.session.hs.s),this.isInitiator){Ot.trace("Stage 0 - Initiator starting to send first message.");let t=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(T0(t)),Ot.trace("Stage 0 - Initiator finished sending first message."),Ma(this.session.hs.e)}else{Ot.trace("Stage 0 - Responder waiting to receive first message...");let t=R0((await this.connection.readLP()).subarray()),{valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new nr("xx handshake stage 0 validation fail");Ot.trace("Stage 0 - Responder received first message."),Fa(this.session.hs.re)}}async exchange(){if(this.isInitiator){Ot.trace("Stage 1 - Initiator waiting to receive first message from responder...");let t=U0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new nr("xx handshake stage 1 validation fail");Ot.trace("Stage 1 - Initiator received the message."),Fa(this.session.hs.re),Bh(this.session.hs.rs),Ot.trace("Initiator going to check remote's signature...");try{let i=ka(r);this.remotePeer=this.remotePeer||await Pa(i),await Ka(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new Xr(`Error occurred while verifying signed payload: ${s.message}`)}Ot.trace("All good with the signature!")}else{Ot.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(I0(t)),Ot.trace("Stage 1 - Responder sent the second handshake message with signed payload."),Ma(this.session.hs.e)}}async finish(){if(this.isInitiator){Ot.trace("Stage 2 - Initiator sending third handshake message.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(L0(t)),Ot.trace("Stage 2 - Initiator sent message with signed payload.")}else{Ot.trace("Stage 2 - Responder waiting for third handshake message...");let t=N0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new nr("xx handshake stage 2 validation fail");Ot.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=ka(r);this.remotePeer=this.remotePeer||await Pa(i),await Ka(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new Xr(`Error occurred while verifying signed payload: ${s.message}`)}}Ah(this.session)}encrypt(t,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),t)}decrypt(t,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),t,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(t,r=!0){if(!t.cs1||!t.cs2)throw new nr("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?t.cs1:t.cs2:r?t.cs2:t.cs1}setRemoteNoiseExtension(t){t&&(this.remoteExtensions=t)}};function Ch(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Bs=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(t={}){let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:s,metrics:o}=t;this.crypto=i??Ui,this.extensions=n,this.metrics=o?Ch(o):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(t,r,n){let i=Is(r,{lengthEncoder:$r,lengthDecoder:Rn,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(t,r,n){let i=Is(r,{lengthEncoder:$r,lengthDecoder:Rn,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(t){let r=await yh(t.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(t,r)}async performXXHandshake(t,r){let{isInitiator:n,remotePeer:i,connection:s}=t,o=new Ss(n,r,this.prologue,this.crypto,this.staticKeys,s,i);try{await o.propose(),await o.exchange(),await o.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return o}async createSecureConnection(t,r){let[n,i]=Ya(),s=t.unwrap();return await Za(n,P0(r,this.metrics),s,o=>_n(o,{lengthDecoder:Rn}),k0(r,this.metrics),n),i}};function b2(e={}){return()=>new Bs(e)}return Nh(E2);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
